!function(e){var t={};function s(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(r,a,function(t){return e[t]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=3)}([function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=s(1),n=(r=a)&&r.__esModule?r:{default:r};t.default=class{constructor(e,t,s,r,a){new n.default(e,t,s,r,a)}}},function(e,t,s){"use strict";window,e.exports=function(e){var t={};function s(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,s),a.l=!0,a.exports}return s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(r,a,function(t){return e[t]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=65)}([function(e,t,s){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;if(!("string"==typeof e||e instanceof String))throw t=null===e?"null":"object"===(t=r(e))&&e.constructor&&e.constructor.hasOwnProperty("name")?e.constructor.name:"a ".concat(t),new TypeError("Expected string but received ".concat(t,"."))},e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});class r{static get BE2_BASIC_FUNCTION(){return"be2BasicFunction"}static get MSG_VERSION(){return"1.0"}static get BE2_BASIC_RESPONSE(){return"be2BasicResponse"}static get enumBE2BasicFunc(){return{FJP_Init:0,FJP_Op:1,FJP_GetCurrentHandpayParams:2,FJP_Event:3,GetPointPlayBalance:12,ValueToPoints:13,ConvertPoints:14,GetXtraCreditBalance:15,MoveCredits:16,LockPin:17,MP_Toggle:19,PT_Get_Player_Menu_State:20,GetCashlessParameters:22,Cashless_TransferFromGame:23,Cashless_TransferFromCard:24,MP_DenomCheck:25,MP_PointsToCash:26,MP_GetEgmDenom:27,MP_SetBonusLight:28,Cashless_Pin_Verify:29,Cashless_IsPinLocked:30,GetCashlessLimits:31,GetCashlessFlags:32,CashlessPinValid:33,Cashless_Pin_Check_Needed:46,GetPointPlayLimitedBalance:47,PT_GetPlayerLevel:48,GetMoreCashlessLimits:49,PT_Get_Player_Data:50,MENU_GetXPCParameters:56,MENU_Card_Duplicate:57,FJP_IsJPWitnessRequired:61,MP_PointsToXtraCredits:70,PT_Get_Bonusing_Status:71,MENU_IsENTEROnPINReq:72,PIN_GetStateInfo:73,PIN_Check_PIN_Needed:75,PIN_ValidatePIN:76,PIN_GetPinStatus:77,PIN_GetCardType:78,Cashless_ForceUnlock:84,PIN_ForcePIN:85,PIN_NotEntered:87,Cashless_Get_Config_Data:88,LOLSCH_PatronRequestUnlock:99,MP_PointsToPayment:100,MP_CheckPointPayCode:101,MENU_SetAutoPlayStatus:102,MENU_GetAutoPlayStatus:103,PT_Get_Point_Pay_Available:104,PayToCreditEnableEgm:105,Cashless_GetStatus:106,PIN_OverridePINScreen:107,PIN_SetForcePIN:108,MISC_ToneABI:109,MISC_BezelColor:110,CancelXtraCredit:111,TransferXtraCredit:114,ContentLockGame:115,OverrideW2GAccrualScreen:116}}static createBE2BasicFunctionArr(e){const t=[];for(let s=0;s<e.length;s++)t.push({functionCode:e[s][0],arguments:e[s][1]});return t}static createBE2BasicFunctionReq(e){return{cmd:r.BE2_BASIC_FUNCTION,ver:r.MSG_VERSION,be2BasicFunction:e}}static getBE2BasicFunctionMap(e,t){const s={};for(let r=0;r<e.length;r++)for(let a=0;a<t.length;a++)if(e[r]===t[a].functionCode){s[e[r]]=t[a].retvals;break}return s}static createHostEventButtonPress(e,t,s,r){return{cmd:"hostEventButtonPress",ver:"1.0",hostEventButtonPress:{hostEventId:e,subEventId:t,onlineOnly:s,bonusId:r}}}static createVpcPin(e){return{cmd:"vpcPIN",ver:"1.0",pin:e}}static createShowHost(e){return{cmd:"showWindow",ver:"1.0",showWindow:e}}static createVpcGetPlayerData(){return{cmd:"vpcGetPlayerData",ver:"1.0"}}static createVpcButtonPress(e){return{cmd:"vpcButtonPress",ver:"1.0",vpcButtonPress:e}}static createGetServerAddresses(e){return{cmd:"getServerAddresses",ver:"1.0",getServerAddresses:e}}static createForceCardOut(){return{cmd:"forceCardOut",ver:"1.0"}}static createScreenTrigger(e,t,s){return{cmd:"screenTrigger",screenTrigger:{screenId:this.normalizeId(e),displayMessage:t,messageTokens:s}}}static createTokenUpdate(e,t){return{cmd:"tokenUpdate",tokenUpdate:[{id:this.normalizeId(e),value:t}]}}static createButtonPress(e){return{cmd:"buttonPress",ver:"1.0",buttonPress:e}}static createGetQRCode(){return{cmd:"getQRcode",ver:"1.0"}}static createUserTokenUpdate(e,t){return{cmd:"userTokenUpdate",userTokenUpdate:[{id:this.normalizeId(e),value:t}]}}static normalizeId(e){return"string"==typeof e?r.createIdString(parseInt(e,16)):r.createIdString(e)}static createIdString(e){const t=e.toString(16);let s=t;return 1===t.length&&(s="0"+t),"0x"+s.toUpperCase()}static createBE2BasicRespMsg(e,t){return{cmd:this.BE2_BASIC_RESPONSE,ver:this.MSG_VERSION,be2BasicResponse:[{functionCode:e,retvals:[t[0],t[1],t[2],t[3]]}]}}static getBE2BasicRespMsg(e){const t={cmd:this.BE2_BASIC_RESPONSE,ver:this.MSG_VERSION,be2BasicResponse:[]};for(let s=0;s<e.length;s++)t.be2BasicResponse.push({functionCode:e[s][0],retvals:e[s][1]});return t}}t.default=r},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{static publish(e,t){const s=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!1});window.dispatchEvent(s)}static subscribe(e,t,s){window.addEventListener(e,t,s||!1)}static unsubscribe(e,t){window.removeEventListener(e,t)}}},function(e,t,s){!function(e){var t={};e.EMULATION_SCREEN="0x00",t[e.EMULATION_SCREEN]="Emulation Screen",e.WELCOME_SCREEN="0x10",t[e.WELCOME_SCREEN]="Welcome Screen",e.SESSION_SCREEN="0x11",t[e.SESSION_SCREEN]="Session Screen",e.INVALID_CARD_SCREEN="0x12",t[e.INVALID_CARD_SCREEN]="Invalid Card Screen",e.ATTENDANT_WELCOME_SCREEN="0x13",t[e.ATTENDANT_WELCOME_SCREEN]="Attendant Welcome Screen",e.XTRA_CREDIT_SESSION_SCREEN="0x14",t[e.XTRA_CREDIT_SESSION_SCREEN]="Xtra Credit Session Screen",e.RETURN_PLAY_POINTS_TO_GO_SCREEN="0x15",t[e.RETURN_PLAY_POINTS_TO_GO_SCREEN]="Return Play Points To Go Screen",e.RETURN_PLAY_AWARD_SCREEN="0x16",t[e.RETURN_PLAY_AWARD_SCREEN]="Return Play Award Screen",e.POINT_MULTIPLIER_SCREEN="0x17",t[e.POINT_MULTIPLIER_SCREEN]="Point Multiplier Screen",e.POOL_1_CARDED_LUCKY_COIN_RESET="0x1B",e.CARDED_LUCKY_COIN_RESET="0x1B",t[e.POOL_1_CARDED_LUCKY_COIN_RESET]="Pool 1 Carded Lucky Coin Reset",e.POOL_2_CARDED_LUCKY_COIN_RESET="0x1C",t[e.POOL_2_CARDED_LUCKY_COIN_RESET]="Pool 2 Carded Lucky Coin Reset",e.POOL_3_CARDED_LUCKY_COIN_RESET="0x1D",t[e.POOL_3_CARDED_LUCKY_COIN_RESET]="Pool 3  Carded Lucky Coin Reset",e.CARDED_LUCKY_COIN_NON_PARTICIPATION="0x1E",t[e.CARDED_LUCKY_COIN_NON_PARTICIPATION]="Carded Lucky Coin Non-Participation",e.MULTI_PROPERTY_CARDED_LUCKY_COIN_NON_PARTICIPATION="0x1F",t[e.MULTI_PROPERTY_CARDED_LUCKY_COIN_NON_PARTICIPATION]="Multi Property Carded Lucky Coin Non-Participation",e.CELEBRATION_AWARD="0x20",t[e.CELEBRATION_AWARD]="Celebration Award",e.LUCKY_COIN_WINNER="0x21",e.BONUS_WIN="0x21",t[e.BONUS_WIN]="Bonus Win",e.MJT_SESSION="0x22",t[e.MJT_SESSION]="MJT Session",e.UNIVERSAL_4_SCREEN="0x23",t[e.UNIVERSAL_4_SCREEN]="Universal Screen 4",e.HANDPAY_JACKPOT="0x24",t[e.HANDPAY_JACKPOT]="Handpay / Jackpot",e.LUCKY_COIN_REMINDER="0x25",t[e.LUCKY_COIN_REMINDER]="Lucky Coin Reminder",e.PRELIMINARY_WELCOME="0x26",t[e.PRELIMINARY_WELCOME]="Preliminary Welcome",e.PERSONAL_LUCKY_COIN_STATUS="0x27",t[e.PERSONAL_LUCKY_COIN_STATUS]="Personal Lucky Coin Status",e.POOL_1_MULTI_PROPERTY_CARDED_LUCKY_COIN_JACKPOT="0x28",t[e.POOL_1_MULTI_PROPERTY_CARDED_LUCKY_COIN_JACKPOT]="Pool 1 Multi Property Carded Lucky Coin Jackpot",e.POOL_2_MULTI_PROPERTY_CARDED_LUCKY_COIN_JACKPOT="0x29",t[e.POOL_2_MULTI_PROPERTY_CARDED_LUCKY_COIN_JACKPOT]="Pool 2 Multi Property Carded Lucky Coin Jackpot",e.POOL_3_MULTI_PROPERTY_CARDED_LUCKY_COIN_JACKPOT="0x2A",t[e.POOL_3_MULTI_PROPERTY_CARDED_LUCKY_COIN_JACKPOT]="Pool 3 Multi Property Carded Lucky Coin Jackpot",e.POOL_1_CARDED_LUCKY_COIN_JACKPOT="0x2B",t[e.POOL_1_CARDED_LUCKY_COIN_JACKPOT]="Pool 1 Carded Lucky Coin Jackpot",e.POOL_2_CARDED_LUCKY_COIN_JACKPOT="0x2C",t[e.POOL_2_CARDED_LUCKY_COIN_JACKPOT]="Pool 2 Carded Lucky Coin Jackpot",e.POOL_3_CARDED_LUCKY_COIN_JACKPOT="0x2D",t[e.POOL_3_CARDED_LUCKY_COIN_JACKPOT]="Pool 3 Carded Lucky Coin Jackpot",e.TITO_EVENT_SCREEN="0x2E",t[e.TITO_EVENT_SCREEN]="TITO Event Screen",e.PERSONAL_LUCKY_COIN_WINNER="0x30",t[e.PERSONAL_LUCKY_COIN_WINNER]="Personal Lucky Coin Winner",e.ANNIVERSARY_SCREEN="0x31",t[e.ANNIVERSARY_SCREEN]="Anniversary Screen",e.BIRTHDAY_SCREEN="0x32",t[e.BIRTHDAY_SCREEN]="Birthday Screen",e.XTRA_CREDIT_EXIT_SCREEN="0x33",t[e.XTRA_CREDIT_EXIT_SCREEN]="Xtra-Credit Exit Screen",e.POINT_PLAY_SESSION="0x34",t[e.POINT_PLAY_SESSION]="Point Play Session",e.POINT_PLAY_SESSION_EXIT="0x35",t[e.POINT_PLAY_SESSION_EXIT]="Point Play Session Exit",e.ABANDONED_CARD_SCREEN="0x36",t[e.ABANDONED_CARD_SCREEN]="Abandoned Card Screen",e.MJT_APPRECIATION_TIME="0x37",t[e.MJT_APPRECIATION_TIME]="MJT Appreciation Time",e.POOL_1_MAGIC_COIN_JACKPOT="0x38",t[e.POOL_1_MAGIC_COIN_JACKPOT]="Pool 1 Magic Coin Jackpot",e.POOL_2_MAGIC_COIN_JACKPOT="0x39",t[e.POOL_2_MAGIC_COIN_JACKPOT]="Pool 2 Magic Coin Jackpot",e.POOL_3_MAGIC_COIN_JACKPOT="0x3A",t[e.POOL_3_MAGIC_COIN_JACKPOT]="Pool 3 Magic Coin Jackpot",e.POOL_1_MAGIC_COIN_RESET="0x3B",t[e.POOL_1_MAGIC_COIN_RESET]="Pool 1 Magic Coin Reset",e.POOL_2_MAGIC_COIN_RESET="0x3C",t[e.POOL_2_MAGIC_COIN_RESET]="Pool 2 Magic Coin Reset",e.POOL_3_MAGIC_COIN_RESET="0x3D",t[e.POOL_3_MAGIC_COIN_RESET]="Pool 3  Magic Coin Reset",e.MAGIC_COIN_NON_PARTICIPATION="0x3E",t[e.MAGIC_COIN_NON_PARTICIPATION]="Magic Coin Non-Participation",e.JACKPOT_SCREEN="0x40",t[e.JACKPOT_SCREEN]="Jackpot Screen",e.POOL_1_MULTI_PROPERTY_CARDED_LUCKY_COIN_RESET="0x44",t[e.POOL_1_MULTI_PROPERTY_CARDED_LUCKY_COIN_RESET]="Pool 1 Multi Property Carded Lucky Coin Reset",e.POOL_2_MULTI_PROPERTY_CARDED_LUCKY_COIN_RESET="0x45",t[e.POOL_2_MULTI_PROPERTY_CARDED_LUCKY_COIN_RESET]="Pool 2 Multi Property Carded Lucky Coin Reset",e.POOL_3_MULTI_PROPERTY_CARDED_LUCKY_COIN_RESET="0x46",t[e.POOL_3_MULTI_PROPERTY_CARDED_LUCKY_COIN_RESET]="Pool 3 Multi Property Carded Lucky Coin Reset",e.IDLE_SCREEN="0x47",t[e.IDLE_SCREEN]="Idle Screen",e.W2G_ACCRUAL_SCREEN="0x4B",t[e.W2G_ACCRUAL_SCREEN]="W2G Accrual Screen",e.IRESERVE_SCREEN="0x4C",t[e.IRESERVE_SCREEN]="IReserve Screen",e.UNIVERSAL_SCREEN_1="0x4D",t[e.UNIVERSAL_SCREEN_1]="Universal Screen 1",e.UNIVERSAL_SCREEN_2="0x4E",t[e.UNIVERSAL_SCREEN_2]="Universal Screen 2",e.UNIVERSAL_SCREEN_3="0x4F",t[e.UNIVERSAL_SCREEN_3]="Universal Screen 3",e.RESPONSIBLE_GAMING_SCREEN_1="0x50",t[e.RESPONSIBLE_GAMING_SCREEN_1]="Responsible Gaming Screen 1",e.RESPONSIBLE_GAMING_SCREEN_2="0x51",t[e.RESPONSIBLE_GAMING_SCREEN_2]="Responsible Gaming Screen 2",e.RESPONSIBLE_GAMING_SCREEN_3="0x52",t[e.RESPONSIBLE_GAMING_SCREEN_3]="Responsible Gaming Screen 3",e.RESPONSIBLE_GAMING_SCREEN_4="0x53",t[e.RESPONSIBLE_GAMING_SCREEN_4]="Responsible Gaming Screen 4",e.RESPONSIBLE_GAMING_SCREEN_5="0x54",t[e.RESPONSIBLE_GAMING_SCREEN_5]="Responsible Gaming Screen 5",e.RESPONSIBLE_GAMING_SCREEN_6="0x55",t[e.RESPONSIBLE_GAMING_SCREEN_6]="Responsible Gaming Screen 6",e.SMART_CARD_SCREEN_1="0x56",t[e.SMART_CARD_SCREEN_1]="Smart Card Screen High balance warning",e.SMART_CARD_SCREEN_2="0x57",t[e.SMART_CARD_SCREEN_2]="Smart Card Screen Low balance warning",e.SMART_CARD_SCREEN_3="0x58",t[e.SMART_CARD_SCREEN_3]="Smart Card Screen Card disabled",e.SMART_CARD_SCREEN_4="0x59",t[e.SMART_CARD_SCREEN_4]="Smart Card Screen Transfer failure",e.SMART_CARD_SCREEN_5="0x5A",t[e.SMART_CARD_SCREEN_5]="Smart Card Screen Auto-transfer",e.SMART_CARD_SCREEN_6="0x5B",t[e.SMART_CARD_SCREEN_6]="Smart Card Screen Unregistered card active",e.SMART_CARD_SCREEN_7="0x5C",t[e.SMART_CARD_SCREEN_7]="Smart Card Screen Please wait",e.SMART_CARD_SCREEN_8="0x5D",t[e.SMART_CARD_SCREEN_8]="Smart Card Screen Cashless unavailable",e.MJT_SESSION_TIME_SCREEN="0x5E",t[e.MJT_SESSION_TIME_SCREEN]="MJT Session Time Screen",e.MJT_SESSION_GAMES_SCREEN="0x5F",t[e.MJT_SESSION_GAMES_SCREEN]="MJT Session Games Screen",e.IN_SESSION_MESSAGE_SCREEN_1="0x68",t[e.IN_SESSION_MESSAGE_SCREEN_1]="In Session Message Screen 1",e.IN_SESSION_MESSAGE_SCREEN_2="0x69",t[e.IN_SESSION_MESSAGE_SCREEN_2]="In Session Message Screen 2",e.IN_SESSION_MESSAGE_SCREEN_3="0x6A",t[e.IN_SESSION_MESSAGE_SCREEN_3]="In Session Message Screen 3",e.IN_SESSION_MESSAGE_SCREEN_4="0x6B",t[e.IN_SESSION_MESSAGE_SCREEN_4]="In Session Message Screen 4",e.IN_SESSION_MESSAGE_SCREEN_5="0x6C",t[e.IN_SESSION_MESSAGE_SCREEN_5]="In Session Message Screen 5",e.IN_SESSION_MESSAGE_SCREEN_6="0x6D",t[e.IN_SESSION_MESSAGE_SCREEN_6]="In Session Message Screen 6",e.IN_SESSION_MESSAGE_SCREEN_7="0x6E",t[e.IN_SESSION_MESSAGE_SCREEN_7]="In Session Message Screen 7",e.IN_SESSION_MESSAGE_SCREEN_8="0x6F",t[e.IN_SESSION_MESSAGE_SCREEN_8]="In Session Message Screen 8",e.BONUS_BY_PLAYER_GROUP_SCREEN_1="0x78",t[e.BONUS_BY_PLAYER_GROUP_SCREEN_1]="Bonus By Player Group Screen 1",e.BONUS_BY_PLAYER_GROUP_SCREEN_2="0x79",t[e.BONUS_BY_PLAYER_GROUP_SCREEN_2]="Bonus By Player Group Screen 2",e.BONUS_BY_PLAYER_GROUP_SCREEN_3="0x7A",t[e.BONUS_BY_PLAYER_GROUP_SCREEN_3]="Bonus By Player Group Screen 3",e.BONUS_BY_PLAYER_GROUP_SCREEN_4="0x7B",t[e.BONUS_BY_PLAYER_GROUP_SCREEN_4]="Bonus By Player Group Screen 4",e.BONUS_BY_PLAYER_GROUP_SCREEN_5="0x7C",t[e.BONUS_BY_PLAYER_GROUP_SCREEN_5]="Bonus By Player Group Screen 5",e.BONUS_BY_PLAYER_GROUP_SCREEN_6="0x7D",t[e.BONUS_BY_PLAYER_GROUP_SCREEN_6]="Bonus By Player Group Screen 6",e.BONUS_BY_PLAYER_GROUP_SCREEN_7="0x7E",t[e.BONUS_BY_PLAYER_GROUP_SCREEN_7]="Bonus By Player Group Screen 7",e.BONUS_BY_PLAYER_GROUP_SCREEN_8="0x7F",t[e.BONUS_BY_PLAYER_GROUP_SCREEN_8]="Bonus By Player Group Screen 8",e.CARD_EXIT_SCREEN="0x80",t[e.CARD_EXIT_SCREEN]="Card Exit Screen",e.UNIVERSAL_5_SCREEN="0x81",t[e.UNIVERSAL_5_SCREEN]="Universal 5 Screen",e.MENU_SCREEN="0x82",t[e.MENU_SCREEN]="Menu Screen",e.PIN_ENTRY_SCREEN="0x83",t[e.PIN_ENTRY_SCREEN]="Pin Entry Screen",e.POINT_PLAY_SCREEN="0x84",t[e.POINT_PLAY_SCREEN]="Point Play Screen",e.POINT_PLAY_CONFIRM_SCREEN="0x85",t[e.POINT_PLAY_CONFIRM_SCREEN]="Point Play Confirm Screen",e.CASHLESS_TRANSFER_SCREEN="0x86",t[e.CASHLESS_TRANSFER_SCREEN]="Cashless Transfer Screen",e.CASHLESS_TRANSFER_CONFIRM_SCREEN="0x87",t[e.CASHLESS_TRANSFER_CONFIRM_SCREEN]="Cashless Transfer Confirm Screen",e.ACCOUNT_SUMMARY_SCREEN="0x88",t[e.ACCOUNT_SUMMARY_SCREEN]="Account Summary Screen",e.SCC_TRANSFER_ENTRY_SCREEN="0x89",t[e.SCC_TRANSFER_ENTRY_SCREEN]="SCC Transfer Entry Screen",e.UNIVERSAL_BONUS_SCREEN_1="0x8A",t[e.UNIVERSAL_BONUS_SCREEN_1]="Universal Bonus Screen 1",e.UNIVERSAL_BONUS_SCREEN_2="0x8B",t[e.UNIVERSAL_BONUS_SCREEN_2]="Universal Bonus Screen 2",e.UNIVERSAL_BONUS_SCREEN_3="0x8C",t[e.UNIVERSAL_BONUS_SCREEN_3]="Universal Bonus Screen 3",e.UNIVERSAL_BONUS_SCREEN_4="0x8D",t[e.UNIVERSAL_BONUS_SCREEN_4]="Universal Bonus Screen 4",e.UNIVERSAL_BONUS_SCREEN_5="0x8E",t[e.UNIVERSAL_BONUS_SCREEN_5]="Universal Bonus Screen 5",e.UNIVERSAL_BONUS_SCREEN_6="0x8F",t[e.UNIVERSAL_BONUS_SCREEN_6]="Universal Bonus Screen 6",e.UNIVERSAL_BONUS_SCREEN_7="0x90",t[e.UNIVERSAL_BONUS_SCREEN_7]="Universal Bonus Screen 7",e.UNIVERSAL_BONUS_SCREEN_8="0x91",t[e.UNIVERSAL_BONUS_SCREEN_8]="Universal Bonus Screen 8",e.UNIVERSAL_BONUS_SCREEN_9="0x92",t[e.UNIVERSAL_BONUS_SCREEN_9]="Universal Bonus Screen 9",e.UNIVERSAL_BONUS_SCREEN_10="0x93",t[e.UNIVERSAL_BONUS_SCREEN_10]="Universal Bonus Screen 10",e.VPC_PIN_SCREEN="0x94",t[e.VPC_PIN_SCREEN]="VPC PIN Screen",e.VPC_PIN_VALIDATING_SCREEN="0x95",t[e.VPC_PIN_VALIDATING_SCREEN]="VPC Pin Validating Screen",e.VPC_PIN_LOCKED_SCREEN="0x96",t[e.VPC_PIN_LOCKED_SCREEN]="VPC Pin Locked Screen",e.VPC_PIN_FAILURE_SCREEN="0x97",t[e.VPC_PIN_FAILURE_SCREEN]="VPC Pin Failure Screen",e.VPC_PIN_SUCCESS_SCREEN="0x98",t[e.VPC_PIN_SUCCESS_SCREEN]="VPC Pin Success Screen",e.VPC_HOST_DOWN_SCREEN="0x99",t[e.VPC_HOST_DOWN_SCREEN]="VPC Host Down Screen",e.VPC_INVALID_CARD_SCREEN="0x9A",t[e.VPC_INVALID_CARD_SCREEN]="VPC Invalid Card Screen",e.VPC_ACCOUNT_CANCELLED_SCREEN="0x9B",t[e.VPC_ACCOUNT_CANCELLED_SCREEN]="VPC Account Cancelled Screen",e.VPC_NO_LIMIT_SCREEN="0x9C",t[e.VPC_NO_LIMIT_SCREEN]="VPC No Limit Screen",e.VPC_ZERO_LIMIT_SCREEN="0x9D",t[e.VPC_ZERO_LIMIT_SCREEN]="VPC Zero Limit Screen",e.VPC_CARD_IN_USE_SCREEN="0x9E",t[e.VPC_CARD_IN_USE_SCREEN]="VPC Card In Use Screen",e.VPC_LIMIT_1_HIT_SCREEN="0x9F",t[e.VPC_LIMIT_1_HIT_SCREEN]="VPC Limit 1 Hit Screen",e.VPC_LIMIT_2_HIT_SCREEN="0xA0",t[e.VPC_LIMIT_2_HIT_SCREEN]="VPC Limit 2 Hit Screen",e.VPC_MULTIPLE_LIMIT_HIT_SCREEN="0xA1",t[e.VPC_MULTIPLE_LIMIT_HIT_SCREEN]="VPC Multiple Limit Hit Screen",e.VPC_LIMIT_1_ALERT_1_SCREEN="0xA2",t[e.VPC_LIMIT_1_ALERT_1_SCREEN]="VPC Limit 1 Alert 1 Screen",e.VPC_LIMIT_1_ALERT_2_SCREEN="0xA3",t[e.VPC_LIMIT_1_ALERT_2_SCREEN]="VPC Limit 1 Alert 2 Screen",e.VPC_LIMIT_2_ALERT_1_SCREEN="0xA4",t[e.VPC_LIMIT_2_ALERT_1_SCREEN]="VPC Limit 2 Alert 1 Screen",e.VPC_LIMIT_2_ALERT_2_SCREEN="0xA5",t[e.VPC_LIMIT_2_ALERT_2_SCREEN]="VPC Limit 2 Alert 2 Screen",e.VPC_ABANDONDED_CARD_SCREEN="0xA6",t[e.VPC_ABANDONDED_CARD_SCREEN]="VPC Abandonded Card Screen",e.VPC_LIVE_ACTION_SUMMARY_SCREEN="0xA7",t[e.VPC_LIVE_ACTION_SUMMARY_SCREEN]="VPC Live Action Summary Screen",e.VPC_REMOVE_CARD_SCREEN="0xA8",t[e.VPC_REMOVE_CARD_SCREEN]="VPC Remove Card Screen",e.VPC_STATEMENT_AVAILABLE_SCREEN="0xA9",t[e.VPC_STATEMENT_AVAILABLE_SCREEN]="VPC Statement Available Screen",e.VPC_LOGIN_TIMEOUT_SCREEN="0xAA",t[e.VPC_LOGIN_TIMEOUT_SCREEN]="VPC Login Timeout Screen",e.VPC_LIMIT_1_ALERT_3="0xAB",t[e.VPC_LIMIT_1_ALERT_3]="VPC Limit 1 Alert 3",e.VPC_LIMIT_2_ALERT_3="0xAC",t[e.VPC_LIMIT_2_ALERT_3]="VPC Limit 2 Alert 3",e.VPC_IDLE_SCREEN="0xAD",t[e.VPC_IDLE_SCREEN]="VPC Idle Screen",e.VPC_CARD_OUT_SCREEN="0xAE",t[e.VPC_CARD_OUT_SCREEN]="VPC Card-out Screen",e.SCRN_TAX_TRANSFER="0xAF",t[e.SCRN_TAX_TRANSFER]="Scrn Tax Transfer",e.getText=function(e){if(t.hasOwnProperty(e))return t[e];throw new Error("code does not exist: "+e)}}(t)},function(e,t){var s=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=s)},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;for(var s in t)void 0===e[s]&&(e[s]=t[s]);return e},e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=j(s(66)),a=j(s(157)),n=j(s(158)),i=j(s(159)),o=j(s(160)),l=j(s(161)),u=j(s(162)),c=j(s(163)),d=j(s(164)),h=j(s(165)),p=j(s(166)),g=j(s(167)),f=j(s(168)),_=j(s(169)),E=j(s(170)),S=j(s(171)),C=j(s(172)),m=j(s(173)),A=j(s(174)),P=j(s(175)),b=j(s(176)),I=j(s(177)),T=j(s(178)),v=j(s(179)),y=j(s(180)),R=j(s(181)),N=j(s(182)),O=j(s(183)),L=j(s(184)),B=j(s(185)),D=j(s(186)),M=j(s(187)),x=j(s(188)),U=j(s(189)),w=j(s(190)),k=j(s(191)),F=j(s(192)),V=j(s(193)),X=j(s(194)),G=j(s(195));function j(e){return e&&e.__esModule?e:{default:e}}const $={activateDiagnostics:n.default,buttonPress:i.default,hostEventButtonPress:o.default,screenTrigger:l.default,subscription:u.default,subscriptionAck:c.default,tokenUpdate:d.default,be2BasicFunction:h.default,be2BasicResponse:p.default,bonusHit:g.default,drawStatus:f.default,fullscreenState:_.default,gameEnd:E.default,gameEvent:S.default,gameStart:C.default,getServerAddresses:m.default,ismUpdate:A.default,levelUpdate:P.default,patronData:b.default,patronDataExt:I.default,serverAddresses:T.default,showWindow:v.default,statusUpdate:y.default,statusmap:R.default,urlmap:N.default,windowState:O.default,cardlessStatus:L.default,forceCardOut:B.default,forceCardOutAck:D.default,getQRcode:M.default,qrCode:x.default,vpcButtonPress:U.default,vpcGetPlayerData:w.default,vpcPIN:k.default,vpcPlayerData:F.default,getUserToken:V.default,languageUpdate:X.default,userTokenUpdate:G.default};let Y=null;const W=function(){if(!Y){const e="http://json-schema.org/draft-04/schema";(Y=new r.default).setRemoteReference(e,a.default)}return Y};t.default=class{static validate(e,t){return function(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,s){return function r(a,n){try{var i=t[a](n),o=i.value}catch(e){return void s(e)}if(!i.done)return Promise.resolve(o).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(o)}("next")}))}}((function*(){return new Promise((function(s,r){W().validate(e,$[t],(function(e,t){e?r(e):t&&s()}))}))}))()}}},function(e,t,s){s(69),t.jsonSymbol=Symbol.for("z-schema/json"),t.schemaSymbol=Symbol.for("z-schema/schema");var r=t.sortedKeys=function(e){return Object.keys(e).sort()};t.isAbsoluteUri=function(e){return/^https?:\/\//.test(e)},t.isRelativeUri=function(e){return/.+#/.test(e)},t.whatIs=function(e){var t=typeof e;return"object"===t?null===e?"null":Array.isArray(e)?"array":"object":"number"===t?Number.isFinite(e)?e%1==0?"integer":"number":Number.isNaN(e)?"not-a-number":"unknown-number":t},t.areEqual=function e(s,a,n){var i,o,l=(n=n||{}).caseInsensitiveComparison||!1;if(s===a)return!0;if(!0===l&&"string"==typeof s&&"string"==typeof a&&s.toUpperCase()===a.toUpperCase())return!0;if(Array.isArray(s)&&Array.isArray(a)){if(s.length!==a.length)return!1;for(o=s.length,i=0;i<o;i++)if(!e(s[i],a[i],{caseInsensitiveComparison:l}))return!1;return!0}if("object"===t.whatIs(s)&&"object"===t.whatIs(a)){var u=r(s);if(!e(u,r(a),{caseInsensitiveComparison:l}))return!1;for(o=u.length,i=0;i<o;i++)if(!e(s[u[i]],a[u[i]],{caseInsensitiveComparison:l}))return!1;return!0}return!1},t.isUniqueArray=function(e,s){var r,a,n=e.length;for(r=0;r<n;r++)for(a=r+1;a<n;a++)if(t.areEqual(e[r],e[a]))return s&&s.push(r,a),!1;return!0},t.difference=function(e,t){for(var s=[],r=e.length;r--;)-1===t.indexOf(e[r])&&s.push(e[r]);return s},t.clone=function(e){if(void 0!==e){if("object"!=typeof e||null===e)return e;var t,s;if(Array.isArray(e))for(t=[],s=e.length;s--;)t[s]=e[s];else{t={};var r=Object.keys(e);for(s=r.length;s--;){var a=r[s];t[a]=e[a]}}return t}},t.cloneDeep=function(e){var t=[],s=[];return function e(r){if("object"!=typeof r||null===r)return r;var a,n,i;if(-1!==(i=t.indexOf(r)))return s[i];if(t.push(r),Array.isArray(r))for(a=[],s.push(a),n=r.length;n--;)a[n]=e(r[n]);else{a={},s.push(a);var o=Object.keys(r);for(n=o.length;n--;){var l=o[n];a[l]=e(r[l])}}return a}(e)},t.ucs2decode=function(e){for(var t,s,r=[],a=0,n=e.length;a<n;)(t=e.charCodeAt(a++))>=55296&&t<=56319&&a<n?56320==(64512&(s=e.charCodeAt(a++)))?r.push(((1023&t)<<10)+(1023&s)+65536):(r.push(t),a--):r.push(t);return r}},function(e,t){var s={}.hasOwnProperty;e.exports=function(e,t){return s.call(e,t)}},function(e,t,s){e.exports=!s(17)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,s){var r=s(18),a=s(41),n=s(23),i=Object.defineProperty;t.f=s(9)?Object.defineProperty:function(e,t,s){if(r(e),t=n(t,!0),r(s),a)try{return i(e,t,s)}catch(e){}if("get"in s||"set"in s)throw TypeError("Accessors not supported!");return"value"in s&&(e[t]=s.value),e}},function(e,t,s){(function(t){var r=s(39),a=s(68),n=s(7);function i(e,t){this.parentReport=e instanceof i?e:void 0,this.options=e instanceof i?e.options:e||{},this.reportOptions=t||{},this.errors=[],this.path=[],this.asyncTasks=[],this.rootSchema=void 0,this.commonErrorMessage=void 0,this.json=void 0}i.prototype.isValid=function(){if(this.asyncTasks.length>0)throw new Error("Async tasks pending, can't answer isValid");return 0===this.errors.length},i.prototype.addAsyncTask=function(e,t,s){this.asyncTasks.push([e,t,s])},i.prototype.processAsyncTasks=function(e,s){var r=e||2e3,a=this.asyncTasks.length,n=a,i=!1,o=this;function l(){t.nextTick((function(){var e=0===o.errors.length,t=e?void 0:o.errors;s(t,e)}))}function u(e){return function(t){i||(e(t),0==--a&&l())}}if(0===a||this.errors.length>0&&this.options.breakOnFirstError)l();else{for(;n--;){var c=this.asyncTasks[n];c[0].apply(null,c[1].concat(u(c[2])))}setTimeout((function(){a>0&&(i=!0,o.addError("ASYNC_TIMEOUT",[a,r]),s(o.errors,!1))}),r)}},i.prototype.getPath=function(e){var t=[];return this.parentReport&&(t=t.concat(this.parentReport.path)),t=t.concat(this.path),!0!==e&&(t="#/"+t.map((function(e){return n.isAbsoluteUri(e)?"uri("+e+")":e.replace(/\~/g,"~0").replace(/\//g,"~1")})).join("/")),t},i.prototype.getSchemaId=function(){if(!this.rootSchema)return null;var e=[];for(this.parentReport&&(e=e.concat(this.parentReport.path)),e=e.concat(this.path);e.length>0;){var t=r(this.rootSchema,e);if(t&&t.id)return t.id;e.pop()}return this.rootSchema.id},i.prototype.hasError=function(e,t){for(var s=this.errors.length;s--;)if(this.errors[s].code===e){for(var r=!0,a=this.errors[s].params.length;a--;)this.errors[s].params[a]!==t[a]&&(r=!1);if(r)return r}return!1},i.prototype.addError=function(e,t,s,r){if(!e)throw new Error("No errorCode passed into addError()");this.addCustomError(e,a[e],t,s,r)},i.prototype.getJson=function(){for(var e=this;void 0===e.json;)if(void 0===(e=e.parentReport))return;return e.json},i.prototype.addCustomError=function(e,t,s,r,a){if(!(this.errors.length>=this.reportOptions.maxErrors)){if(!t)throw new Error("No errorMessage known for code "+e);for(var i=(s=s||[]).length;i--;){var o=n.whatIs(s[i]),l="object"===o||"null"===o?JSON.stringify(s[i]):s[i];t=t.replace("{"+i+"}",l)}var u={code:e,params:s,message:t,path:this.getPath(this.options.reportPathAsArray),schemaId:this.getSchemaId()};if(u[n.schemaSymbol]=a,u[n.jsonSymbol]=this.getJson(),a&&"string"==typeof a?u.description=a:a&&"object"==typeof a&&(a.title&&(u.title=a.title),a.description&&(u.description=a.description)),null!=r){for(Array.isArray(r)||(r=[r]),u.inner=[],i=r.length;i--;)for(var c=r[i],d=c.errors.length;d--;)u.inner.push(c.errors[d]);0===u.inner.length&&(u.inner=void 0)}this.errors.push(u)}},e.exports=i}).call(this,s(38))},function(e,t){var s=e.exports={version:"2.6.9"};"number"==typeof __e&&(__e=s)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){var s=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++s+r).toString(36))}},function(e,t,s){var r=s(19)("wks"),a=s(14),n=s(4).Symbol,i="function"==typeof n;(e.exports=function(e){return r[e]||(r[e]=i&&n[e]||(i?n:a)("Symbol."+e))}).store=r},function(e,t,s){var r=s(79),a=s(45);e.exports=function(e){return r(a(e))}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,s){var r=s(13);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,s){var r=s(12),a=s(4),n=a["__core-js_shared__"]||(a["__core-js_shared__"]={});(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:s(26)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if((0,r.default)(t),!(s=String(s)))return e(t,4)||e(t,6);if("4"===s){if(!a.test(t))return!1;var i=t.split(".").sort((function(e,t){return e-t}));return i[3]<=255}if("6"===s){var o=t.split(":"),l=!1,u=e(o[o.length-1],4),c=u?7:8;if(o.length>c)return!1;if("::"===t)return!0;"::"===t.substr(0,2)?(o.shift(),o.shift(),l=!0):"::"===t.substr(t.length-2)&&(o.pop(),o.pop(),l=!0);for(var d=0;d<o.length;++d)if(""===o[d]&&d>0&&d<o.length-1){if(l)return!1;l=!0}else if(u&&d===o.length-1);else if(!n.test(o[d]))return!1;return l?o.length>=1:o.length===c}return!1};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,n=/^[0-9A-F]{1,4}$/i;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.commaDecimal=t.dotDecimal=t.arabicLocales=t.englishLocales=t.decimal=t.alphanumeric=t.alpha=void 0;var r={"en-US":/^[A-Z]+$/i,"bg-BG":/^[А-Я]+$/i,"cs-CZ":/^[A-ZÁČĎÉĚÍŇÓŘŠŤÚŮÝŽ]+$/i,"da-DK":/^[A-ZÆØÅ]+$/i,"de-DE":/^[A-ZÄÖÜß]+$/i,"el-GR":/^[Α-ω]+$/i,"es-ES":/^[A-ZÁÉÍÑÓÚÜ]+$/i,"fr-FR":/^[A-ZÀÂÆÇÉÈÊËÏÎÔŒÙÛÜŸ]+$/i,"it-IT":/^[A-ZÀÉÈÌÎÓÒÙ]+$/i,"nb-NO":/^[A-ZÆØÅ]+$/i,"nl-NL":/^[A-ZÁÉËÏÓÖÜÚ]+$/i,"nn-NO":/^[A-ZÆØÅ]+$/i,"hu-HU":/^[A-ZÁÉÍÓÖŐÚÜŰ]+$/i,"pl-PL":/^[A-ZĄĆĘŚŁŃÓŻŹ]+$/i,"pt-PT":/^[A-ZÃÁÀÂÇÉÊÍÕÓÔÚÜ]+$/i,"ru-RU":/^[А-ЯЁ]+$/i,"sl-SI":/^[A-ZČĆĐŠŽ]+$/i,"sk-SK":/^[A-ZÁČĎÉÍŇÓŠŤÚÝŽĹŔĽÄÔ]+$/i,"sr-RS@latin":/^[A-ZČĆŽŠĐ]+$/i,"sr-RS":/^[А-ЯЂЈЉЊЋЏ]+$/i,"sv-SE":/^[A-ZÅÄÖ]+$/i,"tr-TR":/^[A-ZÇĞİıÖŞÜ]+$/i,"uk-UA":/^[А-ЩЬЮЯЄIЇҐі]+$/i,"ku-IQ":/^[ئابپتجچحخدرڕزژسشعغفڤقکگلڵمنوۆھەیێيطؤثآإأكضصةظذ]+$/i,ar:/^[ءآأؤإئابةتثجحخدذرزسشصضطظعغفقكلمنهوىيًٌٍَُِّْٰ]+$/};t.alpha=r;var a={"en-US":/^[0-9A-Z]+$/i,"bg-BG":/^[0-9А-Я]+$/i,"cs-CZ":/^[0-9A-ZÁČĎÉĚÍŇÓŘŠŤÚŮÝŽ]+$/i,"da-DK":/^[0-9A-ZÆØÅ]+$/i,"de-DE":/^[0-9A-ZÄÖÜß]+$/i,"el-GR":/^[0-9Α-ω]+$/i,"es-ES":/^[0-9A-ZÁÉÍÑÓÚÜ]+$/i,"fr-FR":/^[0-9A-ZÀÂÆÇÉÈÊËÏÎÔŒÙÛÜŸ]+$/i,"it-IT":/^[0-9A-ZÀÉÈÌÎÓÒÙ]+$/i,"hu-HU":/^[0-9A-ZÁÉÍÓÖŐÚÜŰ]+$/i,"nb-NO":/^[0-9A-ZÆØÅ]+$/i,"nl-NL":/^[0-9A-ZÁÉËÏÓÖÜÚ]+$/i,"nn-NO":/^[0-9A-ZÆØÅ]+$/i,"pl-PL":/^[0-9A-ZĄĆĘŚŁŃÓŻŹ]+$/i,"pt-PT":/^[0-9A-ZÃÁÀÂÇÉÊÍÕÓÔÚÜ]+$/i,"ru-RU":/^[0-9А-ЯЁ]+$/i,"sl-SI":/^[0-9A-ZČĆĐŠŽ]+$/i,"sk-SK":/^[0-9A-ZÁČĎÉÍŇÓŠŤÚÝŽĹŔĽÄÔ]+$/i,"sr-RS@latin":/^[0-9A-ZČĆŽŠĐ]+$/i,"sr-RS":/^[0-9А-ЯЂЈЉЊЋЏ]+$/i,"sv-SE":/^[0-9A-ZÅÄÖ]+$/i,"tr-TR":/^[0-9A-ZÇĞİıÖŞÜ]+$/i,"uk-UA":/^[0-9А-ЩЬЮЯЄIЇҐі]+$/i,"ku-IQ":/^[٠١٢٣٤٥٦٧٨٩0-9ئابپتجچحخدرڕزژسشعغفڤقکگلڵمنوۆھەیێيطؤثآإأكضصةظذ]+$/i,ar:/^[٠١٢٣٤٥٦٧٨٩0-9ءآأؤإئابةتثجحخدذرزسشصضطظعغفقكلمنهوىيًٌٍَُِّْٰ]+$/};t.alphanumeric=a;var n={"en-US":".",ar:"٫"};t.decimal=n;var i=["AU","GB","HK","IN","NZ","ZA","ZM"];t.englishLocales=i;for(var o,l=0;l<i.length;l++)r[o="en-".concat(i[l])]=r["en-US"],a[o]=a["en-US"],n[o]=n["en-US"];var u=["AE","BH","DZ","EG","IQ","JO","KW","LB","LY","MA","QM","QA","SA","SD","SY","TN","YE"];t.arabicLocales=u;for(var c,d=0;d<u.length;d++)r[c="ar-".concat(u[d])]=r.ar,a[c]=a.ar,n[c]=n.ar;var h=[];t.dotDecimal=h;var p=["bg-BG","cs-CZ","da-DK","de-DE","el-GR","es-ES","fr-FR","it-IT","ku-IQ","hu-HU","nb-NO","nn-NO","nl-NL","pl-PL","pt-PT","ru-RU","sl-SI","sr-RS@latin","sr-RS","sv-SE","tr-TR","uk-UA"];t.commaDecimal=p;for(var g=0;g<h.length;g++)n[h[g]]=n["en-US"];for(var f=0;f<p.length;f++)n[p[f]]=",";r["pt-BR"]=r["pt-PT"],a["pt-BR"]=a["pt-PT"],n["pt-BR"]=n["pt-PT"],r["pl-Pl"]=r["pl-PL"],a["pl-Pl"]=a["pl-PL"],n["pl-Pl"]=n["pl-PL"]},function(e,t,s){var r=s(10),a=s(24);e.exports=s(9)?function(e,t,s){return r.f(e,t,a(1,s))}:function(e,t,s){return e[t]=s,e}},function(e,t,s){var r=s(13);e.exports=function(e,t){if(!r(e))return e;var s,a;if(t&&"function"==typeof(s=e.toString)&&!r(a=s.call(e)))return a;if("function"==typeof(s=e.valueOf)&&!r(a=s.call(e)))return a;if(!t&&"function"==typeof(s=e.toString)&&!r(a=s.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,s){var r=s(4),a=s(22),n=s(8),i=s(14)("src"),o=s(72),l=(""+o).split("toString");s(12).inspectSource=function(e){return o.call(e)},(e.exports=function(e,t,s,o){var u="function"==typeof s;u&&(n(s,"name")||a(s,"name",t)),e[t]!==s&&(u&&(n(s,i)||a(s,i,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=s:o?e[t]?e[t]=s:a(e,t,s):(delete e[t],a(e,t,s)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[i]||o.call(this)}))},function(e,t){e.exports=!1},function(e,t,s){var r=s(44),a=s(29);e.exports=Object.keys||function(e){return r(e,a)}},function(e,t){var s={}.toString;e.exports=function(e){return s.call(e).slice(8,-1)}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,s){var r=s(92),a={date:function(e){if("string"!=typeof e)return!0;var t=/^([0-9]{4})-([0-9]{2})-([0-9]{2})$/.exec(e);return null!==t&&!(t[2]<"01"||t[2]>"12"||t[3]<"01"||t[3]>"31")},"date-time":function(e){if("string"!=typeof e)return!0;var t=e.toLowerCase().split("t");if(!a.date(t[0]))return!1;var s=/^([0-9]{2}):([0-9]{2}):([0-9]{2})(.[0-9]+)?(z|([+-][0-9]{2}:[0-9]{2}))$/.exec(t[1]);return null!==s&&!(s[1]>"23"||s[2]>"59"||s[3]>"59")},email:function(e){return"string"!=typeof e||r.isEmail(e,{require_tld:!0})},hostname:function(e){if("string"!=typeof e)return!0;var t=/^[a-zA-Z](([-0-9a-zA-Z]+)?[0-9a-zA-Z])?(\.[a-zA-Z](([-0-9a-zA-Z]+)?[0-9a-zA-Z])?)*$/.test(e);if(t){if(e.length>255)return!1;for(var s=e.split("."),r=0;r<s.length;r++)if(s[r].length>63)return!1}return t},"host-name":function(e){return a.hostname.call(this,e)},ipv4:function(e){return"string"!=typeof e||r.isIP(e,4)},ipv6:function(e){return"string"!=typeof e||r.isIP(e,6)},regex:function(e){try{return RegExp(e),!0}catch(e){return!1}},uri:function(e){return this.options.strictUris?a["strict-uri"].apply(this,arguments):"string"!=typeof e||RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?").test(e)},"strict-uri":function(e){return"string"!=typeof e||r.isURL(e)}};e.exports=a},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),e=Date.parse(e),isNaN(e)?null:new Date(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"object"===r(e)&&null!==e?e="function"==typeof e.toString?e.toString():"[object Object]":(null==e||isNaN(e)&&!e.length)&&(e=""),String(e)},e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,r.default)(e),(t=(0,a.default)(t,i)).allow_trailing_dot&&"."===e[e.length-1]&&(e=e.substring(0,e.length-1));for(var s=e.split("."),n=0;n<s.length;n++)if(s[n].length>63)return!1;if(t.require_tld){var o=s.pop();if(!s.length||!/^([a-z\u00a1-\uffff]{2,}|xn[a-z0-9-]{2,})$/i.test(o))return!1;if(/[\s\u2002-\u200B\u202F\u205F\u3000\uFEFF\uDB40\uDC20]/.test(o))return!1}for(var l,u=0;u<s.length;u++){if(l=s[u],t.allow_underscores&&(l=l.replace(/_/g,"")),!/^[a-z\u00a1-\uffff0-9-]+$/i.test(l))return!1;if(/[\uff01-\uff5e]/.test(l))return!1;if("-"===l[0]||"-"===l[l.length-1])return!1}return!0};var r=n(s(0)),a=n(s(5));function n(e){return e&&e.__esModule?e:{default:e}}var i={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1};e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=function(e,t){return e.some((function(e){return t===e}))},e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(s(2));let a=null;t.default=class{constructor(e=[],t){null==a?(this.workers=new Map,e.forEach(e=>{let t=new Blob([`importScripts("${e}")`]),s=new Worker(URL.createObjectURL(t));this.workers.set(e,s),this.receiveMessage(e,e=>{r.default.publish("ww_message",e)})}),a=this):t.debug({debug:"Attempted to create an instance of WorkerController when one already existed - Returning existing instance."})}static Instance(){if(null==a)throw new Error("Attempting to access an instance of WorkerController before instantiation.");return a}formatEvent(e){return e&&e instanceof CustomEvent?e.detail:e}broadcastMessage(e){let t=this.formatEvent(e);this.workers.forEach(e=>{e.postMessage(t)})}sendMessage(e,t){this.workers.get(e).postMessage(t)}receiveMessage(e,t){this.workers.get(e).onmessage=function(e){t(e)}}onError(e,t){this.workers.get(e).onerror=function(e){t(e)}}static Destroy(){a=null}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=n(s(1)),a=n(s(3));function n(e){return e&&e.__esModule?e:{default:e}}class i{static getUrlParamsObject(e){const t={};if(void 0!==e){let s;const r=/\+/g,a=/([^&=]+)=?([^&]*)/g,n=function(e){return decodeURIComponent(e.replace(r," "))},i=e.substring(0);for(;s=a.exec(i);)t[n(s[1])]=n(s[2])}return t}static urlParam(e,t){const s=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);if(!s)return;const r=s[1];return void 0!==r?decodeURIComponent(r):void 0}static getHostUrl(e,t){const s=i.urlParam("host",t);if(void 0!==s)return s;const r=(void 0!==e?e:{}).ciHost;if(void 0!==r)return r;const a=i.urlParam("localWebSocketPort",t);return`wss://localhost:${void 0!==a?a:"7001"}`}static getLoggerUrl(e,t){let s=(void 0!==e?e:{}).loggerUrl;return void 0!==s?s:void 0!==(s=i.urlParam("loggerUrl",t))?s:void 0}static getLogLevel(e,t){let s=(void 0!==e?e:{}).logLevel;return void 0!==s?s:void 0!==(s=i.urlParam("logLevel",t))?s:void 0}static getDeviceId(e){let t=i.urlParam("machineNumber",e);return void 0!==t?t:void 0!==(t=i.urlParam("deviceId",e))?t:"UNASSIGNED"}static getFloorLoc(e){let t=i.urlParam("location",e);return void 0!==t?t:"UNKNOWN-LOCATION"}static filterPageUrl(e,t=[]){return e.replace(/^.*\?(.*)$/,"$1").split("&").filter(e=>-1===t.indexOf(e.split("=")[0])).join("&")}static normalizeUrlMap(e){const t=/^0[xX][0-9a-fA-F]{2}$/,s=JSON.parse(JSON.stringify(e));s.screenIdMap={},s.indexUrl=e.baseUrl?e.baseUrl+e.indexUrl:e.indexUrl,s.bannerUrl=e.baseUrl?e.baseUrl+e.bannerUrl:e.bannerUrl,s.pinContentUrl=e.baseUrl?e.baseUrl+e.pinContentUrl:e.pinContentUrl,s.systemUrl=e.baseUrl?e.baseUrl+e.systemUrl:e.systemUrl;const n=e.screenIdMap,i={};return Object.keys(n).map((function(s){const o=e.baseUrl?e.baseUrl+n[s]:n[s];if(t.test(s))i[r.default.normalizeId(s)]=o;else{const e=a.default[s.toUpperCase()];if(!e)throw'Unable to resolve friendly screen name "'+s+'" to hex screen id.';i[e]=o}})),s.screenIdMap=i,e.legacyIdList&&(s.legacyIdList=e.legacyIdList.map(e=>{if(t.test(e))return e;{const t=a.default[e.toUpperCase()];if(!t)throw'Unable to resolve friendly screen name "undefined" to hex screen id.';return t}})),s}}t.default=i},function(e,t){var s,r,a=e.exports={};function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(s===setTimeout)return setTimeout(e,0);if((s===n||!s)&&setTimeout)return s=setTimeout,setTimeout(e,0);try{return s(e,0)}catch(t){try{return s.call(null,e,0)}catch(t){return s.call(this,e,0)}}}!function(){try{s="function"==typeof setTimeout?setTimeout:n}catch(e){s=n}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var l,u=[],c=!1,d=-1;function h(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length&&p())}function p(){if(!c){var e=o(h);c=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function f(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];u.push(new g(e,t)),1!==u.length||c||o(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=f,a.addListener=f,a.once=f,a.off=f,a.removeListener=f,a.removeAllListeners=f,a.emit=f,a.prependListener=f,a.prependOnceListener=f,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t,s){(function(t){var s="Expected a function",r="__lodash_hash_undefined__",a=1/0,n="[object Function]",i="[object GeneratorFunction]",o="[object Symbol]",l=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/,c=/^\./,d=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,h=/\\(\\)?/g,p=/^\[object .+?Constructor\]$/,g="object"==typeof t&&t&&t.Object===Object&&t,f="object"==typeof self&&self&&self.Object===Object&&self,_=g||f||Function("return this")(),E=Array.prototype,S=Function.prototype,C=Object.prototype,m=_["__core-js_shared__"],A=function(){var e=/[^.]+$/.exec(m&&m.keys&&m.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),P=S.toString,b=C.hasOwnProperty,I=C.toString,T=RegExp("^"+P.call(b).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),v=_.Symbol,y=E.splice,R=w(_,"Map"),N=w(Object,"create"),O=v?v.prototype:void 0,L=O?O.toString:void 0;function B(e){var t=-1,s=e?e.length:0;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}function D(e){var t=-1,s=e?e.length:0;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}function M(e){var t=-1,s=e?e.length:0;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}function x(e,t){for(var s=e.length;s--;)if(X(e[s][0],t))return s;return-1}function U(e,t){var s=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?s["string"==typeof t?"string":"hash"]:s.map}function w(e,t){var s=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!j(e)||function(e){return!!A&&A in e}(e))&&(function(e){var t=j(e)?I.call(e):"";return t==n||t==i}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?T:p).test(function(e){if(null!=e){try{return P.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}(s)?s:void 0}B.prototype.clear=function(){this.__data__=N?N(null):{}},B.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},B.prototype.get=function(e){var t=this.__data__;if(N){var s=t[e];return s===r?void 0:s}return b.call(t,e)?t[e]:void 0},B.prototype.has=function(e){var t=this.__data__;return N?void 0!==t[e]:b.call(t,e)},B.prototype.set=function(e,t){return this.__data__[e]=N&&void 0===t?r:t,this},D.prototype.clear=function(){this.__data__=[]},D.prototype.delete=function(e){var t=this.__data__,s=x(t,e);return!(s<0||(s==t.length-1?t.pop():y.call(t,s,1),0))},D.prototype.get=function(e){var t=this.__data__,s=x(t,e);return s<0?void 0:t[s][1]},D.prototype.has=function(e){return x(this.__data__,e)>-1},D.prototype.set=function(e,t){var s=this.__data__,r=x(s,e);return r<0?s.push([e,t]):s[r][1]=t,this},M.prototype.clear=function(){this.__data__={hash:new B,map:new(R||D),string:new B}},M.prototype.delete=function(e){return U(this,e).delete(e)},M.prototype.get=function(e){return U(this,e).get(e)},M.prototype.has=function(e){return U(this,e).has(e)},M.prototype.set=function(e,t){return U(this,e).set(e,t),this};var k=V((function(e){e=function(e){return null==e?"":function(e){if("string"==typeof e)return e;if($(e))return L?L.call(e):"";var t=e+"";return"0"==t&&1/e==-a?"-0":t}(e)}(e);var t=[];return c.test(e)&&t.push(""),e.replace(d,(function(e,s,r,a){t.push(r?a.replace(h,"$1"):s||e)})),t}));function F(e){if("string"==typeof e||$(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function V(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(s);var r=function(){var s=arguments,a=t?t.apply(this,s):s[0],n=r.cache;if(n.has(a))return n.get(a);var i=e.apply(this,s);return r.cache=n.set(a,i),i};return r.cache=new(V.Cache||M),r}function X(e,t){return e===t||e!=e&&t!=t}V.Cache=M;var G=Array.isArray;function j(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function $(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&I.call(e)==o}e.exports=function(e,t,s){var r=null==e?void 0:function(e,t){for(var s=0,r=(t=function(e,t){if(G(e))return!1;var s=typeof e;return!("number"!=s&&"symbol"!=s&&"boolean"!=s&&null!=e&&!$(e))||u.test(e)||!l.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:function(e){return G(e)?e:k(e)}(t)).length;null!=e&&s<r;)e=e[F(t[s++])];return s&&s==r?e:void 0}(e,t);return void 0===r?s:r}}).call(this,s(40))},function(e,t){var s;s=function(){return this}();try{s=s||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(s=window)}e.exports=s},function(e,t,s){e.exports=!s(9)&&!s(17)((function(){return 7!=Object.defineProperty(s(42)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,s){var r=s(13),a=s(4).document,n=r(a)&&r(a.createElement);e.exports=function(e){return n?a.createElement(e):{}}},function(e,t,s){t.f=s(15)},function(e,t,s){var r=s(8),a=s(16),n=s(80)(!1),i=s(47)("IE_PROTO");e.exports=function(e,t){var s,o=a(e),l=0,u=[];for(s in o)s!=i&&r(o,s)&&u.push(s);for(;t.length>l;)r(o,s=t[l++])&&(~n(u,s)||u.push(s));return u}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var s=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:s)(e)}},function(e,t,s){var r=s(19)("keys"),a=s(14);e.exports=function(e){return r[e]||(r[e]=a(e))}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,s){var r=s(44),a=s(29).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,a)}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),parseFloat(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var s,n;(0,r.default)(e),"object"===a(t)?(s=t.min||0,n=t.max):(s=arguments[1],n=arguments[2]);var i=encodeURI(e).split(/%..|./).length-1;return i>=s&&(void 0===n||i<=n)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,r.default)(e);var s=(t=t||{}).hasOwnProperty("allow_leading_zeroes")&&!t.allow_leading_zeroes?a:n,i=!t.hasOwnProperty("min")||e>=t.min,o=!t.hasOwnProperty("max")||e<=t.max,l=!t.hasOwnProperty("lt")||e<t.lt,u=!t.hasOwnProperty("gt")||e>t.gt;return s.test(e)&&i&&o&&l&&u};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^(?:[-+]?(?:0|[1-9][0-9]*))$/,n=/^[-+]?[0-9]+$/;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),a.test(e)},t.fullWidth=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/[^\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/;t.fullWidth=a},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),a.test(e)},t.halfWidth=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/[\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/;t.halfWidth=a},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),a.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^[0-9A-F]+$/i;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,r.default)(e);var s=t?new RegExp("^[".concat(t,"]+"),"g"):/^\s+/g;return e.replace(s,"")};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,r.default)(e);for(var s=t?new RegExp("[".concat(t,"]")):/\s/,a=e.length-1;a>=0&&s.test(e[a]);a--);return a<e.length?e.substr(0,a+1):e};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)(e),e.replace(new RegExp("[".concat(t,"]+"),"g"),"")};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){var r=s(31),a=s(11),n=s(7),i={multipleOf:function(e,t,s){"number"==typeof s&&"integer"!==n.whatIs(s/t.multipleOf)&&e.addError("MULTIPLE_OF",[s,t.multipleOf],null,t)},maximum:function(e,t,s){"number"==typeof s&&(!0!==t.exclusiveMaximum?s>t.maximum&&e.addError("MAXIMUM",[s,t.maximum],null,t):s>=t.maximum&&e.addError("MAXIMUM_EXCLUSIVE",[s,t.maximum],null,t))},exclusiveMaximum:function(){},minimum:function(e,t,s){"number"==typeof s&&(!0!==t.exclusiveMinimum?s<t.minimum&&e.addError("MINIMUM",[s,t.minimum],null,t):s<=t.minimum&&e.addError("MINIMUM_EXCLUSIVE",[s,t.minimum],null,t))},exclusiveMinimum:function(){},maxLength:function(e,t,s){"string"==typeof s&&n.ucs2decode(s).length>t.maxLength&&e.addError("MAX_LENGTH",[s.length,t.maxLength],null,t)},minLength:function(e,t,s){"string"==typeof s&&n.ucs2decode(s).length<t.minLength&&e.addError("MIN_LENGTH",[s.length,t.minLength],null,t)},pattern:function(e,t,s){"string"==typeof s&&!1===RegExp(t.pattern).test(s)&&e.addError("PATTERN",[t.pattern,s],null,t)},additionalItems:function(e,t,s){Array.isArray(s)&&!1===t.additionalItems&&Array.isArray(t.items)&&s.length>t.items.length&&e.addError("ARRAY_ADDITIONAL_ITEMS",null,null,t)},items:function(){},maxItems:function(e,t,s){Array.isArray(s)&&s.length>t.maxItems&&e.addError("ARRAY_LENGTH_LONG",[s.length,t.maxItems],null,t)},minItems:function(e,t,s){Array.isArray(s)&&s.length<t.minItems&&e.addError("ARRAY_LENGTH_SHORT",[s.length,t.minItems],null,t)},uniqueItems:function(e,t,s){if(Array.isArray(s)&&!0===t.uniqueItems){var r=[];!1===n.isUniqueArray(s,r)&&e.addError("ARRAY_UNIQUE",r,null,t)}},maxProperties:function(e,t,s){if("object"===n.whatIs(s)){var r=Object.keys(s).length;r>t.maxProperties&&e.addError("OBJECT_PROPERTIES_MAXIMUM",[r,t.maxProperties],null,t)}},minProperties:function(e,t,s){if("object"===n.whatIs(s)){var r=Object.keys(s).length;r<t.minProperties&&e.addError("OBJECT_PROPERTIES_MINIMUM",[r,t.minProperties],null,t)}},required:function(e,t,s){if("object"===n.whatIs(s))for(var r=t.required.length;r--;){var a=t.required[r];void 0===s[a]&&e.addError("OBJECT_MISSING_REQUIRED_PROPERTY",[a],null,t)}},additionalProperties:function(e,t,s){if(void 0===t.properties&&void 0===t.patternProperties)return i.properties.call(this,e,t,s)},patternProperties:function(e,t,s){if(void 0===t.properties)return i.properties.call(this,e,t,s)},properties:function(e,t,s){if("object"===n.whatIs(s)){var r=void 0!==t.properties?t.properties:{},a=void 0!==t.patternProperties?t.patternProperties:{};if(!1===t.additionalProperties){var i=Object.keys(s),o=Object.keys(r),l=Object.keys(a);i=n.difference(i,o);for(var u=l.length;u--;)for(var c=RegExp(l[u]),d=i.length;d--;)!0===c.test(i[d])&&i.splice(d,1);if(i.length>0){var h=this.options.assumeAdditional.length;if(h)for(;h--;){var p=i.indexOf(this.options.assumeAdditional[h]);-1!==p&&i.splice(p,1)}var g=i.length;if(g)for(;g--;)e.addError("OBJECT_ADDITIONAL_PROPERTIES",[i[g]],null,t)}}}},dependencies:function(e,s,r){if("object"===n.whatIs(r))for(var a=Object.keys(s.dependencies),i=a.length;i--;){var o=a[i];if(r[o]){var l=s.dependencies[o];if("object"===n.whatIs(l))t.validate.call(this,e,l,r);else for(var u=l.length;u--;){var c=l[u];void 0===r[c]&&e.addError("OBJECT_DEPENDENCY_KEY",[c,o],null,s)}}}},enum:function(e,t,s){for(var r=!1,a=!1,i=t.enum.length;i--;){if(n.areEqual(s,t.enum[i])){r=!0;break}n.areEqual(s,t.enum[i]),a=!0}if(!1===r){var o=a&&this.options.enumCaseInsensitiveComparison?"ENUM_CASE_MISMATCH":"ENUM_MISMATCH";e.addError(o,[s],null,t)}},type:function(e,t,s){var r=n.whatIs(s);"string"==typeof t.type?r===t.type||"integer"===r&&"number"===t.type||e.addError("INVALID_TYPE",[t.type,r],null,t):-1!==t.type.indexOf(r)||"integer"===r&&-1!==t.type.indexOf("number")||e.addError("INVALID_TYPE",[t.type,r],null,t)},allOf:function(e,s,r){for(var a=s.allOf.length;a--;){var n=t.validate.call(this,e,s.allOf[a],r);if(this.options.breakOnFirstError&&!1===n)break}},anyOf:function(e,s,r){for(var n=[],i=!1,o=s.anyOf.length;o--&&!1===i;){var l=new a(e);n.push(l),i=t.validate.call(this,l,s.anyOf[o],r)}!1===i&&e.addError("ANY_OF_MISSING",void 0,n,s)},oneOf:function(e,s,r){for(var n=0,i=[],o=s.oneOf.length;o--;){var l=new a(e,{maxErrors:1});i.push(l),!0===t.validate.call(this,l,s.oneOf[o],r)&&n++}0===n?e.addError("ONE_OF_MISSING",void 0,i,s):n>1&&e.addError("ONE_OF_MULTIPLE",null,null,s)},not:function(e,s,r){var n=new a(e);!0===t.validate.call(this,n,s.not,r)&&e.addError("NOT_PASSED",null,null,s)},definitions:function(){},format:function(e,t,s){var a=r[t.format];"function"==typeof a?2===a.length?e.addAsyncTask(a,[s],(function(r){!0!==r&&e.addError("INVALID_FORMAT",[t.format,s],null,t)})):!0!==a.call(this,s)&&e.addError("INVALID_FORMAT",[t.format,s],null,t):!0!==this.options.ignoreUnknownFormats&&e.addError("UNKNOWN_FORMAT",[t.format],null,t)}};t.JsonValidators=i,t.validate=function(e,s,r){e.commonErrorMessage="JSON_OBJECT_VALIDATION_FAILED";var a=n.whatIs(s);if("object"!==a)return e.addError("SCHEMA_NOT_AN_OBJECT",[a],null,s),!1;var o=Object.keys(s);if(0===o.length)return!0;var l=!1;if(e.rootSchema||(e.rootSchema=s,l=!0),void 0!==s.$ref){for(var u=99;s.$ref&&u>0;){if(!s.__$refResolved){e.addError("REF_UNRESOLVED",[s.$ref],null,s);break}if(s.__$refResolved===s)break;s=s.__$refResolved,o=Object.keys(s),u--}if(0===u)throw new Error("Circular dependency by $ref references!")}var c=n.whatIs(r);if(s.type&&(o.splice(o.indexOf("type"),1),i.type.call(this,e,s,r),e.errors.length&&this.options.breakOnFirstError))return!1;for(var d=o.length;d--&&!(i[o[d]]&&(i[o[d]].call(this,e,s,r),e.errors.length&&this.options.breakOnFirstError)););return 0!==e.errors.length&&!1!==this.options.breakOnFirstError||("array"===c?function(e,s,r){var a=r.length;if(Array.isArray(s.items))for(;a--;)a<s.items.length?(e.path.push(a.toString()),t.validate.call(this,e,s.items[a],r[a]),e.path.pop()):"object"==typeof s.additionalItems&&(e.path.push(a.toString()),t.validate.call(this,e,s.additionalItems,r[a]),e.path.pop());else if("object"==typeof s.items)for(;a--;)e.path.push(a.toString()),t.validate.call(this,e,s.items,r[a]),e.path.pop()}.call(this,e,s,r):"object"===c&&function(e,s,r){var a=s.additionalProperties;!0!==a&&void 0!==a||(a={});for(var n=s.properties?Object.keys(s.properties):[],i=s.patternProperties?Object.keys(s.patternProperties):[],o=Object.keys(r),l=o.length;l--;){var u=o[l],c=r[u],d=[];-1!==n.indexOf(u)&&d.push(s.properties[u]);for(var h=i.length;h--;){var p=i[h];!0===RegExp(p).test(u)&&d.push(s.patternProperties[p])}for(0===d.length&&!1!==a&&d.push(a),h=d.length;h--;)e.path.push(u),t.validate.call(this,e,d[h],c)}}.call(this,e,s,r)),"function"==typeof this.options.customValidator&&this.options.customValidator(e,s,r),l&&(e.rootSchema=void 0),0===e.errors.length}},function(e,t,s){var r=s(153),a=s(11),n=s(61),i=s(62),o=s(7);function l(e){return decodeURIComponent(e).replace(/~[0-1]/g,(function(e){return"~1"===e?"/":"~"}))}function u(e){var t=e.indexOf("#");return-1===t?e:e.slice(0,t)}function c(e,t){if("object"==typeof e&&null!==e){if(!t)return e;if(e.id&&(e.id===t||"#"===e.id[0]&&e.id.substring(1)===t))return e;var s,r;if(Array.isArray(e)){for(s=e.length;s--;)if(r=c(e[s],t))return r}else{var a=Object.keys(e);for(s=a.length;s--;){var n=a[s];if(0!==n.indexOf("__$")&&(r=c(e[n],t)))return r}}}}t.cacheSchemaByUri=function(e,t){var s=u(e);s&&(this.cache[s]=t)},t.removeFromCacheByUri=function(e){var t=u(e);t&&delete this.cache[t]},t.checkCacheForUri=function(e){var t=u(e);return!!t&&null!=this.cache[t]},t.getSchema=function(e,s){return"object"==typeof s&&(s=t.getSchemaByReference.call(this,e,s)),"string"==typeof s&&(s=t.getSchemaByUri.call(this,e,s)),s},t.getSchemaByReference=function(e,t){for(var s=this.referenceCache.length;s--;)if(r(this.referenceCache[s][0],t))return this.referenceCache[s][1];var a=o.cloneDeep(t);return this.referenceCache.push([t,a]),a},t.getSchemaByUri=function(e,t,s){var r=u(t),o=function(e){var t=e.indexOf("#");return-1===t?void 0:e.slice(t+1)}(t),d=r?this.cache[r]:s;if(d&&r&&d!==s){e.path.push(r);var h=new a(e);if(n.compileSchema.call(this,h,d)){var p=this.options;try{this.options=d.__$validationOptions||this.options,i.validateSchema.call(this,h,d)}finally{this.options=p}}var g=h.isValid();if(g||e.addError("REMOTE_NOT_VALID",[t],h),e.path.pop(),!g)return}if(d&&o)for(var f=o.split("/"),_=0,E=f.length;d&&_<E;_++){var S=l(f[_]);d=0===_?c(d,S):d[S]}return d},t.getRemotePath=u},function(e,t,s){var r=s(11),a=s(60),n=s(7);function i(e,t){if(n.isAbsoluteUri(t))return t;var s,r=e.join(""),a=n.isAbsoluteUri(r),i=n.isRelativeUri(r),o=n.isRelativeUri(t);a&&o?(s=r.match(/\/[^\/]*$/))&&(r=r.slice(0,s.index+1)):i&&o?r="":(s=r.match(/[^#/]+$/))&&(r=r.slice(0,s.index));var l=r+t;return l.replace(/##/,"#")}var o=function(e,s){for(var a=s.length,n=0;a--;){var i=new r(e);t.compileSchema.call(this,i,s[a])&&n++,e.errors=e.errors.concat(i.errors)}return n};function l(e,t){for(var s=e.length;s--;)if(e[s].id===t)return e[s];return null}t.compileSchema=function(e,s){if(e.commonErrorMessage="SCHEMA_COMPILATION_FAILED","string"==typeof s){var u=a.getSchemaByUri.call(this,e,s);if(!u)return e.addError("SCHEMA_NOT_REACHABLE",[s]),!1;s=u}if(Array.isArray(s))return function(e,t){var s,r=0;do{for(var a=e.errors.length;a--;)"UNRESOLVABLE_REFERENCE"===e.errors[a].code&&e.errors.splice(a,1);for(s=r,r=o.call(this,e,t),a=t.length;a--;){var n=t[a];if(n.__$missingReferences){for(var i=n.__$missingReferences.length;i--;){var u=n.__$missingReferences[i],c=l(t,u.ref);c&&(u.obj["__"+u.key+"Resolved"]=c,n.__$missingReferences.splice(i,1))}0===n.__$missingReferences.length&&delete n.__$missingReferences}}}while(r!==t.length&&r!==s);return e.isValid()}.call(this,e,s);if(s.__$compiled&&s.id&&!1===a.checkCacheForUri.call(this,s.id)&&(s.__$compiled=void 0),s.__$compiled)return!0;s.id&&"string"==typeof s.id&&a.cacheSchemaByUri.call(this,s.id,s);var c=!1;e.rootSchema||(e.rootSchema=s,c=!0);var d=e.isValid();delete s.__$missingReferences;for(var h=function e(t,s,r,a){if(s=s||[],r=r||[],a=a||[],"object"!=typeof t||null===t)return s;var n;if("string"==typeof t.id&&r.push(t.id),"string"==typeof t.$ref&&void 0===t.__$refResolved&&s.push({ref:i(r,t.$ref),key:"$ref",obj:t,path:a.slice(0)}),"string"==typeof t.$schema&&void 0===t.__$schemaResolved&&s.push({ref:i(r,t.$schema),key:"$schema",obj:t,path:a.slice(0)}),Array.isArray(t))for(n=t.length;n--;)a.push(n.toString()),e(t[n],s,r,a),a.pop();else{var o=Object.keys(t);for(n=o.length;n--;)0!==o[n].indexOf("__$")&&(a.push(o[n]),e(t[o[n]],s,r,a),a.pop())}return"string"==typeof t.id&&r.pop(),s}.call(this,s),p=h.length;p--;){var g=h[p],f=a.getSchemaByUri.call(this,e,g.ref,s);if(!f){var _=this.getSchemaReader();if(_){var E=_(g.ref);if(E){E.id=g.ref;var S=new r(e);t.compileSchema.call(this,S,E)?f=a.getSchemaByUri.call(this,e,g.ref,s):e.errors=e.errors.concat(S.errors)}}}if(!f){var C=e.hasError("REMOTE_NOT_VALID",[g.ref]),m=n.isAbsoluteUri(g.ref),A=!1,P=!0===this.options.ignoreUnresolvableReferences;m&&(A=a.checkCacheForUri.call(this,g.ref)),C||P&&m||A||(Array.prototype.push.apply(e.path,g.path),e.addError("UNRESOLVABLE_REFERENCE",[g.ref]),e.path=e.path.slice(0,-g.path.length),d&&(s.__$missingReferences=s.__$missingReferences||[],s.__$missingReferences.push(g)))}g.obj["__"+g.key+"Resolved"]=f}var b=e.isValid();return b?s.__$compiled=!0:s.id&&"string"==typeof s.id&&a.removeFromCacheByUri.call(this,s.id),c&&(e.rootSchema=void 0),b}},function(e,t,s){var r=s(31),a=s(59),n=s(11),i=s(7),o={$ref:function(e,t){"string"!=typeof t.$ref&&e.addError("KEYWORD_TYPE_EXPECTED",["$ref","string"])},$schema:function(e,t){"string"!=typeof t.$schema&&e.addError("KEYWORD_TYPE_EXPECTED",["$schema","string"])},multipleOf:function(e,t){"number"!=typeof t.multipleOf?e.addError("KEYWORD_TYPE_EXPECTED",["multipleOf","number"]):t.multipleOf<=0&&e.addError("KEYWORD_MUST_BE",["multipleOf","strictly greater than 0"])},maximum:function(e,t){"number"!=typeof t.maximum&&e.addError("KEYWORD_TYPE_EXPECTED",["maximum","number"])},exclusiveMaximum:function(e,t){"boolean"!=typeof t.exclusiveMaximum?e.addError("KEYWORD_TYPE_EXPECTED",["exclusiveMaximum","boolean"]):void 0===t.maximum&&e.addError("KEYWORD_DEPENDENCY",["exclusiveMaximum","maximum"])},minimum:function(e,t){"number"!=typeof t.minimum&&e.addError("KEYWORD_TYPE_EXPECTED",["minimum","number"])},exclusiveMinimum:function(e,t){"boolean"!=typeof t.exclusiveMinimum?e.addError("KEYWORD_TYPE_EXPECTED",["exclusiveMinimum","boolean"]):void 0===t.minimum&&e.addError("KEYWORD_DEPENDENCY",["exclusiveMinimum","minimum"])},maxLength:function(e,t){"integer"!==i.whatIs(t.maxLength)?e.addError("KEYWORD_TYPE_EXPECTED",["maxLength","integer"]):t.maxLength<0&&e.addError("KEYWORD_MUST_BE",["maxLength","greater than, or equal to 0"])},minLength:function(e,t){"integer"!==i.whatIs(t.minLength)?e.addError("KEYWORD_TYPE_EXPECTED",["minLength","integer"]):t.minLength<0&&e.addError("KEYWORD_MUST_BE",["minLength","greater than, or equal to 0"])},pattern:function(e,t){if("string"!=typeof t.pattern)e.addError("KEYWORD_TYPE_EXPECTED",["pattern","string"]);else try{RegExp(t.pattern)}catch(s){e.addError("KEYWORD_PATTERN",["pattern",t.pattern])}},additionalItems:function(e,s){var r=i.whatIs(s.additionalItems);"boolean"!==r&&"object"!==r?e.addError("KEYWORD_TYPE_EXPECTED",["additionalItems",["boolean","object"]]):"object"===r&&(e.path.push("additionalItems"),t.validateSchema.call(this,e,s.additionalItems),e.path.pop())},items:function(e,s){var r=i.whatIs(s.items);if("object"===r)e.path.push("items"),t.validateSchema.call(this,e,s.items),e.path.pop();else if("array"===r)for(var a=s.items.length;a--;)e.path.push("items"),e.path.push(a.toString()),t.validateSchema.call(this,e,s.items[a]),e.path.pop(),e.path.pop();else e.addError("KEYWORD_TYPE_EXPECTED",["items",["array","object"]]);!0===this.options.forceAdditional&&void 0===s.additionalItems&&Array.isArray(s.items)&&e.addError("KEYWORD_UNDEFINED_STRICT",["additionalItems"]),this.options.assumeAdditional&&void 0===s.additionalItems&&Array.isArray(s.items)&&(s.additionalItems=!1)},maxItems:function(e,t){"number"!=typeof t.maxItems?e.addError("KEYWORD_TYPE_EXPECTED",["maxItems","integer"]):t.maxItems<0&&e.addError("KEYWORD_MUST_BE",["maxItems","greater than, or equal to 0"])},minItems:function(e,t){"integer"!==i.whatIs(t.minItems)?e.addError("KEYWORD_TYPE_EXPECTED",["minItems","integer"]):t.minItems<0&&e.addError("KEYWORD_MUST_BE",["minItems","greater than, or equal to 0"])},uniqueItems:function(e,t){"boolean"!=typeof t.uniqueItems&&e.addError("KEYWORD_TYPE_EXPECTED",["uniqueItems","boolean"])},maxProperties:function(e,t){"integer"!==i.whatIs(t.maxProperties)?e.addError("KEYWORD_TYPE_EXPECTED",["maxProperties","integer"]):t.maxProperties<0&&e.addError("KEYWORD_MUST_BE",["maxProperties","greater than, or equal to 0"])},minProperties:function(e,t){"integer"!==i.whatIs(t.minProperties)?e.addError("KEYWORD_TYPE_EXPECTED",["minProperties","integer"]):t.minProperties<0&&e.addError("KEYWORD_MUST_BE",["minProperties","greater than, or equal to 0"])},required:function(e,t){if("array"!==i.whatIs(t.required))e.addError("KEYWORD_TYPE_EXPECTED",["required","array"]);else if(0===t.required.length)e.addError("KEYWORD_MUST_BE",["required","an array with at least one element"]);else{for(var s=t.required.length;s--;)"string"!=typeof t.required[s]&&e.addError("KEYWORD_VALUE_TYPE",["required","string"]);!1===i.isUniqueArray(t.required)&&e.addError("KEYWORD_MUST_BE",["required","an array with unique items"])}},additionalProperties:function(e,s){var r=i.whatIs(s.additionalProperties);"boolean"!==r&&"object"!==r?e.addError("KEYWORD_TYPE_EXPECTED",["additionalProperties",["boolean","object"]]):"object"===r&&(e.path.push("additionalProperties"),t.validateSchema.call(this,e,s.additionalProperties),e.path.pop())},properties:function(e,s){if("object"===i.whatIs(s.properties)){for(var r=Object.keys(s.properties),a=r.length;a--;){var n=r[a],o=s.properties[n];e.path.push("properties"),e.path.push(n),t.validateSchema.call(this,e,o),e.path.pop(),e.path.pop()}!0===this.options.forceAdditional&&void 0===s.additionalProperties&&e.addError("KEYWORD_UNDEFINED_STRICT",["additionalProperties"]),this.options.assumeAdditional&&void 0===s.additionalProperties&&(s.additionalProperties=!1),!0===this.options.forceProperties&&0===r.length&&e.addError("CUSTOM_MODE_FORCE_PROPERTIES",["properties"])}else e.addError("KEYWORD_TYPE_EXPECTED",["properties","object"])},patternProperties:function(e,s){if("object"===i.whatIs(s.patternProperties)){for(var r=Object.keys(s.patternProperties),a=r.length;a--;){var n=r[a],o=s.patternProperties[n];try{RegExp(n)}catch(t){e.addError("KEYWORD_PATTERN",["patternProperties",n])}e.path.push("patternProperties"),e.path.push(n.toString()),t.validateSchema.call(this,e,o),e.path.pop(),e.path.pop()}!0===this.options.forceProperties&&0===r.length&&e.addError("CUSTOM_MODE_FORCE_PROPERTIES",["patternProperties"])}else e.addError("KEYWORD_TYPE_EXPECTED",["patternProperties","object"])},dependencies:function(e,s){if("object"!==i.whatIs(s.dependencies))e.addError("KEYWORD_TYPE_EXPECTED",["dependencies","object"]);else for(var r=Object.keys(s.dependencies),a=r.length;a--;){var n=r[a],o=s.dependencies[n],l=i.whatIs(o);if("object"===l)e.path.push("dependencies"),e.path.push(n),t.validateSchema.call(this,e,o),e.path.pop(),e.path.pop();else if("array"===l){var u=o.length;for(0===u&&e.addError("KEYWORD_MUST_BE",["dependencies","not empty array"]);u--;)"string"!=typeof o[u]&&e.addError("KEYWORD_VALUE_TYPE",["dependensices","string"]);!1===i.isUniqueArray(o)&&e.addError("KEYWORD_MUST_BE",["dependencies","an array with unique items"])}else e.addError("KEYWORD_VALUE_TYPE",["dependencies","object or array"])}},enum:function(e,t){!1===Array.isArray(t.enum)?e.addError("KEYWORD_TYPE_EXPECTED",["enum","array"]):0===t.enum.length?e.addError("KEYWORD_MUST_BE",["enum","an array with at least one element"]):!1===i.isUniqueArray(t.enum)&&e.addError("KEYWORD_MUST_BE",["enum","an array with unique elements"])},type:function(e,t){var s=["array","boolean","integer","number","null","object","string"],r=s.join(","),a=Array.isArray(t.type);if(a){for(var n=t.type.length;n--;)-1===s.indexOf(t.type[n])&&e.addError("KEYWORD_TYPE_EXPECTED",["type",r]);!1===i.isUniqueArray(t.type)&&e.addError("KEYWORD_MUST_BE",["type","an object with unique properties"])}else"string"==typeof t.type?-1===s.indexOf(t.type)&&e.addError("KEYWORD_TYPE_EXPECTED",["type",r]):e.addError("KEYWORD_TYPE_EXPECTED",["type",["string","array"]]);!0===this.options.noEmptyStrings&&("string"===t.type||a&&-1!==t.type.indexOf("string"))&&void 0===t.minLength&&void 0===t.enum&&void 0===t.format&&(t.minLength=1),!0===this.options.noEmptyArrays&&("array"===t.type||a&&-1!==t.type.indexOf("array"))&&void 0===t.minItems&&(t.minItems=1),!0===this.options.forceProperties&&("object"===t.type||a&&-1!==t.type.indexOf("object"))&&void 0===t.properties&&void 0===t.patternProperties&&e.addError("KEYWORD_UNDEFINED_STRICT",["properties"]),!0===this.options.forceItems&&("array"===t.type||a&&-1!==t.type.indexOf("array"))&&void 0===t.items&&e.addError("KEYWORD_UNDEFINED_STRICT",["items"]),!0===this.options.forceMinItems&&("array"===t.type||a&&-1!==t.type.indexOf("array"))&&void 0===t.minItems&&e.addError("KEYWORD_UNDEFINED_STRICT",["minItems"]),!0===this.options.forceMaxItems&&("array"===t.type||a&&-1!==t.type.indexOf("array"))&&void 0===t.maxItems&&e.addError("KEYWORD_UNDEFINED_STRICT",["maxItems"]),!0===this.options.forceMinLength&&("string"===t.type||a&&-1!==t.type.indexOf("string"))&&void 0===t.minLength&&void 0===t.format&&void 0===t.enum&&void 0===t.pattern&&e.addError("KEYWORD_UNDEFINED_STRICT",["minLength"]),!0===this.options.forceMaxLength&&("string"===t.type||a&&-1!==t.type.indexOf("string"))&&void 0===t.maxLength&&void 0===t.format&&void 0===t.enum&&void 0===t.pattern&&e.addError("KEYWORD_UNDEFINED_STRICT",["maxLength"])},allOf:function(e,s){if(!1===Array.isArray(s.allOf))e.addError("KEYWORD_TYPE_EXPECTED",["allOf","array"]);else if(0===s.allOf.length)e.addError("KEYWORD_MUST_BE",["allOf","an array with at least one element"]);else for(var r=s.allOf.length;r--;)e.path.push("allOf"),e.path.push(r.toString()),t.validateSchema.call(this,e,s.allOf[r]),e.path.pop(),e.path.pop()},anyOf:function(e,s){if(!1===Array.isArray(s.anyOf))e.addError("KEYWORD_TYPE_EXPECTED",["anyOf","array"]);else if(0===s.anyOf.length)e.addError("KEYWORD_MUST_BE",["anyOf","an array with at least one element"]);else for(var r=s.anyOf.length;r--;)e.path.push("anyOf"),e.path.push(r.toString()),t.validateSchema.call(this,e,s.anyOf[r]),e.path.pop(),e.path.pop()},oneOf:function(e,s){if(!1===Array.isArray(s.oneOf))e.addError("KEYWORD_TYPE_EXPECTED",["oneOf","array"]);else if(0===s.oneOf.length)e.addError("KEYWORD_MUST_BE",["oneOf","an array with at least one element"]);else for(var r=s.oneOf.length;r--;)e.path.push("oneOf"),e.path.push(r.toString()),t.validateSchema.call(this,e,s.oneOf[r]),e.path.pop(),e.path.pop()},not:function(e,s){"object"!==i.whatIs(s.not)?e.addError("KEYWORD_TYPE_EXPECTED",["not","object"]):(e.path.push("not"),t.validateSchema.call(this,e,s.not),e.path.pop())},definitions:function(e,s){if("object"!==i.whatIs(s.definitions))e.addError("KEYWORD_TYPE_EXPECTED",["definitions","object"]);else for(var r=Object.keys(s.definitions),a=r.length;a--;){var n=r[a],o=s.definitions[n];e.path.push("definitions"),e.path.push(n),t.validateSchema.call(this,e,o),e.path.pop(),e.path.pop()}},format:function(e,t){"string"!=typeof t.format?e.addError("KEYWORD_TYPE_EXPECTED",["format","string"]):void 0===r[t.format]&&!0!==this.options.ignoreUnknownFormats&&e.addError("UNKNOWN_FORMAT",[t.format])},id:function(e,t){"string"!=typeof t.id&&e.addError("KEYWORD_TYPE_EXPECTED",["id","string"])},title:function(e,t){"string"!=typeof t.title&&e.addError("KEYWORD_TYPE_EXPECTED",["title","string"])},description:function(e,t){"string"!=typeof t.description&&e.addError("KEYWORD_TYPE_EXPECTED",["description","string"])},default:function(){}};t.validateSchema=function(e,s){if(e.commonErrorMessage="SCHEMA_VALIDATION_FAILED",Array.isArray(s))return function(e,s){for(var r=s.length;r--;)t.validateSchema.call(this,e,s[r]);return e.isValid()}.call(this,e,s);if(s.__$validated)return!0;var r=s.$schema&&s.id!==s.$schema;if(r)if(s.__$schemaResolved&&s.__$schemaResolved!==s){var l=new n(e);!1===a.validate.call(this,l,s.__$schemaResolved,s)&&e.addError("PARENT_SCHEMA_VALIDATION_FAILED",null,l)}else!0!==this.options.ignoreUnresolvableReferences&&e.addError("REF_UNRESOLVED",[s.$schema]);if(!0===this.options.noTypeless){if(void 0!==s.type){var u=[];Array.isArray(s.anyOf)&&(u=u.concat(s.anyOf)),Array.isArray(s.oneOf)&&(u=u.concat(s.oneOf)),Array.isArray(s.allOf)&&(u=u.concat(s.allOf)),u.forEach((function(e){e.type||(e.type=s.type)}))}void 0===s.enum&&void 0===s.type&&void 0===s.anyOf&&void 0===s.oneOf&&void 0===s.not&&void 0===s.$ref&&e.addError("KEYWORD_UNDEFINED_STRICT",["type"])}for(var c=Object.keys(s),d=c.length;d--;){var h=c[d];0!==h.indexOf("__")&&(void 0!==o[h]?o[h].call(this,e,s):r||!0===this.options.noExtraKeywords&&e.addError("KEYWORD_UNEXPECTED",[h]))}if(!0===this.options.pedanticCheck){if(s.enum){var p=i.clone(s);for(delete p.enum,delete p.default,e.path.push("enum"),d=s.enum.length;d--;)e.path.push(d.toString()),a.validate.call(this,e,p,s.enum[d]),e.path.pop();e.path.pop()}s.default&&(e.path.push("default"),a.validate.call(this,e,s,s.default),e.path.pop())}var g=e.isValid();return g&&(s.__$validated=!0),g}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{static postMessage(e,t){e.postMessage(t,"*")}static asyncForEach(e,t){return function(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,s){return function r(a,n){try{var i=t[a](n),o=i.value}catch(e){return void s(e)}if(!i.done)return Promise.resolve(o).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(o)}("next")}))}}((function*(){for(let s=0;s<e.length;s++)yield t(e[s],s,e)}))()}}},function(e,t,s){!function(e){var t={};e.SRP_POINTS_EARNED="0x0F",t[e.SRP_POINTS_EARNED]="SRP Points Earned so far",e.MACHINE_ASSET_NUMBER="0x10",t[e.MACHINE_ASSET_NUMBER]="Machine Asset Number",e.PLAYER_POINT_BALANCE="0x11",t[e.PLAYER_POINT_BALANCE]="Player Point Balance",e.PLAYER_POINT_COUNTDOWN="0x12",t[e.PLAYER_POINT_COUNTDOWN]="Player Point Countdown",e.PLAYER_POINTS_EARNED_SESSION="0x13",t[e.PLAYER_POINTS_EARNED_SESSION]="Player Points Earned this session",e.LAST_MACHINE_EVENT_RECORDED="0x14",t[e.LAST_MACHINE_EVENT_RECORDED]="Last Machine Event Recorded",e.FREE_FOR_ALL_WON="0x15",t[e.FREE_FOR_ALL_WON]="Free For All (Won So Far)",e.WELCOME_BACK_POINTS_TO_GO="0x16",t[e.WELCOME_BACK_POINTS_TO_GO]="Welcome Back Points to go",e.UNIQUE_ID_OF_BE2="0x17",t[e.UNIQUE_ID_OF_BE2]="Unique Id (of BE2)",e.CURRENT_MJT_MULTIPLIER="0x18",t[e.CURRENT_MJT_MULTIPLIER]="Current MJT Multiplier",e.FREE_PLAY_AMOUNT_IN_CENTS="0x19",t[e.FREE_PLAY_AMOUNT_IN_CENTS]="Free Play Amount (in cents)",e.MATCH_PLAY_XTRA_CREDIT_BALANCE="0x1A",t[e.MATCH_PLAY_XTRA_CREDIT_BALANCE]="Match Play (Xtra Credit) Balance",e.PLAYER_POINT_PLAY_BALANCE="0x1B",t[e.PLAYER_POINT_PLAY_BALANCE]="Player Point Balance available for Point Play",e.POINT_MULTIPLIER_INTEGER_TOKEN="0x1D",t[e.POINT_MULTIPLIER_INTEGER_TOKEN]="Point Multiplier integer token",e.AMOUNT_OF_BONUS_WIN_IN_COINS="0x1E",t[e.AMOUNT_OF_BONUS_WIN_IN_COINS]="Amount of bonus/consolation win in coins",e.BILL_METER_DENOMINATION="0x20",t[e.BILL_METER_DENOMINATION]="The current Bill Meter Denomination",e.CUMULATIVE_SRP_AWARD_AMOUNT="0x21",t[e.CUMULATIVE_SRP_AWARD_AMOUNT]="The players cumulative SRP Award Amount",e.SRP_AWARD_AMOUNT_NEXT_TIER="0x22",t[e.SRP_AWARD_AMOUNT_NEXT_TIER]="The SRP Award Amount for this players next Tier -0 if at top tier",e.XTRA_CREDIT_INACTIVE_AMOUNT="0x23",t[e.XTRA_CREDIT_INACTIVE_AMOUNT]="The amount of Xtra Credit Inactive Storage",e.CARDED_LUCKY_COIN_POOL="0x24",t[e.CARDED_LUCKY_COIN_POOL]="Current pool amount (Carded Lucky Coin)",e.HANDPAY_AMOUNT="0x25",t[e.HANDPAY_AMOUNT]="Handpay Amount",e.FREE_PLAY_AMOUNT_CENTS="0x26",t[e.FREE_PLAY_AMOUNT_CENTS]="Free Play Amount (in cents)",e.MATCH_PLAY_XTRA_CREDIT_CENTS="0x27",t[e.MATCH_PLAY_XTRA_CREDIT_CENTS]="Match Play (Xtra Credit) balance (in cents)",e.PERSONAL_PROGRESSIVE_DOLLARS="0x28",t[e.PERSONAL_PROGRESSIVE_DOLLARS]="RPP (Personal Progressive) current pool balance in dollars",e.BONUS_CONSOLATION_WIN_DOLLARS="0x29",t[e.BONUS_CONSOLATION_WIN_DOLLARS]="Amount of bonus/consolation win in dollars",e.EFT_BALANCE_CURRENT_CARD_DOLLARS="0x2A",t[e.EFT_BALANCE_CURRENT_CARD_DOLLARS]="EFT balance for Current Card in dollars",e.EFT_AMOUNT_TRANSFER_DOLLARS="0x2B",t[e.EFT_AMOUNT_TRANSFER_DOLLARS]="EFT Amount Transferred to machine in dollars",e.WELCOME_BACK_RETURN_PLAY_AWARD_DOLLARS="0x2C",t[e.WELCOME_BACK_RETURN_PLAY_AWARD_DOLLARS]="Welcome Back (Return Play) award amount in dollars",e.FUNDS_TRANSFER_RECALL_AMOUNT_DOLLARS="0x2D",t[e.FUNDS_TRANSFER_RECALL_AMOUNT_DOLLARS]="Funds Transfer Recall amount in dollars",e.COMP_BALANCE_MONEY_TOKEN="0x2E",t[e.COMP_BALANCE_MONEY_TOKEN]="Comp balance money token",e.PLAYERS_PREFERRED_NAME="0x30",t[e.PLAYERS_PREFERRED_NAME]='Players "Preferred" name',e.PLAYERS_CARD_NUMBER="0x31",t[e.PLAYERS_CARD_NUMBER]="Players Card Number",e.NON_NULL_ON_ABANDONED_CARD="0x33",t[e.NON_NULL_ON_ABANDONED_CARD]="Normally NULL, changed to non-NULL on Abandoned Card",e.THE_SYSTEM_TIME="0x34",t[e.THE_SYSTEM_TIME]="The System Time",e.FLOOR_LOCATION_DUPLICATE_CARD="0x36",t[e.FLOOR_LOCATION_DUPLICATE_CARD]="Floor location of duplicate card",e.SRP_THRESHOLD_NEXT_TIER="0x40",t[e.SRP_THRESHOLD_NEXT_TIER]="The SRP threshold for th next tier – 0 if at top tier",e.POINTS_TO_NEXT_THRESHOLD="0x41",t[e.POINTS_TO_NEXT_THRESHOLD]="Points required to reach next threshold - 0 if at top tier",e.SRP_THRESHOLD_TOP_TIER="0x42",t[e.SRP_THRESHOLD_TOP_TIER]="The SRP threshold for the top tier for this players level",e.POINT_ACCUMULATION_PLAYER_RANKING="0x43",t[e.POINT_ACCUMULATION_PLAYER_RANKING]="Point Accumulation by player ranking points earned during session",e.MJT_COUNTDOWN="0x44",t[e.MJT_COUNTDOWN]="Current MJT counting down the seconds or games left",e.PLAYER_ID="0x45",t[e.PLAYER_ID]="Player ID",e.DRAW_COUNTDOWN="0x46",t[e.DRAW_COUNTDOWN]="Draw Countdown",e.SUM_OF_SRP_PLAYER_LEVEL_AWARDS="0x70",t[e.SUM_OF_SRP_PLAYER_LEVEL_AWARDS]="Sum of all SRP awards for this player level",e.PLC_RPP_PERSONAL_PROGRESSIVE_THRESHOLD="0x71",t[e.PLC_RPP_PERSONAL_PROGRESSIVE_THRESHOLD]="PLC (RPP, Personal Progressive) Eligibility Threshold",e.PLC_RPP_PERSONAL_PROGRESSIVE_TO_GO="0x72",t[e.PLC_RPP_PERSONAL_PROGRESSIVE_TO_GO]="PLC (RPP, Personal Progressive) Distance to go to eligibility threshold",e.PLC_RPP_PERSONAL_PROGRESSIVE_MAXIMUM_AWARD="0x73",t[e.PLC_RPP_PERSONAL_PROGRESSIVE_MAXIMUM_AWARD]="PLC (RPP, Personal Progressive) maximum possible award",e.PLC_RPP_PERSONAL_PROGRESSIVE_AWARDED_VALUE="0x74",t[e.PLC_RPP_PERSONAL_PROGRESSIVE_AWARDED_VALUE]="PLC (RPP, Personal Progressive) Awarded Value",e.POINTS_COUNTDOWN_IN_MONEY="0x75",t[e.POINTS_COUNTDOWN_IN_MONEY]='Same as "points countdown" but in money',e.CASHLESS_BALANCE_OF_CARD="0x7A",t[e.CASHLESS_BALANCE_OF_CARD]="Current Cashless Balance of Card (MSC or SCC)",e.TOTAL_MONEY_AVAILABLE="0x7B",t[e.TOTAL_MONEY_AVAILABLE]="Players total money available (Credit Meter + Card Balance for MSC or SCC)",e.FREE_FOR_ALL_WON_CENTS="0x7C",t[e.FREE_FOR_ALL_WON_CENTS]="Free For All (Won So Far) in Cents",e.FLOOR_LOCATION="0xAF",t[e.FLOOR_LOCATION]="Floor Location",e.ASSIGNED_NUMBERS="0xB0",t[e.ASSIGNED_NUMBERS]="Assigned Numbers for Lucky Draw",e.WINNING_NUMBERS="0xB1",t[e.WINNING_NUMBERS]="Winning Numbers for Lucky Draw",e.TIME_TO_NEXT_DRAW="0xB2",t[e.TIME_TO_NEXT_DRAW]="Time to Next Draw",e.DRAW_NAME="0xB3",t[e.DRAW_NAME]="Draw name",e.VFD_MESSAGE_LINE_1="0xFE",t[e.VFD_MESSAGE_LINE_1]="VFD Message Line 1",e.VFD_MESSAGE_LINE_2="0xFF",t[e.VFD_MESSAGE_LINE_2]="VFD Message Line 2",e.getText=function(e){if(t.hasOwnProperty(e))return t[e];throw new Error("code does not exist: "+e)}}(t)},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=l(s(6)),a=l(s(196)),n=l(s(216)),i=l(s(217)),o=l(s(37));function l(e){return e&&e.__esModule?e:{default:e}}s(219).default;class u{constructor(e,t,s,a,l){const c=o.default.getDeviceId(e);let d={},h={},p={},g={};n.default.getJSONFile(t).then((function(t){d=t;const f=o.default.getHostUrl(d,e),_=o.default.getLoggerUrl(d,e),E=o.default.getLogLevel(d,e),S=o.default.getUrlParamsObject(e);n.default.getJSONFile(a).then((function(t){const a=new i.default(_,c,E,S,t);p=t,n.default.getJSONFile(l).then((function(t){g=t,n.default.getJSONFile(s).then((function(t){h=t,a.info({DeviceId:c,HostUrl:f,LoggerUrl:_,LogLevel:E,DiagnosticTargets:a.m5Config.diagnosticTargets}),Promise.all([r.default.validate(d,"urlmap"),r.default.validate(h,"statusmap")]).then(t=>{u.createShellController(f,e,d,h,a,p,g)}).catch(e=>{a.error({error:e},!0)})})).catch((function(e){const t="Shell: Error Parsing "+s+" - "+e.toString();a.error({error:t},!0)}))})).catch((function(e){const t="Shell: Error Parsing "+l+" - "+e.toString();a.error({error:t},!0)}))})).catch((function(e){const t="Shell: Error Parsing "+a+" - "+e.toString();throw new Error(t)}))})).catch((function(e){const s="Shell: Error Parsing "+t+" - "+e.toString();throw new Error(s)}))}static createShellController(e,t,s,r,n,i,l){new a.default(e,o.default.filterPageUrl(t,["localWebSocketPort","localXmlSocketPort"]),s,r,n,i,l)}}t.default=u},function(e,t,s){(function(t){s(67);var r=s(39),a=s(11),n=s(31),i=s(59),o=s(60),l=s(61),u=s(62),c=s(7),d=s(155),h=s(156),p={asyncTimeout:2e3,forceAdditional:!1,assumeAdditional:!1,enumCaseInsensitiveComparison:!1,forceItems:!1,forceMinItems:!1,forceMaxItems:!1,forceMinLength:!1,forceMaxLength:!1,forceProperties:!1,ignoreUnresolvableReferences:!1,noExtraKeywords:!1,noTypeless:!1,noEmptyStrings:!1,noEmptyArrays:!1,strictUris:!1,strictMode:!1,reportPathAsArray:!1,breakOnFirstError:!0,pedanticCheck:!1,ignoreUnknownFormats:!1,customValidator:null};function g(e){var t;if("object"==typeof e){for(var s,r=Object.keys(e),a=r.length;a--;)if(s=r[a],void 0===p[s])throw new Error("Unexpected option passed to constructor: "+s);for(a=(r=Object.keys(p)).length;a--;)void 0===e[s=r[a]]&&(e[s]=c.clone(p[s]));t=e}else t=c.clone(p);return!0===t.strictMode&&(t.forceAdditional=!0,t.forceItems=!0,t.forceMaxLength=!0,t.forceProperties=!0,t.noExtraKeywords=!0,t.noTypeless=!0,t.noEmptyStrings=!0,t.noEmptyArrays=!0),t}function f(e){this.cache={},this.referenceCache=[],this.validateOptions={},this.options=g(e);var t=g({});this.setRemoteReference("http://json-schema.org/draft-04/schema",d,t),this.setRemoteReference("http://json-schema.org/draft-04/hyper-schema",h,t)}f.prototype.compileSchema=function(e){var t=new a(this.options);return e=o.getSchema.call(this,t,e),l.compileSchema.call(this,t,e),this.lastReport=t,t.isValid()},f.prototype.validateSchema=function(e){if(Array.isArray(e)&&0===e.length)throw new Error(".validateSchema was called with an empty array");var t=new a(this.options);return e=o.getSchema.call(this,t,e),l.compileSchema.call(this,t,e)&&u.validateSchema.call(this,t,e),this.lastReport=t,t.isValid()},f.prototype.validate=function(e,s,n,d){"function"===c.whatIs(n)&&(d=n,n={}),n||(n={}),this.validateOptions=n;var h=c.whatIs(s);if("string"!==h&&"object"!==h){var p=new Error("Invalid .validate call - schema must be an string or object but "+h+" was passed!");if(d)return void t.nextTick((function(){d(p,!1)}));throw p}var g=!1,f=new a(this.options);if(f.json=e,"string"==typeof s){var _=s;if(!(s=o.getSchema.call(this,f,_)))throw new Error("Schema with id '"+_+"' wasn't found in the validator cache!")}else s=o.getSchema.call(this,f,s);var E=!1;g||(E=l.compileSchema.call(this,f,s)),E||(this.lastReport=f,g=!0);var S=!1;if(g||(S=u.validateSchema.call(this,f,s)),S||(this.lastReport=f,g=!0),n.schemaPath&&(f.rootSchema=s,!(s=r(s,n.schemaPath))))throw new Error("Schema path '"+n.schemaPath+"' wasn't found in the schema!");if(g||i.validate.call(this,f,s,e),!d){if(f.asyncTasks.length>0)throw new Error("This validation has async tasks and cannot be done in sync mode, please provide callback argument.");return this.lastReport=f,f.isValid()}f.processAsyncTasks(this.options.asyncTimeout,d)},f.prototype.getLastError=function(){if(0===this.lastReport.errors.length)return null;var e=new Error;return e.name="z-schema validation error",e.message=this.lastReport.commonErrorMessage,e.details=this.lastReport.errors,e},f.prototype.getLastErrors=function(){return this.lastReport&&this.lastReport.errors.length>0?this.lastReport.errors:void 0},f.prototype.getMissingReferences=function(e){for(var t=[],s=(e=e||this.lastReport.errors).length;s--;){var r=e[s];if("UNRESOLVABLE_REFERENCE"===r.code){var a=r.params[0];-1===t.indexOf(a)&&t.push(a)}r.inner&&(t=t.concat(this.getMissingReferences(r.inner)))}return t},f.prototype.getMissingRemoteReferences=function(){for(var e=this.getMissingReferences(),t=[],s=e.length;s--;){var r=o.getRemotePath(e[s]);r&&-1===t.indexOf(r)&&t.push(r)}return t},f.prototype.setRemoteReference=function(e,t,s){t="string"==typeof t?JSON.parse(t):c.cloneDeep(t),s&&(t.__$validationOptions=g(s)),o.cacheSchemaByUri.call(this,e,t)},f.prototype.getResolvedSchema=function(e){var t=new a(this.options);e=o.getSchema.call(this,t,e),e=c.cloneDeep(e);var s=[],r=function(e){var t,a=c.whatIs(e);if(("object"===a||"array"===a)&&!e.___$visited){if(e.___$visited=!0,s.push(e),e.$ref&&e.__$refResolved){var n=e.__$refResolved,i=e;for(t in delete e.$ref,delete e.__$refResolved,n)n.hasOwnProperty(t)&&(i[t]=n[t])}for(t in e)e.hasOwnProperty(t)&&(0===t.indexOf("__$")?delete e[t]:r(e[t]))}};if(r(e),s.forEach((function(e){delete e.___$visited})),this.lastReport=t,t.isValid())return e;throw this.getLastError()},f.prototype.setSchemaReader=function(e){return f.setSchemaReader(e)},f.prototype.getSchemaReader=function(){return f.schemaReader},f.schemaReader=void 0,f.setSchemaReader=function(e){f.schemaReader=e},f.registerFormat=function(e,t){n[e]=t},f.unregisterFormat=function(e){delete n[e]},f.getRegisteredFormats=function(){return Object.keys(n)},f.getDefaultOptions=function(){return c.cloneDeep(p)},f.schemaSymbol=c.schemaSymbol,f.jsonSymbol=c.jsonSymbol,e.exports=f}).call(this,s(38))},function(e,t){"function"!=typeof Number.isFinite&&(Number.isFinite=function(e){return"number"==typeof e&&e==e&&e!==1/0&&e!==-1/0})},function(e,t,s){e.exports={INVALID_TYPE:"Expected type {0} but found type {1}",INVALID_FORMAT:"Object didn't pass validation for format {0}: {1}",ENUM_MISMATCH:"No enum match for: {0}",ENUM_CASE_MISMATCH:"Enum does not match case for: {0}",ANY_OF_MISSING:"Data does not match any schemas from 'anyOf'",ONE_OF_MISSING:"Data does not match any schemas from 'oneOf'",ONE_OF_MULTIPLE:"Data is valid against more than one schema from 'oneOf'",NOT_PASSED:"Data matches schema from 'not'",ARRAY_LENGTH_SHORT:"Array is too short ({0}), minimum {1}",ARRAY_LENGTH_LONG:"Array is too long ({0}), maximum {1}",ARRAY_UNIQUE:"Array items are not unique (indexes {0} and {1})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",MULTIPLE_OF:"Value {0} is not a multiple of {1}",MINIMUM:"Value {0} is less than minimum {1}",MINIMUM_EXCLUSIVE:"Value {0} is equal or less than exclusive minimum {1}",MAXIMUM:"Value {0} is greater than maximum {1}",MAXIMUM_EXCLUSIVE:"Value {0} is equal or greater than exclusive maximum {1}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({0}), minimum {1}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({0}), maximum {1}",OBJECT_MISSING_REQUIRED_PROPERTY:"Missing required property: {0}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed: {0}",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {0} (due to key: {1})",MIN_LENGTH:"String is too short ({0} chars), minimum {1}",MAX_LENGTH:"String is too long ({0} chars), maximum {1}",PATTERN:"String does not match pattern {0}: {1}",KEYWORD_TYPE_EXPECTED:"Keyword '{0}' is expected to be of type '{1}'",KEYWORD_UNDEFINED_STRICT:"Keyword '{0}' must be defined in strict mode",KEYWORD_UNEXPECTED:"Keyword '{0}' is not expected to appear in the schema",KEYWORD_MUST_BE:"Keyword '{0}' must be {1}",KEYWORD_DEPENDENCY:"Keyword '{0}' requires keyword '{1}'",KEYWORD_PATTERN:"Keyword '{0}' is not a valid RegExp pattern: {1}",KEYWORD_VALUE_TYPE:"Each element of keyword '{0}' array must be a '{1}'",UNKNOWN_FORMAT:"There is no validation function for format '{0}'",CUSTOM_MODE_FORCE_PROPERTIES:"{0} must define at least one property if present",REF_UNRESOLVED:"Reference has not been resolved during compilation: {0}",UNRESOLVABLE_REFERENCE:"Reference could not be resolved: {0}",SCHEMA_NOT_REACHABLE:"Validator was not able to read schema with uri: {0}",SCHEMA_TYPE_EXPECTED:"Schema is expected to be of type 'object'",SCHEMA_NOT_AN_OBJECT:"Schema is not an object: {0}",ASYNC_TIMEOUT:"{0} asynchronous task(s) have timed out after {1} ms",PARENT_SCHEMA_VALIDATION_FAILED:"Schema failed to validate against its parent schema, see inner errors for details.",REMOTE_NOT_VALID:"Remote reference didn't compile successfully: {0}"}},function(e,t,s){s(70),s(90),e.exports=s(12).Symbol},function(e,t,s){var r=s(4),a=s(8),n=s(9),i=s(71),o=s(25),l=s(75).KEY,u=s(17),c=s(19),d=s(76),h=s(14),p=s(15),g=s(43),f=s(77),_=s(78),E=s(83),S=s(18),C=s(13),m=s(84),A=s(16),P=s(23),b=s(24),I=s(85),T=s(88),v=s(89),y=s(48),R=s(10),N=s(27),O=v.f,L=R.f,B=T.f,D=r.Symbol,M=r.JSON,x=M&&M.stringify,U=p("_hidden"),w=p("toPrimitive"),k={}.propertyIsEnumerable,F=c("symbol-registry"),V=c("symbols"),X=c("op-symbols"),G=Object.prototype,j="function"==typeof D&&!!y.f,$=r.QObject,Y=!$||!$.prototype||!$.prototype.findChild,W=n&&u((function(){return 7!=I(L({},"a",{get:function(){return L(this,"a",{value:7}).a}})).a}))?function(e,t,s){var r=O(G,t);r&&delete G[t],L(e,t,s),r&&e!==G&&L(G,t,r)}:L,H=function(e){var t=V[e]=I(D.prototype);return t._k=e,t},q=j&&"symbol"==typeof D.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof D},K=function(e,t,s){return e===G&&K(X,t,s),S(e),t=P(t,!0),S(s),a(V,t)?(s.enumerable?(a(e,U)&&e[U][t]&&(e[U][t]=!1),s=I(s,{enumerable:b(0,!1)})):(a(e,U)||L(e,U,b(1,{})),e[U][t]=!0),W(e,t,s)):L(e,t,s)},J=function(e,t){S(e);for(var s,r=_(t=A(t)),a=0,n=r.length;n>a;)K(e,s=r[a++],t[s]);return e},z=function(e){var t=k.call(this,e=P(e,!0));return!(this===G&&a(V,e)&&!a(X,e))&&(!(t||!a(this,e)||!a(V,e)||a(this,U)&&this[U][e])||t)},Z=function(e,t){if(e=A(e),t=P(t,!0),e!==G||!a(V,t)||a(X,t)){var s=O(e,t);return!s||!a(V,t)||a(e,U)&&e[U][t]||(s.enumerable=!0),s}},Q=function(e){for(var t,s=B(A(e)),r=[],n=0;s.length>n;)a(V,t=s[n++])||t==U||t==l||r.push(t);return r},ee=function(e){for(var t,s=e===G,r=B(s?X:A(e)),n=[],i=0;r.length>i;)!a(V,t=r[i++])||s&&!a(G,t)||n.push(V[t]);return n};j||(o((D=function(){if(this instanceof D)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function(s){this===G&&t.call(X,s),a(this,U)&&a(this[U],e)&&(this[U][e]=!1),W(this,e,b(1,s))};return n&&Y&&W(G,e,{configurable:!0,set:t}),H(e)}).prototype,"toString",(function(){return this._k})),v.f=Z,R.f=K,s(49).f=T.f=Q,s(30).f=z,y.f=ee,n&&!s(26)&&o(G,"propertyIsEnumerable",z,!0),g.f=function(e){return H(p(e))}),i(i.G+i.W+i.F*!j,{Symbol:D});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),se=0;te.length>se;)p(te[se++]);for(var re=N(p.store),ae=0;re.length>ae;)f(re[ae++]);i(i.S+i.F*!j,"Symbol",{for:function(e){return a(F,e+="")?F[e]:F[e]=D(e)},keyFor:function(e){if(!q(e))throw TypeError(e+" is not a symbol!");for(var t in F)if(F[t]===e)return t},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),i(i.S+i.F*!j,"Object",{create:function(e,t){return void 0===t?I(e):J(I(e),t)},defineProperty:K,defineProperties:J,getOwnPropertyDescriptor:Z,getOwnPropertyNames:Q,getOwnPropertySymbols:ee});var ne=u((function(){y.f(1)}));i(i.S+i.F*ne,"Object",{getOwnPropertySymbols:function(e){return y.f(m(e))}}),M&&i(i.S+i.F*(!j||u((function(){var e=D();return"[null]"!=x([e])||"{}"!=x({a:e})||"{}"!=x(Object(e))}))),"JSON",{stringify:function(e){for(var t,s,r=[e],a=1;arguments.length>a;)r.push(arguments[a++]);if(s=t=r[1],(C(t)||void 0!==e)&&!q(e))return E(t)||(t=function(e,t){if("function"==typeof s&&(t=s.call(this,e,t)),!q(t))return t}),r[1]=t,x.apply(M,r)}}),D.prototype[w]||s(22)(D.prototype,w,D.prototype.valueOf),d(D,"Symbol"),d(Math,"Math",!0),d(r.JSON,"JSON",!0)},function(e,t,s){var r=s(4),a=s(12),n=s(22),i=s(25),o=s(73),l=function(e,t,s){var u,c,d,h,p=e&l.F,g=e&l.G,f=e&l.S,_=e&l.P,E=e&l.B,S=g?r:f?r[t]||(r[t]={}):(r[t]||{}).prototype,C=g?a:a[t]||(a[t]={}),m=C.prototype||(C.prototype={});for(u in g&&(s=t),s)d=((c=!p&&S&&void 0!==S[u])?S:s)[u],h=E&&c?o(d,r):_&&"function"==typeof d?o(Function.call,d):d,S&&i(S,u,d,e&l.U),C[u]!=d&&n(C,u,h),_&&m[u]!=d&&(m[u]=d)};r.core=a,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,s){e.exports=s(19)("native-function-to-string",Function.toString)},function(e,t,s){var r=s(74);e.exports=function(e,t,s){if(r(e),void 0===t)return e;switch(s){case 1:return function(s){return e.call(t,s)};case 2:return function(s,r){return e.call(t,s,r)};case 3:return function(s,r,a){return e.call(t,s,r,a)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,s){var r=s(14)("meta"),a=s(13),n=s(8),i=s(10).f,o=0,l=Object.isExtensible||function(){return!0},u=!s(17)((function(){return l(Object.preventExtensions({}))})),c=function(e){i(e,r,{value:{i:"O"+ ++o,w:{}}})},d=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!n(e,r)){if(!l(e))return"F";if(!t)return"E";c(e)}return e[r].i},getWeak:function(e,t){if(!n(e,r)){if(!l(e))return!0;if(!t)return!1;c(e)}return e[r].w},onFreeze:function(e){return u&&d.NEED&&l(e)&&!n(e,r)&&c(e),e}}},function(e,t,s){var r=s(10).f,a=s(8),n=s(15)("toStringTag");e.exports=function(e,t,s){e&&!a(e=s?e:e.prototype,n)&&r(e,n,{configurable:!0,value:t})}},function(e,t,s){var r=s(4),a=s(12),n=s(26),i=s(43),o=s(10).f;e.exports=function(e){var t=a.Symbol||(a.Symbol=n?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||o(t,e,{value:i.f(e)})}},function(e,t,s){var r=s(27),a=s(48),n=s(30);e.exports=function(e){var t=r(e),s=a.f;if(s)for(var i,o=s(e),l=n.f,u=0;o.length>u;)l.call(e,i=o[u++])&&t.push(i);return t}},function(e,t,s){var r=s(28);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,s){var r=s(16),a=s(81),n=s(82);e.exports=function(e){return function(t,s,i){var o,l=r(t),u=a(l.length),c=n(i,u);if(e&&s!=s){for(;u>c;)if((o=l[c++])!=o)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===s)return e||c||0;return!e&&-1}}},function(e,t,s){var r=s(46),a=Math.min;e.exports=function(e){return e>0?a(r(e),9007199254740991):0}},function(e,t,s){var r=s(46),a=Math.max,n=Math.min;e.exports=function(e,t){return(e=r(e))<0?a(e+t,0):n(e,t)}},function(e,t,s){var r=s(28);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,s){var r=s(45);e.exports=function(e){return Object(r(e))}},function(e,t,s){var r=s(18),a=s(86),n=s(29),i=s(47)("IE_PROTO"),o=function(){},l=function(){var e,t=s(42)("iframe"),r=n.length;for(t.style.display="none",s(87).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;r--;)delete l.prototype[n[r]];return l()};e.exports=Object.create||function(e,t){var s;return null!==e?(o.prototype=r(e),s=new o,o.prototype=null,s[i]=e):s=l(),void 0===t?s:a(s,t)}},function(e,t,s){var r=s(10),a=s(18),n=s(27);e.exports=s(9)?Object.defineProperties:function(e,t){a(e);for(var s,i=n(t),o=i.length,l=0;o>l;)r.f(e,s=i[l++],t[s]);return e}},function(e,t,s){var r=s(4).document;e.exports=r&&r.documentElement},function(e,t,s){var r=s(16),a=s(49).f,n={}.toString,i="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return i&&"[object Window]"==n.call(e)?function(e){try{return a(e)}catch(e){return i.slice()}}(e):a(r(e))}},function(e,t,s){var r=s(30),a=s(24),n=s(16),i=s(23),o=s(8),l=s(41),u=Object.getOwnPropertyDescriptor;t.f=s(9)?u:function(e,t){if(e=n(e),t=i(t,!0),l)try{return u(e,t)}catch(e){}if(o(e,t))return a(!r.f.call(e,t),e[t])}},function(e,t,s){var r=s(91),a={};a[s(15)("toStringTag")]="z",a+""!="[object z]"&&s(25)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(e,t,s){var r=s(28),a=s(15)("toStringTag"),n="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,s,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(s=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),a))?s:n?r(t):"Object"==(i=r(t))&&"function"==typeof t.callee?"Arguments":i}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=be(s(32)),a=be(s(50)),n=be(s(93)),i=be(s(94)),o=be(s(95)),l=be(s(96)),u=be(s(97)),c=be(s(98)),d=be(s(99)),h=be(s(100)),p=be(s(20)),g=be(s(101)),f=be(s(34)),_=be(s(102)),E=Pe(s(103)),S=Pe(s(104)),C=be(s(105)),m=be(s(106)),A=be(s(107)),P=be(s(108)),b=be(s(109)),I=be(s(53)),T=be(s(54)),v=be(s(110)),y=be(s(111)),R=be(s(112)),N=be(s(52)),O=Pe(s(113)),L=be(s(114)),B=be(s(55)),D=be(s(115)),M=be(s(116)),x=be(s(117)),U=be(s(118)),w=be(s(119)),k=be(s(120)),F=be(s(121)),V=be(s(122)),X=be(s(123)),G=be(s(51)),j=be(s(124)),$=be(s(125)),Y=be(s(126)),W=be(s(127)),H=be(s(128)),q=be(s(129)),K=be(s(130)),J=be(s(131)),z=be(s(132)),Z=be(s(133)),Q=Pe(s(134)),ee=be(s(135)),te=be(s(136)),se=be(s(137)),re=be(s(138)),ae=be(s(139)),ne=be(s(140)),ie=be(s(141)),oe=be(s(142)),le=be(s(143)),ue=be(s(144)),ce=Pe(s(145)),de=be(s(56)),he=be(s(57)),pe=be(s(146)),ge=be(s(147)),fe=be(s(148)),_e=be(s(149)),Ee=be(s(150)),Se=be(s(58)),Ce=be(s(151)),me=be(s(152)),Ae=be(s(33));function Pe(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,s):{};r.get||r.set?Object.defineProperty(t,s,r):t[s]=e[s]}return t.default=e,t}function be(e){return e&&e.__esModule?e:{default:e}}var Ie={version:"10.11.0",toDate:r.default,toFloat:a.default,toInt:n.default,toBoolean:i.default,equals:o.default,contains:l.default,matches:u.default,isEmail:c.default,isURL:d.default,isMACAddress:h.default,isIP:p.default,isIPRange:g.default,isFQDN:f.default,isBoolean:_.default,isAlpha:E.default,isAlphaLocales:E.locales,isAlphanumeric:S.default,isAlphanumericLocales:S.locales,isNumeric:C.default,isPort:m.default,isLowercase:A.default,isUppercase:P.default,isAscii:b.default,isFullWidth:I.default,isHalfWidth:T.default,isVariableWidth:v.default,isMultibyte:y.default,isSurrogatePair:R.default,isInt:N.default,isFloat:O.default,isFloatLocales:O.locales,isDecimal:L.default,isHexadecimal:B.default,isDivisibleBy:D.default,isHexColor:M.default,isISRC:x.default,isMD5:U.default,isHash:w.default,isJWT:k.default,isJSON:F.default,isEmpty:V.default,isLength:X.default,isByteLength:G.default,isUUID:j.default,isMongoId:$.default,isAfter:Y.default,isBefore:W.default,isIn:H.default,isCreditCard:q.default,isIdentityCard:K.default,isISIN:J.default,isISBN:z.default,isISSN:Z.default,isMobilePhone:Q.default,isMobilePhoneLocales:Q.locales,isPostalCode:ce.default,isPostalCodeLocales:ce.locales,isCurrency:ee.default,isISO8601:te.default,isRFC3339:se.default,isISO31661Alpha2:re.default,isISO31661Alpha3:ae.default,isBase64:ne.default,isDataURI:ie.default,isMagnetURI:oe.default,isMimeType:le.default,isLatLong:ue.default,ltrim:de.default,rtrim:he.default,trim:pe.default,escape:ge.default,unescape:fe.default,stripLow:_e.default,whitelist:Ee.default,blacklist:Se.default,isWhitelisted:Ce.default,normalizeEmail:me.default,toString:Ae.default};t.default=Ie,e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)(e),parseInt(e,t||10)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)(e),t?"1"===e||"true"===e:"0"!==e&&"false"!==e&&""!==e};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)(e),e===t};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)(e),e.indexOf((0,a.default)(t))>=0};var r=n(s(0)),a=n(s(33));function n(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,s){return(0,r.default)(e),"[object RegExp]"!==Object.prototype.toString.call(t)&&(t=new RegExp(t,s)),t.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,r.default)(e),(t=(0,a.default)(t,u)).require_display_name||t.allow_display_name){var s=e.match(c);if(s)e=s[1];else if(t.require_display_name)return!1}var l=e.split("@"),_=l.pop(),E=l.join("@"),S=_.toLowerCase();if(t.domain_specific_validation&&("gmail.com"===S||"googlemail.com"===S)){var C=(E=E.toLowerCase()).split("+")[0];if(!(0,n.default)(C.replace(".",""),{min:6,max:30}))return!1;for(var m=C.split("."),A=0;A<m.length;A++)if(!h.test(m[A]))return!1}if(!(0,n.default)(E,{max:64})||!(0,n.default)(_,{max:254}))return!1;if(!(0,i.default)(_,{require_tld:t.require_tld})){if(!t.allow_ip_domain)return!1;if(!(0,o.default)(_)){if(!_.startsWith("[")||!_.endsWith("]"))return!1;var P=_.substr(1,_.length-2);if(0===P.length||!(0,o.default)(P))return!1}}if('"'===E[0])return E=E.slice(1,E.length-1),t.allow_utf8_local_part?f.test(E):p.test(E);for(var b=t.allow_utf8_local_part?g:d,I=E.split("."),T=0;T<I.length;T++)if(!b.test(I[T]))return!1;return!0};var r=l(s(0)),a=l(s(5)),n=l(s(51)),i=l(s(34)),o=l(s(20));function l(e){return e&&e.__esModule?e:{default:e}}var u={allow_display_name:!1,require_display_name:!1,allow_utf8_local_part:!0,require_tld:!0},c=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\.\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\,\.\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF\s]*<(.+)>$/i,d=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~]+$/i,h=/^[a-z\d]+$/,p=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f]))*$/i,g=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+$/i,f=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*$/i;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,r.default)(e),!e||e.length>=2083||/[\s<>]/.test(e))return!1;if(0===e.indexOf("mailto:"))return!1;var s,o,c,h,p,g,f,_;if(t=(0,i.default)(t,l),f=e.split("#"),e=f.shift(),f=e.split("?"),e=f.shift(),(f=e.split("://")).length>1){if(s=f.shift().toLowerCase(),t.require_valid_protocol&&-1===t.protocols.indexOf(s))return!1}else{if(t.require_protocol)return!1;if("//"===e.substr(0,2)){if(!t.allow_protocol_relative_urls)return!1;f[0]=e.substr(2)}}if(""===(e=f.join("://")))return!1;if(f=e.split("/"),""===(e=f.shift())&&!t.require_host)return!0;if((f=e.split("@")).length>1){if(t.disallow_auth)return!1;if((o=f.shift()).indexOf(":")>=0&&o.split(":").length>2)return!1}g=null,_=null;var E=(h=f.join("@")).match(u);return E?(c="",_=E[1],g=E[2]||null):(c=(f=h.split(":")).shift(),f.length&&(g=f.join(":"))),!(null!==g&&(p=parseInt(g,10),!/^[0-9]+$/.test(g)||p<=0||p>65535)||!((0,n.default)(c)||(0,a.default)(c,t)||_&&(0,n.default)(_,6))||(c=c||_,t.host_whitelist&&!d(c,t.host_whitelist)||t.host_blacklist&&d(c,t.host_blacklist)))};var r=o(s(0)),a=o(s(34)),n=o(s(20)),i=o(s(5));function o(e){return e&&e.__esModule?e:{default:e}}var l={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,require_host:!0,require_valid_protocol:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1},u=/^\[([^\]]+)\](?::([0-9]+))?$/;function c(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function d(e,t){for(var s=0;s<t.length;s++){var r=t[s];if(e===r||c(r)&&r.test(e))return!0}return!1}e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)(e),t&&t.no_colons?n.test(e):a.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^([0-9a-fA-F][0-9a-fA-F]:){5}([0-9a-fA-F][0-9a-fA-F])$/,n=/^([0-9a-fA-F]){12}$/;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,r.default)(e);var t=e.split("/");return 2===t.length&&!!i.test(t[1])&&!(t[1].length>1&&t[1].startsWith("0"))&&(0,a.default)(t[0],4)&&t[1]<=32&&t[1]>=0};var r=n(s(0)),a=n(s(20));function n(e){return e&&e.__esModule?e:{default:e}}var i=/^\d{1,2}$/;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),["true","false","1","0"].indexOf(e)>=0};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US";if((0,r.default)(e),t in a.alpha)return a.alpha[t].test(e);throw new Error("Invalid locale '".concat(t,"'"))},t.locales=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=s(21),n=Object.keys(a.alpha);t.locales=n},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US";if((0,r.default)(e),t in a.alphanumeric)return a.alphanumeric[t].test(e);throw new Error("Invalid locale '".concat(t,"'"))},t.locales=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=s(21),n=Object.keys(a.alphanumeric);t.locales=n},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)(e),t&&t.no_symbols?n.test(e):a.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^[+-]?([0-9]*[.])?[0-9]+$/,n=/^[0-9]+$/;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e,{min:0,max:65535})};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(52));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),e===e.toLowerCase()};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),e===e.toUpperCase()};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),a.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^[\x00-\x7F]+$/;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),a.fullWidth.test(e)&&n.halfWidth.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=s(53),n=s(54);e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),a.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/[^\x00-\x7F]/;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),a.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/[\uD800-\uDBFF][\uDC00-\uDFFF]/;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,r.default)(e),t=t||{};var s=new RegExp("^(?:[-+])?(?:[0-9]+)?(?:\\".concat(t.locale?a.decimal[t.locale]:".","[0-9]*)?(?:[eE][\\+\\-]?(?:[0-9]+))?$"));if(""===e||"."===e||"-"===e||"+"===e)return!1;var n=parseFloat(e.replace(",","."));return s.test(e)&&(!t.hasOwnProperty("min")||n>=t.min)&&(!t.hasOwnProperty("max")||n<=t.max)&&(!t.hasOwnProperty("lt")||n<t.lt)&&(!t.hasOwnProperty("gt")||n>t.gt)},t.locales=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=s(21),n=Object.keys(a.decimal);t.locales=n},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,a.default)(e),(t=(0,r.default)(t,l)).locale in i.decimal)return!(0,n.default)(u,e.replace(/ /g,""))&&function(e){return new RegExp("^[-+]?([0-9]+)?(\\".concat(i.decimal[e.locale],"[0-9]{").concat(e.decimal_digits,"})").concat(e.force_decimal?"":"?","$"))}(t).test(e);throw new Error("Invalid locale '".concat(t.locale,"'"))};var r=o(s(5)),a=o(s(0)),n=o(s(35)),i=s(21);function o(e){return e&&e.__esModule?e:{default:e}}var l={force_decimal:!1,decimal_digits:"1,",locale:"en-US"},u=["","-","+"];e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)(e),(0,a.default)(e)%parseInt(t,10)==0};var r=n(s(0)),a=n(s(50));function n(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),a.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),a.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^[A-Z]{2}[0-9A-Z]{3}\d{2}\d{5}$/;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),a.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^[a-f0-9]{32}$/;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)(e),new RegExp("^[a-f0-9]{".concat(a[t],"}$")).test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a={md5:32,md4:32,sha1:40,sha256:64,sha384:96,sha512:128,ripemd128:32,ripemd160:40,tiger128:32,tiger160:40,tiger192:48,crc32:8,crc32b:8};e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),a.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^([A-Za-z0-9\-_~+\/]+[=]{0,2})\.([A-Za-z0-9\-_~+\/]+[=]{0,2})(?:\.([A-Za-z0-9\-_~+\/]+[=]{0,2}))?$/;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,r.default)(e);try{var t=JSON.parse(e);return!!t&&"object"===function(e){return("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}(t)}catch(e){}return!1};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)(e),0===((t=(0,a.default)(t,i)).ignore_whitespace?e.trim().length:e.length)};var r=n(s(0)),a=n(s(5));function n(e){return e&&e.__esModule?e:{default:e}}var i={ignore_whitespace:!1};e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var s,n;(0,r.default)(e),"object"===a(t)?(s=t.min||0,n=t.max):(s=arguments[1],n=arguments[2]);var i=e.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g)||[],o=e.length-i.length;return o>=s&&(void 0===n||o<=n)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";(0,r.default)(e);var s=a[t];return s&&s.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),(0,a.default)(e)&&24===e.length};var r=n(s(0)),a=n(s(55));function n(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:String(new Date);(0,r.default)(e);var s=(0,a.default)(t),n=(0,a.default)(e);return!!(n&&s&&n>s)};var r=n(s(0)),a=n(s(32));function n(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:String(new Date);(0,r.default)(e);var s=(0,a.default)(t),n=(0,a.default)(e);return!!(n&&s&&n<s)};var r=n(s(0)),a=n(s(32));function n(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var s;if((0,r.default)(e),"[object Array]"===Object.prototype.toString.call(t)){var n=[];for(s in t)({}).hasOwnProperty.call(t,s)&&(n[s]=(0,a.default)(t[s]));return n.indexOf(e)>=0}return"object"===function(e){return("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}(t)?t.hasOwnProperty(e):!(!t||"function"!=typeof t.indexOf)&&t.indexOf(e)>=0};var r=n(s(0)),a=n(s(33));function n(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,r.default)(e);var t=e.replace(/[- ]+/g,"");if(!a.test(t))return!1;for(var s,n,i,o=0,l=t.length-1;l>=0;l--)s=t.substring(l,l+1),n=parseInt(s,10),o+=i&&(n*=2)>=10?n%10+1:n,i=!i;return!(o%10!=0||!t)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|(222[1-9]|22[3-9][0-9]|2[3-6][0-9]{2}|27[01][0-9]|2720)[0-9]{12}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11}|6[27][0-9]{14})$/;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any";if((0,r.default)(e),t in a)return a[t](e);if("any"===t){for(var s in a)if(a.hasOwnProperty(s)){var n=a[s];if(n(e))return!0}return!1}throw new Error("Invalid locale '".concat(t,"'"))};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a={ES:function(e){(0,r.default)(e);var t={X:0,Y:1,Z:2},s=e.trim().toUpperCase();if(!/^[0-9X-Z][0-9]{7}[TRWAGMYFPDXBNJZSQVHLCKE]$/.test(s))return!1;var a=s.slice(0,-1).replace(/[X,Y,Z]/g,(function(e){return t[e]}));return s.endsWith(["T","R","W","A","G","M","Y","F","P","D","X","B","N","J","Z","S","Q","V","H","L","C","K","E"][a%23])}};e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if((0,r.default)(e),!a.test(e))return!1;for(var t,s,n=e.replace(/[A-Z]/g,(function(e){return parseInt(e,36)})),i=0,o=!0,l=n.length-2;l>=0;l--)t=n.substring(l,l+1),s=parseInt(t,10),i+=o&&(s*=2)>=10?s+1:s,o=!o;return parseInt(e.substr(e.length-1),10)===(1e4-i)%10};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^[A-Z]{2}[0-9A-Z]{9}[0-9]$/;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if((0,r.default)(t),!(s=String(s)))return e(t,10)||e(t,13);var o,l=t.replace(/[\s-]+/g,""),u=0;if("10"===s){if(!a.test(l))return!1;for(o=0;o<9;o++)u+=(o+1)*l.charAt(o);if("X"===l.charAt(9)?u+=100:u+=10*l.charAt(9),u%11==0)return!!l}else if("13"===s){if(!n.test(l))return!1;for(o=0;o<12;o++)u+=i[o%2]*l.charAt(o);if(l.charAt(12)-(10-u%10)%10==0)return!!l}return!1};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^(?:[0-9]{9}X|[0-9]{10})$/,n=/^(?:[0-9]{13})$/,i=[1,3];e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.default)(e);var s=a;if(s=t.require_hyphen?s.replace("?",""):s,!(s=t.case_sensitive?new RegExp(s):new RegExp(s,"i")).test(e))return!1;for(var n=e.replace("-","").toUpperCase(),i=0,o=0;o<n.length;o++){var l=n[o];i+=("X"===l?10:+l)*(8-o)}return i%11==0};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a="^\\d{4}-?\\d{3}[\\dX]$";e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,s){if((0,r.default)(e),s&&s.strictMode&&!e.startsWith("+"))return!1;if(Array.isArray(t))return t.some((function(t){return!(!a.hasOwnProperty(t)||!a[t].test(e))}));if(t in a)return a[t].test(e);if(!t||"any"===t){for(var n in a)if(a.hasOwnProperty(n)&&a[n].test(e))return!0;return!1}throw new Error("Invalid locale '".concat(t,"'"))},t.locales=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a={"ar-AE":/^((\+?971)|0)?5[024568]\d{7}$/,"ar-DZ":/^(\+?213|0)(5|6|7)\d{8}$/,"ar-EG":/^((\+?20)|0)?1[012]\d{8}$/,"ar-IQ":/^(\+?964|0)?7[0-9]\d{8}$/,"ar-JO":/^(\+?962|0)?7[789]\d{7}$/,"ar-KW":/^(\+?965)[569]\d{7}$/,"ar-SA":/^(!?(\+?966)|0)?5\d{8}$/,"ar-SY":/^(!?(\+?963)|0)?9\d{8}$/,"ar-TN":/^(\+?216)?[2459]\d{7}$/,"be-BY":/^(\+?375)?(24|25|29|33|44)\d{7}$/,"bg-BG":/^(\+?359|0)?8[789]\d{7}$/,"bn-BD":/\+?(88)?0?1[356789][0-9]{8}\b/,"cs-CZ":/^(\+?420)? ?[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$/,"da-DK":/^(\+?45)?\s?\d{2}\s?\d{2}\s?\d{2}\s?\d{2}$/,"de-DE":/^(\+49)?0?1(5[0-25-9]\d|6([23]|0\d?)|7([0-57-9]|6\d))\d{7}$/,"el-GR":/^(\+?30|0)?(69\d{8})$/,"en-AU":/^(\+?61|0)4\d{8}$/,"en-GB":/^(\+?44|0)7\d{9}$/,"en-GH":/^(\+233|0)(20|50|24|54|27|57|26|56|23|28)\d{7}$/,"en-HK":/^(\+?852\-?)?[456789]\d{3}\-?\d{4}$/,"en-IE":/^(\+?353|0)8[356789]\d{7}$/,"en-IN":/^(\+?91|0)?[6789]\d{9}$/,"en-KE":/^(\+?254|0)?[7]\d{8}$/,"en-MU":/^(\+?230|0)?\d{8}$/,"en-NG":/^(\+?234|0)?[789]\d{9}$/,"en-NZ":/^(\+?64|0)[28]\d{7,9}$/,"en-PK":/^((\+92)|(0092))-{0,1}\d{3}-{0,1}\d{7}$|^\d{11}$|^\d{4}-\d{7}$/,"en-RW":/^(\+?250|0)?[7]\d{8}$/,"en-SG":/^(\+65)?[89]\d{7}$/,"en-TZ":/^(\+?255|0)?[67]\d{8}$/,"en-UG":/^(\+?256|0)?[7]\d{8}$/,"en-US":/^((\+1|1)?( |-)?)?(\([2-9][0-9]{2}\)|[2-9][0-9]{2})( |-)?([2-9][0-9]{2}( |-)?[0-9]{4})$/,"en-ZA":/^(\+?27|0)\d{9}$/,"en-ZM":/^(\+?26)?09[567]\d{7}$/,"es-ES":/^(\+?34)?(6\d{1}|7[1234])\d{7}$/,"es-MX":/^(\+?52)?(1|01)?\d{10,11}$/,"es-UY":/^(\+598|0)9[1-9][\d]{6}$/,"et-EE":/^(\+?372)?\s?(5|8[1-4])\s?([0-9]\s?){6,7}$/,"fa-IR":/^(\+?98[\-\s]?|0)9[0-39]\d[\-\s]?\d{3}[\-\s]?\d{4}$/,"fi-FI":/^(\+?358|0)\s?(4(0|1|2|4|5|6)?|50)\s?(\d\s?){4,8}\d$/,"fo-FO":/^(\+?298)?\s?\d{2}\s?\d{2}\s?\d{2}$/,"fr-FR":/^(\+?33|0)[67]\d{8}$/,"he-IL":/^(\+972|0)([23489]|5[012345689]|77)[1-9]\d{6}$/,"hu-HU":/^(\+?36)(20|30|70)\d{7}$/,"id-ID":/^(\+?62|0)8(1[123456789]|2[1238]|3[1238]|5[12356789]|7[78]|9[56789]|8[123456789])([\s?|\d]{5,11})$/,"it-IT":/^(\+?39)?\s?3\d{2} ?\d{6,7}$/,"ja-JP":/^(\+?81|0)[789]0[ \-]?[1-9]\d{2}[ \-]?\d{5}$/,"kk-KZ":/^(\+?7|8)?7\d{9}$/,"kl-GL":/^(\+?299)?\s?\d{2}\s?\d{2}\s?\d{2}$/,"ko-KR":/^((\+?82)[ \-]?)?0?1([0|1|6|7|8|9]{1})[ \-]?\d{3,4}[ \-]?\d{4}$/,"lt-LT":/^(\+370|8)\d{8}$/,"ms-MY":/^(\+?6?01){1}(([0145]{1}(\-|\s)?\d{7,8})|([236789]{1}(\s|\-)?\d{7}))$/,"nb-NO":/^(\+?47)?[49]\d{7}$/,"nl-BE":/^(\+?32|0)4?\d{8}$/,"nn-NO":/^(\+?47)?[49]\d{7}$/,"pl-PL":/^(\+?48)? ?[5-8]\d ?\d{3} ?\d{2} ?\d{2}$/,"pt-BR":/(?=^(\+?5{2}\-?|0)[1-9]{2}\-?\d{4}\-?\d{4}$)(^(\+?5{2}\-?|0)[1-9]{2}\-?[6-9]{1}\d{3}\-?\d{4}$)|(^(\+?5{2}\-?|0)[1-9]{2}\-?9[6-9]{1}\d{3}\-?\d{4}$)/,"pt-PT":/^(\+?351)?9[1236]\d{7}$/,"ro-RO":/^(\+?4?0)\s?7\d{2}(\/|\s|\.|\-)?\d{3}(\s|\.|\-)?\d{3}$/,"ru-RU":/^(\+?7|8)?9\d{9}$/,"sl-SI":/^(\+386\s?|0)(\d{1}\s?\d{3}\s?\d{2}\s?\d{2}|\d{2}\s?\d{3}\s?\d{3})$/,"sk-SK":/^(\+?421)? ?[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$/,"sr-RS":/^(\+3816|06)[- \d]{5,9}$/,"sv-SE":/^(\+?46|0)[\s\-]?7[\s\-]?[02369]([\s\-]?\d){7}$/,"th-TH":/^(\+66|66|0)\d{9}$/,"tr-TR":/^(\+?90|0)?5\d{9}$/,"uk-UA":/^(\+?38|8)?0\d{9}$/,"vi-VN":/^(\+?84|0)((3([2-9]))|(5([689]))|(7([0|6-9]))|(8([1-5]))|(9([0-9])))([0-9]{7})$/,"zh-CN":/^((\+|00)86)?1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/,"zh-TW":/^(\+?886\-?|0)?9\d{8}$/};a["en-CA"]=a["en-US"],a["fr-BE"]=a["nl-BE"],a["zh-HK"]=a["en-HK"];var n=Object.keys(a);t.locales=n},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,a.default)(e),function(e){var t="\\d{".concat(e.digits_after_decimal[0],"}");e.digits_after_decimal.forEach((function(e,s){0!==s&&(t="".concat(t,"|\\d{").concat(e,"}"))}));var s="(\\".concat(e.symbol.replace(/\./g,"\\."),")").concat(e.require_symbol?"":"?"),r="[1-9]\\d{0,2}(\\".concat(e.thousands_separator,"\\d{3})*"),a="(".concat(["0","[1-9]\\d*",r].join("|"),")?"),n="(\\".concat(e.decimal_separator,"(").concat(t,"))").concat(e.require_decimal?"":"?"),i=a+(e.allow_decimal||e.require_decimal?n:"");return e.allow_negatives&&!e.parens_for_negatives&&(e.negative_sign_after_digits?i+="-?":e.negative_sign_before_digits&&(i="-?"+i)),e.allow_negative_sign_placeholder?i="( (?!\\-))?".concat(i):e.allow_space_after_symbol?i=" ?".concat(i):e.allow_space_after_digits&&(i+="( (?!$))?"),e.symbol_after_digits?i+=s:i=s+i,e.allow_negatives&&(e.parens_for_negatives?i="(\\(".concat(i,"\\)|").concat(i,")"):e.negative_sign_before_digits||e.negative_sign_after_digits||(i="-?"+i)),new RegExp("^(?!-? )(?=.*\\d)".concat(i,"$"))}(t=(0,r.default)(t,i)).test(e)};var r=n(s(5)),a=n(s(0));function n(e){return e&&e.__esModule?e:{default:e}}var i={symbol:"$",require_symbol:!1,allow_space_after_symbol:!1,symbol_after_digits:!1,allow_negatives:!0,parens_for_negatives:!1,negative_sign_before_digits:!1,negative_sign_after_digits:!1,allow_negative_sign_placeholder:!1,thousands_separator:",",decimal_separator:".",allow_decimal:!0,require_decimal:!1,digits_after_decimal:[2],allow_space_after_digits:!1};e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,r.default)(e);var s=a.test(e);return t&&s&&t.strict?n(e):s};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-3])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,n=function(e){var t=e.match(/^(\d{4})-?(\d{3})([ T]{1}\.*|$)/);if(t){var s=Number(t[1]),r=Number(t[2]);return s%4==0&&s%100!=0?r<=366:r<=365}var a=e.match(/(\d{4})-?(\d{0,2})-?(\d*)/).map(Number),n=a[1],i=a[2],o=a[3],l=i?"0".concat(i).slice(-2):i,u=o?"0".concat(o).slice(-2):o,c=new Date("".concat(n,"-").concat(l||"01","-").concat(u||"01"));return!isNaN(c.getUTCFullYear())&&(!i||!o||c.getUTCFullYear()===n&&c.getUTCMonth()+1===i&&c.getUTCDate()===o)};e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),d.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/([01][0-9]|2[0-3])/,n=/[0-5][0-9]/,i=new RegExp("[-+]".concat(a.source,":").concat(n.source)),o=new RegExp("([zZ]|".concat(i.source,")")),l=new RegExp("".concat(a.source,":").concat(n.source,":").concat(/([0-5][0-9]|60)/.source).concat(/(\.[0-9]+)?/.source)),u=new RegExp("".concat(/[0-9]{4}/.source,"-").concat(/(0[1-9]|1[0-2])/.source,"-").concat(/([12]\d|0[1-9]|3[01])/.source)),c=new RegExp("".concat(l.source).concat(o.source)),d=new RegExp("".concat(u.source,"[ tT]").concat(c.source));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),(0,a.default)(i,e.toUpperCase())};var r=n(s(0)),a=n(s(35));function n(e){return e&&e.__esModule?e:{default:e}}var i=["AD","AE","AF","AG","AI","AL","AM","AO","AQ","AR","AS","AT","AU","AW","AX","AZ","BA","BB","BD","BE","BF","BG","BH","BI","BJ","BL","BM","BN","BO","BQ","BR","BS","BT","BV","BW","BY","BZ","CA","CC","CD","CF","CG","CH","CI","CK","CL","CM","CN","CO","CR","CU","CV","CW","CX","CY","CZ","DE","DJ","DK","DM","DO","DZ","EC","EE","EG","EH","ER","ES","ET","FI","FJ","FK","FM","FO","FR","GA","GB","GD","GE","GF","GG","GH","GI","GL","GM","GN","GP","GQ","GR","GS","GT","GU","GW","GY","HK","HM","HN","HR","HT","HU","ID","IE","IL","IM","IN","IO","IQ","IR","IS","IT","JE","JM","JO","JP","KE","KG","KH","KI","KM","KN","KP","KR","KW","KY","KZ","LA","LB","LC","LI","LK","LR","LS","LT","LU","LV","LY","MA","MC","MD","ME","MF","MG","MH","MK","ML","MM","MN","MO","MP","MQ","MR","MS","MT","MU","MV","MW","MX","MY","MZ","NA","NC","NE","NF","NG","NI","NL","NO","NP","NR","NU","NZ","OM","PA","PE","PF","PG","PH","PK","PL","PM","PN","PR","PS","PT","PW","PY","QA","RE","RO","RS","RU","RW","SA","SB","SC","SD","SE","SG","SH","SI","SJ","SK","SL","SM","SN","SO","SR","SS","ST","SV","SX","SY","SZ","TC","TD","TF","TG","TH","TJ","TK","TL","TM","TN","TO","TR","TT","TV","TW","TZ","UA","UG","UM","US","UY","UZ","VA","VC","VE","VG","VI","VN","VU","WF","WS","YE","YT","ZA","ZM","ZW"];e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),(0,a.default)(i,e.toUpperCase())};var r=n(s(0)),a=n(s(35));function n(e){return e&&e.__esModule?e:{default:e}}var i=["AFG","ALA","ALB","DZA","ASM","AND","AGO","AIA","ATA","ATG","ARG","ARM","ABW","AUS","AUT","AZE","BHS","BHR","BGD","BRB","BLR","BEL","BLZ","BEN","BMU","BTN","BOL","BES","BIH","BWA","BVT","BRA","IOT","BRN","BGR","BFA","BDI","KHM","CMR","CAN","CPV","CYM","CAF","TCD","CHL","CHN","CXR","CCK","COL","COM","COG","COD","COK","CRI","CIV","HRV","CUB","CUW","CYP","CZE","DNK","DJI","DMA","DOM","ECU","EGY","SLV","GNQ","ERI","EST","ETH","FLK","FRO","FJI","FIN","FRA","GUF","PYF","ATF","GAB","GMB","GEO","DEU","GHA","GIB","GRC","GRL","GRD","GLP","GUM","GTM","GGY","GIN","GNB","GUY","HTI","HMD","VAT","HND","HKG","HUN","ISL","IND","IDN","IRN","IRQ","IRL","IMN","ISR","ITA","JAM","JPN","JEY","JOR","KAZ","KEN","KIR","PRK","KOR","KWT","KGZ","LAO","LVA","LBN","LSO","LBR","LBY","LIE","LTU","LUX","MAC","MKD","MDG","MWI","MYS","MDV","MLI","MLT","MHL","MTQ","MRT","MUS","MYT","MEX","FSM","MDA","MCO","MNG","MNE","MSR","MAR","MOZ","MMR","NAM","NRU","NPL","NLD","NCL","NZL","NIC","NER","NGA","NIU","NFK","MNP","NOR","OMN","PAK","PLW","PSE","PAN","PNG","PRY","PER","PHL","PCN","POL","PRT","PRI","QAT","REU","ROU","RUS","RWA","BLM","SHN","KNA","LCA","MAF","SPM","VCT","WSM","SMR","STP","SAU","SEN","SRB","SYC","SLE","SGP","SXM","SVK","SVN","SLB","SOM","ZAF","SGS","SSD","ESP","LKA","SDN","SUR","SJM","SWZ","SWE","CHE","SYR","TWN","TJK","TZA","THA","TLS","TGO","TKL","TON","TTO","TUN","TUR","TKM","TCA","TUV","UGA","UKR","ARE","GBR","USA","UMI","URY","UZB","VUT","VEN","VNM","VGB","VIR","WLF","ESH","YEM","ZMB","ZWE"];e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,r.default)(e);var t=e.length;if(!t||t%4!=0||a.test(e))return!1;var s=e.indexOf("=");return-1===s||s===t-1||s===t-2&&"="===e[t-1]};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/[^A-Z0-9+\/=]/i;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,r.default)(e);var t=e.split(",");if(t.length<2)return!1;var s=t.shift().trim().split(";"),o=s.shift();if("data:"!==o.substr(0,5))return!1;var l=o.substr(5);if(""!==l&&!a.test(l))return!1;for(var u=0;u<s.length;u++)if(u===s.length-1&&"base64"===s[u].toLowerCase());else if(!n.test(s[u]))return!1;for(var c=0;c<t.length;c++)if(!i.test(t[c]))return!1;return!0};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^[a-z]+\/[a-z0-9\-\+]+$/i,n=/^[a-z\-]+=[a-z0-9\-]+$/i,i=/^[a-z0-9!\$&'\(\)\*\+,;=\-\._~:@\/\?%\s]*$/i;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),a.test(e.trim())};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^magnet:\?xt=urn:[a-z0-9]+:[a-z0-9]{32,40}&dn=.+&tr=.+$/i;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),a.test(e)||n.test(e)||i.test(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^(application|audio|font|image|message|model|multipart|text|video)\/[a-zA-Z0-9\.\-\+]{1,100}$/i,n=/^text\/[a-zA-Z0-9\.\-\+]{1,100};\s?charset=("[a-zA-Z0-9\.\-\+\s]{0,70}"|[a-zA-Z0-9\.\-\+]{0,70})(\s?\([a-zA-Z0-9\.\-\+\s]{1,20}\))?$/i,i=/^multipart\/[a-zA-Z0-9\.\-\+]{1,100}(;\s?(boundary|charset)=("[a-zA-Z0-9\.\-\+\s]{0,70}"|[a-zA-Z0-9\.\-\+]{0,70})(\s?\([a-zA-Z0-9\.\-\+\s]{1,20}\))?){0,2}$/i;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if((0,r.default)(e),!e.includes(","))return!1;var t=e.split(",");return a.test(t[0])&&n.test(t[1])};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^\(?[+-]?(90(\.0+)?|[1-8]?\d(\.\d+)?)$/,n=/^\s?[+-]?(180(\.0+)?|1[0-7]\d(\.\d+)?|\d{1,2}(\.\d+)?)\)?$/;e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,r.default)(e),t in o)return o[t].test(e);if("any"===t){for(var s in o)if(o.hasOwnProperty(s)&&o[s].test(e))return!0;return!1}throw new Error("Invalid locale '".concat(t,"'"))},t.locales=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0)),a=/^\d{4}$/,n=/^\d{5}$/,i=/^\d{6}$/,o={AD:/^AD\d{3}$/,AT:a,AU:a,BE:a,BG:a,CA:/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJ-NPRSTV-Z][\s\-]?\d[ABCEGHJ-NPRSTV-Z]\d$/i,CH:a,CZ:/^\d{3}\s?\d{2}$/,DE:n,DK:a,DZ:n,EE:n,ES:n,FI:n,FR:/^\d{2}\s?\d{3}$/,GB:/^(gir\s?0aa|[a-z]{1,2}\d[\da-z]?\s?(\d[a-z]{2})?)$/i,GR:/^\d{3}\s?\d{2}$/,HR:/^([1-5]\d{4}$)/,HU:a,IL:n,IN:i,IS:/^\d{3}$/,IT:n,JP:/^\d{3}\-\d{4}$/,KE:n,LI:/^(948[5-9]|949[0-7])$/,LT:/^LT\-\d{5}$/,LU:a,LV:/^LV\-\d{4}$/,MX:n,NL:/^\d{4}\s?[a-z]{2}$/i,NO:a,PL:/^\d{2}\-\d{3}$/,PT:/^\d{4}\-\d{3}?$/,RO:i,RU:i,SA:n,SE:/^\d{3}\s?\d{2}$/,SI:a,SK:/^\d{3}\s?\d{2}$/,TN:a,TW:/^\d{3}(\d{2})?$/,UA:n,US:/^\d{5}(-\d{4})?$/,ZA:a,ZM:n},l=Object.keys(o);t.locales=l},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)((0,a.default)(e,t),t)};var r=n(s(57)),a=n(s(56));function n(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2F;").replace(/\\/g,"&#x5C;").replace(/`/g,"&#96;")};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e),e.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#x2F;/g,"/").replace(/&#x5C;/g,"\\").replace(/&#96;/g,"`")};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,r.default)(e);var s=t?"\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F":"\\x00-\\x1F\\x7F";return(0,a.default)(e,s)};var r=n(s(0)),a=n(s(58));function n(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)(e),e.replace(new RegExp("[^".concat(t,"]+"),"g"),"")};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,r.default)(e);for(var s=e.length-1;s>=0;s--)if(-1===t.indexOf(e[s]))return!1;return!0};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(0));e.exports=t.default,e.exports.default=t.default},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){t=(0,r.default)(t,a);var s=e.split("@"),c=s.pop(),d=[s.join("@"),c];if(d[1]=d[1].toLowerCase(),"gmail.com"===d[1]||"googlemail.com"===d[1]){if(t.gmail_remove_subaddress&&(d[0]=d[0].split("+")[0]),t.gmail_remove_dots&&(d[0]=d[0].replace(/\.+/g,u)),!d[0].length)return!1;(t.all_lowercase||t.gmail_lowercase)&&(d[0]=d[0].toLowerCase()),d[1]=t.gmail_convert_googlemaildotcom?"gmail.com":d[1]}else if(n.indexOf(d[1])>=0){if(t.icloud_remove_subaddress&&(d[0]=d[0].split("+")[0]),!d[0].length)return!1;(t.all_lowercase||t.icloud_lowercase)&&(d[0]=d[0].toLowerCase())}else if(i.indexOf(d[1])>=0){if(t.outlookdotcom_remove_subaddress&&(d[0]=d[0].split("+")[0]),!d[0].length)return!1;(t.all_lowercase||t.outlookdotcom_lowercase)&&(d[0]=d[0].toLowerCase())}else if(o.indexOf(d[1])>=0){if(t.yahoo_remove_subaddress){var h=d[0].split("-");d[0]=h.length>1?h.slice(0,-1).join("-"):h[0]}if(!d[0].length)return!1;(t.all_lowercase||t.yahoo_lowercase)&&(d[0]=d[0].toLowerCase())}else l.indexOf(d[1])>=0?((t.all_lowercase||t.yandex_lowercase)&&(d[0]=d[0].toLowerCase()),d[1]="yandex.ru"):t.all_lowercase&&(d[0]=d[0].toLowerCase());return d.join("@")};var r=function(e){return e&&e.__esModule?e:{default:e}}(s(5)),a={all_lowercase:!0,gmail_lowercase:!0,gmail_remove_dots:!0,gmail_remove_subaddress:!0,gmail_convert_googlemaildotcom:!0,outlookdotcom_lowercase:!0,outlookdotcom_remove_subaddress:!0,yahoo_lowercase:!0,yahoo_remove_subaddress:!0,yandex_lowercase:!0,icloud_lowercase:!0,icloud_remove_subaddress:!0},n=["icloud.com","me.com"],i=["hotmail.at","hotmail.be","hotmail.ca","hotmail.cl","hotmail.co.il","hotmail.co.nz","hotmail.co.th","hotmail.co.uk","hotmail.com","hotmail.com.ar","hotmail.com.au","hotmail.com.br","hotmail.com.gr","hotmail.com.mx","hotmail.com.pe","hotmail.com.tr","hotmail.com.vn","hotmail.cz","hotmail.de","hotmail.dk","hotmail.es","hotmail.fr","hotmail.hu","hotmail.id","hotmail.ie","hotmail.in","hotmail.it","hotmail.jp","hotmail.kr","hotmail.lv","hotmail.my","hotmail.ph","hotmail.pt","hotmail.sa","hotmail.sg","hotmail.sk","live.be","live.co.uk","live.com","live.com.ar","live.com.mx","live.de","live.es","live.eu","live.fr","live.it","live.nl","msn.com","outlook.at","outlook.be","outlook.cl","outlook.co.il","outlook.co.nz","outlook.co.th","outlook.com","outlook.com.ar","outlook.com.au","outlook.com.br","outlook.com.gr","outlook.com.pe","outlook.com.tr","outlook.com.vn","outlook.cz","outlook.de","outlook.dk","outlook.es","outlook.fr","outlook.hu","outlook.id","outlook.ie","outlook.in","outlook.it","outlook.jp","outlook.kr","outlook.lv","outlook.my","outlook.ph","outlook.pt","outlook.sa","outlook.sg","outlook.sk","passport.com"],o=["rocketmail.com","yahoo.ca","yahoo.co.uk","yahoo.com","yahoo.de","yahoo.fr","yahoo.in","yahoo.it","ymail.com"],l=["yandex.ru","yandex.ua","yandex.kz","yandex.com","yandex.by","ya.ru"];function u(e){return e.length>1?e:""}e.exports=t.default,e.exports.default=t.default},function(e,t,s){(function(e,s){var r="__lodash_hash_undefined__",a=1,n=2,i=9007199254740991,o="[object Arguments]",l="[object Array]",u="[object AsyncFunction]",c="[object Boolean]",d="[object Date]",h="[object Error]",p="[object Function]",g="[object GeneratorFunction]",f="[object Map]",_="[object Number]",E="[object Null]",S="[object Object]",C="[object Proxy]",m="[object RegExp]",A="[object Set]",P="[object String]",b="[object Symbol]",I="[object Undefined]",T="[object ArrayBuffer]",v="[object DataView]",y=/^\[object .+?Constructor\]$/,R=/^(?:0|[1-9]\d*)$/,N={};N["[object Float32Array]"]=N["[object Float64Array]"]=N["[object Int8Array]"]=N["[object Int16Array]"]=N["[object Int32Array]"]=N["[object Uint8Array]"]=N["[object Uint8ClampedArray]"]=N["[object Uint16Array]"]=N["[object Uint32Array]"]=!0,N[o]=N[l]=N[T]=N[c]=N[v]=N[d]=N[h]=N[p]=N[f]=N[_]=N[S]=N[m]=N[A]=N[P]=N["[object WeakMap]"]=!1;var O="object"==typeof e&&e&&e.Object===Object&&e,L="object"==typeof self&&self&&self.Object===Object&&self,B=O||L||Function("return this")(),D="object"==typeof t&&t&&!t.nodeType&&t,M=D&&"object"==typeof s&&s&&!s.nodeType&&s,x=M&&M.exports===D,U=x&&O.process,w=function(){try{return U&&U.binding&&U.binding("util")}catch(e){}}(),k=w&&w.isTypedArray;function F(e,t){for(var s=-1,r=null==e?0:e.length;++s<r;)if(t(e[s],s,e))return!0;return!1}function V(e,t){return e.has(t)}function X(e){var t=-1,s=Array(e.size);return e.forEach((function(e,r){s[++t]=[r,e]})),s}function G(e){var t=-1,s=Array(e.size);return e.forEach((function(e){s[++t]=e})),s}var j=Array.prototype,$=Function.prototype,Y=Object.prototype,W=B["__core-js_shared__"],H=$.toString,q=Y.hasOwnProperty,K=function(){var e=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),J=Y.toString,z=RegExp("^"+H.call(q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Z=x?B.Buffer:void 0,Q=B.Symbol,ee=B.Uint8Array,te=Y.propertyIsEnumerable,se=j.splice,re=Q?Q.toStringTag:void 0,ae=Object.getOwnPropertySymbols,ne=Z?Z.isBuffer:void 0,ie=function(e,t){return function(s){return e(t(s))}}(Object.keys,Object),oe=Be(B,"DataView"),le=Be(B,"Map"),ue=Be(B,"Promise"),ce=Be(B,"Set"),de=Be(B,"WeakMap"),he=Be(Object,"create"),pe=Ue(oe),ge=Ue(le),fe=Ue(ue),_e=Ue(ce),Ee=Ue(de),Se=Q?Q.prototype:void 0,Ce=Se?Se.valueOf:void 0;function me(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}function Ae(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}function Pe(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}function be(e){var t=-1,s=null==e?0:e.length;for(this.__data__=new Pe;++t<s;)this.add(e[t])}function Ie(e){var t=this.__data__=new Ae(e);this.size=t.size}function Te(e,t){for(var s=e.length;s--;)if(we(e[s][0],t))return s;return-1}function ve(e){return null==e?void 0===e?I:E:re&&re in Object(e)?function(e){var t=q.call(e,re),s=e[re];try{e[re]=void 0;var r=!0}catch(e){}var a=J.call(e);return r&&(t?e[re]=s:delete e[re]),a}(e):function(e){return J.call(e)}(e)}function ye(e){return $e(e)&&ve(e)==o}function Re(e,t,s,r,i){return e===t||(null==e||null==t||!$e(e)&&!$e(t)?e!=e&&t!=t:function(e,t,s,r,i,u){var p=Fe(e),g=Fe(t),E=p?l:Me(e),C=g?l:Me(t),I=(E=E==o?S:E)==S,y=(C=C==o?S:C)==S,R=E==C;if(R&&Ve(e)){if(!Ve(t))return!1;p=!0,I=!1}if(R&&!I)return u||(u=new Ie),p||Ye(e)?Ne(e,t,s,r,i,u):function(e,t,s,r,i,o,l){switch(s){case v:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case T:return!(e.byteLength!=t.byteLength||!o(new ee(e),new ee(t)));case c:case d:case _:return we(+e,+t);case h:return e.name==t.name&&e.message==t.message;case m:case P:return e==t+"";case f:var u=X;case A:var p=r&a;if(u||(u=G),e.size!=t.size&&!p)return!1;var g=l.get(e);if(g)return g==t;r|=n,l.set(e,t);var E=Ne(u(e),u(t),r,i,o,l);return l.delete(e),E;case b:if(Ce)return Ce.call(e)==Ce.call(t)}return!1}(e,t,E,s,r,i,u);if(!(s&a)){var N=I&&q.call(e,"__wrapped__"),O=y&&q.call(t,"__wrapped__");if(N||O){var L=N?e.value():e,B=O?t.value():t;return u||(u=new Ie),i(L,B,s,r,u)}}return!!R&&(u||(u=new Ie),function(e,t,s,r,n,i){var o=s&a,l=Oe(e),u=l.length;if(u!=Oe(t).length&&!o)return!1;for(var c=u;c--;){var d=l[c];if(!(o?d in t:q.call(t,d)))return!1}var h=i.get(e);if(h&&i.get(t))return h==t;var p=!0;i.set(e,t),i.set(t,e);for(var g=o;++c<u;){var f=e[d=l[c]],_=t[d];if(r)var E=o?r(_,f,d,t,e,i):r(f,_,d,e,t,i);if(!(void 0===E?f===_||n(f,_,s,r,i):E)){p=!1;break}g||(g="constructor"==d)}if(p&&!g){var S=e.constructor,C=t.constructor;S!=C&&"constructor"in e&&"constructor"in t&&!("function"==typeof S&&S instanceof S&&"function"==typeof C&&C instanceof C)&&(p=!1)}return i.delete(e),i.delete(t),p}(e,t,s,r,i,u))}(e,t,s,r,Re,i))}function Ne(e,t,s,r,i,o){var l=s&a,u=e.length,c=t.length;if(u!=c&&!(l&&c>u))return!1;var d=o.get(e);if(d&&o.get(t))return d==t;var h=-1,p=!0,g=s&n?new be:void 0;for(o.set(e,t),o.set(t,e);++h<u;){var f=e[h],_=t[h];if(r)var E=l?r(_,f,h,t,e,o):r(f,_,h,e,t,o);if(void 0!==E){if(E)continue;p=!1;break}if(g){if(!F(t,(function(e,t){if(!V(g,t)&&(f===e||i(f,e,s,r,o)))return g.push(t)}))){p=!1;break}}else if(f!==_&&!i(f,_,s,r,o)){p=!1;break}}return o.delete(e),o.delete(t),p}function Oe(e){return function(e,t,s){var r=t(e);return Fe(e)?r:function(e,t){for(var s=-1,r=t.length,a=e.length;++s<r;)e[a+s]=t[s];return e}(r,s(e))}(e,We,De)}function Le(e,t){var s=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?s["string"==typeof t?"string":"hash"]:s.map}function Be(e,t){var s=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!je(e)||function(e){return!!K&&K in e}(e))&&(Xe(e)?z:y).test(Ue(e))}(s)?s:void 0}me.prototype.clear=function(){this.__data__=he?he(null):{},this.size=0},me.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},me.prototype.get=function(e){var t=this.__data__;if(he){var s=t[e];return s===r?void 0:s}return q.call(t,e)?t[e]:void 0},me.prototype.has=function(e){var t=this.__data__;return he?void 0!==t[e]:q.call(t,e)},me.prototype.set=function(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=he&&void 0===t?r:t,this},Ae.prototype.clear=function(){this.__data__=[],this.size=0},Ae.prototype.delete=function(e){var t=this.__data__,s=Te(t,e);return!(s<0||(s==t.length-1?t.pop():se.call(t,s,1),--this.size,0))},Ae.prototype.get=function(e){var t=this.__data__,s=Te(t,e);return s<0?void 0:t[s][1]},Ae.prototype.has=function(e){return Te(this.__data__,e)>-1},Ae.prototype.set=function(e,t){var s=this.__data__,r=Te(s,e);return r<0?(++this.size,s.push([e,t])):s[r][1]=t,this},Pe.prototype.clear=function(){this.size=0,this.__data__={hash:new me,map:new(le||Ae),string:new me}},Pe.prototype.delete=function(e){var t=Le(this,e).delete(e);return this.size-=t?1:0,t},Pe.prototype.get=function(e){return Le(this,e).get(e)},Pe.prototype.has=function(e){return Le(this,e).has(e)},Pe.prototype.set=function(e,t){var s=Le(this,e),r=s.size;return s.set(e,t),this.size+=s.size==r?0:1,this},be.prototype.add=be.prototype.push=function(e){return this.__data__.set(e,r),this},be.prototype.has=function(e){return this.__data__.has(e)},Ie.prototype.clear=function(){this.__data__=new Ae,this.size=0},Ie.prototype.delete=function(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s},Ie.prototype.get=function(e){return this.__data__.get(e)},Ie.prototype.has=function(e){return this.__data__.has(e)},Ie.prototype.set=function(e,t){var s=this.__data__;if(s instanceof Ae){var r=s.__data__;if(!le||r.length<199)return r.push([e,t]),this.size=++s.size,this;s=this.__data__=new Pe(r)}return s.set(e,t),this.size=s.size,this};var De=ae?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var s=-1,r=null==e?0:e.length,a=0,n=[];++s<r;){var i=e[s];t(i)&&(n[a++]=i)}return n}(ae(e),(function(t){return te.call(e,t)})))}:function(){return[]},Me=ve;function xe(e,t){return!!(t=null==t?i:t)&&("number"==typeof e||R.test(e))&&e>-1&&e%1==0&&e<t}function Ue(e){if(null!=e){try{return H.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function we(e,t){return e===t||e!=e&&t!=t}(oe&&Me(new oe(new ArrayBuffer(1)))!=v||le&&Me(new le)!=f||ue&&"[object Promise]"!=Me(ue.resolve())||ce&&Me(new ce)!=A||de&&"[object WeakMap]"!=Me(new de))&&(Me=function(e){var t=ve(e),s=t==S?e.constructor:void 0,r=s?Ue(s):"";if(r)switch(r){case pe:return v;case ge:return f;case fe:return"[object Promise]";case _e:return A;case Ee:return"[object WeakMap]"}return t});var ke=ye(function(){return arguments}())?ye:function(e){return $e(e)&&q.call(e,"callee")&&!te.call(e,"callee")},Fe=Array.isArray,Ve=ne||function(){return!1};function Xe(e){if(!je(e))return!1;var t=ve(e);return t==p||t==g||t==u||t==C}function Ge(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}function je(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function $e(e){return null!=e&&"object"==typeof e}var Ye=k?function(e){return function(t){return e(t)}}(k):function(e){return $e(e)&&Ge(e.length)&&!!N[ve(e)]};function We(e){return function(e){return null!=e&&Ge(e.length)&&!Xe(e)}(e)?function(e,t){var s=Fe(e),r=!s&&ke(e),a=!s&&!r&&Ve(e),n=!s&&!r&&!a&&Ye(e),i=s||r||a||n,o=i?function(e,t){for(var s=-1,r=Array(e);++s<e;)r[s]=t(s);return r}(e.length,String):[],l=o.length;for(var u in e)!t&&!q.call(e,u)||i&&("length"==u||a&&("offset"==u||"parent"==u)||n&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||xe(u,l))||o.push(u);return o}(e):function(e){if(!function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Y)}(e))return ie(e);var t=[];for(var s in Object(e))q.call(e,s)&&"constructor"!=s&&t.push(s);return t}(e)}s.exports=function(e,t){return Re(e,t)}}).call(this,s(40),s(154)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e){e.exports={id:"http://json-schema.org/draft-04/schema#",$schema:"http://json-schema.org/draft-04/schema#",description:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},positiveInteger:{type:"integer",minimum:0},positiveIntegerDefault0:{allOf:[{$ref:"#/definitions/positiveInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},minItems:1,uniqueItems:!0}},type:"object",properties:{id:{type:"string",format:"uri"},$schema:{type:"string",format:"uri"},title:{type:"string"},description:{type:"string"},default:{},multipleOf:{type:"number",minimum:0,exclusiveMinimum:!0},maximum:{type:"number"},exclusiveMaximum:{type:"boolean",default:!1},minimum:{type:"number"},exclusiveMinimum:{type:"boolean",default:!1},maxLength:{$ref:"#/definitions/positiveInteger"},minLength:{$ref:"#/definitions/positiveIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{anyOf:[{type:"boolean"},{$ref:"#"}],default:{}},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:{}},maxItems:{$ref:"#/definitions/positiveInteger"},minItems:{$ref:"#/definitions/positiveIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},maxProperties:{$ref:"#/definitions/positiveInteger"},minProperties:{$ref:"#/definitions/positiveIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{anyOf:[{type:"boolean"},{$ref:"#"}],default:{}},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},enum:{type:"array",minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},dependencies:{exclusiveMaximum:["maximum"],exclusiveMinimum:["minimum"]},default:{}}},function(e){e.exports={$schema:"http://json-schema.org/draft-04/hyper-schema#",id:"http://json-schema.org/draft-04/hyper-schema#",title:"JSON Hyper-Schema",allOf:[{$ref:"http://json-schema.org/draft-04/schema#"}],properties:{additionalItems:{anyOf:[{type:"boolean"},{$ref:"#"}]},additionalProperties:{anyOf:[{type:"boolean"},{$ref:"#"}]},dependencies:{additionalProperties:{anyOf:[{$ref:"#"},{type:"array"}]}},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}]},definitions:{additionalProperties:{$ref:"#"}},patternProperties:{additionalProperties:{$ref:"#"}},properties:{additionalProperties:{$ref:"#"}},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"},links:{type:"array",items:{$ref:"#/definitions/linkDescription"}},fragmentResolution:{type:"string"},media:{type:"object",properties:{type:{description:"A media type, as described in RFC 2046",type:"string"},binaryEncoding:{description:"A content encoding scheme, as described in RFC 2045",type:"string"}}},pathStart:{description:"Instances' URIs must start with this value for this schema to apply to them",type:"string",format:"uri"}},definitions:{schemaArray:{type:"array",items:{$ref:"#"}},linkDescription:{title:"Link Description Object",type:"object",required:["href","rel"],properties:{href:{description:"a URI template, as defined by RFC 6570, with the addition of the $, ( and ) characters for pre-processing",type:"string"},rel:{description:"relation to the target resource of the link",type:"string"},title:{description:"a title for the link",type:"string"},targetSchema:{description:"JSON Schema describing the link target",$ref:"#"},mediaType:{description:"media type (as defined by RFC 2046) describing the link target",type:"string"},method:{description:'method for requesting the target of the link (e.g. for HTTP this might be "GET" or "DELETE")',type:"string"},encType:{description:"The media type in which to submit data along with the request",type:"string",default:"application/json"},schema:{description:"Schema describing the data to submit along with the request",$ref:"#"}}}}}},function(e){e.exports={id:"http://json-schema.org/draft-04/schema#",$schema:"http://json-schema.org/draft-04/schema#",description:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},positiveInteger:{type:"integer",minimum:0},positiveIntegerDefault0:{allOf:[{$ref:"#/definitions/positiveInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},minItems:1,uniqueItems:!0}},type:"object",properties:{id:{type:"string",format:"uri"},$schema:{type:"string",format:"uri"},title:{type:"string"},description:{type:"string"},default:{},multipleOf:{type:"number",minimum:0,exclusiveMinimum:!0},maximum:{type:"number"},exclusiveMaximum:{type:"boolean",default:!1},minimum:{type:"number"},exclusiveMinimum:{type:"boolean",default:!1},maxLength:{$ref:"#/definitions/positiveInteger"},minLength:{$ref:"#/definitions/positiveIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{anyOf:[{type:"boolean"},{$ref:"#"}],default:{}},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:{}},maxItems:{$ref:"#/definitions/positiveInteger"},minItems:{$ref:"#/definitions/positiveIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},maxProperties:{$ref:"#/definitions/positiveInteger"},minProperties:{$ref:"#/definitions/positiveIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{anyOf:[{type:"boolean"},{$ref:"#"}],default:{}},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},enum:{type:"array",minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},dependencies:{exclusiveMaximum:["maximum"],exclusiveMinimum:["minimum"]},default:{}}},function(e){e.exports={id:"http://igt.com/activateDiagnostics/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for activateDiagnostics",type:"object",properties:{cmd:{type:"string",pattern:"^activateDiagnostics$"},ver:{type:"string"},activateDiagnostics:{type:"object",properties:{pin:{type:"string"}},required:["pin"]}},required:["cmd","activateDiagnostics"]}},function(e){e.exports={id:"http://igt.com/buttonPress/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for buttonPress",type:"object",properties:{cmd:{type:"string",pattern:"^buttonPress$"},ver:{type:"string"},buttonPress:{enum:["KEYPRESS_0","KEYPRESS_1","KEYPRESS_2","KEYPRESS_3","KEYPRESS_4","KEYPRESS_5","KEYPRESS_6","KEYPRESS_7","KEYPRESS_8","KEYPRESS_9","KEYPRESS_E","MENU","ENTER","BONUSBUTTON","OK","NO","TOUCHSCREEN"]}},required:["cmd","buttonPress"]}},function(e){e.exports={id:"http://igt.com/hostEventButtonPress/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for hostEventButtonPress",type:"object",properties:{cmd:{type:"string",pattern:"^hostEventButtonPress$"},ver:{type:"string"},hostEventButtonPress:{type:"object",properties:{hostEventId:{type:"integer",minimum:0,maximum:9},subEventId:{type:"integer",minimum:0,maximum:9},onlineOnly:{type:"boolean"},bonusId:{type:"integer",minimum:0,maximum:65535}},required:["hostEventId","subEventId","onlineOnly","bonusId"]}},required:["cmd","hostEventButtonPress"]}},function(e){e.exports={id:"http://igt.com/screenTrigger/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for screenTrigger",type:"object",properties:{cmd:{type:"string",pattern:"^screenTrigger$"},ver:{type:"string"},screenTrigger:{type:"object",properties:{screenId:{type:"string",pattern:"^0[xX][0-9a-fA-F]{2}$"},displayMessage:{type:"string",minLength:0,maxLength:240}},required:["screenId","displayMessage"]}},required:["cmd","screenTrigger"]}},function(e){e.exports={id:"http://igt.com/subscription/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for subscription",type:"object",properties:{cmd:{type:"string",pattern:"^subscription$"},ver:{type:"string"},subscription:{type:"object",properties:{vpcPlayerData:{type:"boolean"},statusUpdate:{type:"boolean"},levelUpdate:{type:"boolean"},bonusHit:{type:"boolean"},gameStart:{type:"boolean"},gameEnd:{type:"boolean"},patronData:{type:"boolean"},disableAutoHide:{type:"boolean"},windowState:{type:"boolean"},mediaDisplayIndex:{type:"integer",minimum:0},tokenUpdate:{type:"array",items:{type:"string",pattern:"^0[xX][0-9a-fA-F]{2}$"}},screenTrigger:{type:"array",items:{type:"string",pattern:"^0[xX][0-9a-fA-F]{2}$"}},gameEvent:{type:"array",items:{type:"string",pattern:"^0[xX][0-9a-fA-F]{2}$"}},languageUpdate:{type:"boolean"},userTokenUpdate:{type:"array",items:{type:"string",pattern:"^0[xX][0-9a-fA-F]{2}$"}}}}},required:["cmd","subscription"]}},function(e){e.exports={id:"http://igt.com/subscriptionAck/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for subscriptionAck",type:"object",properties:{cmd:{type:"string",pattern:"^subscriptionAck$"},ver:{type:"string"}},required:["cmd"]}},function(e){e.exports={id:"http://igt.com/tokenUpdate/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for tokenUpdate",type:"object",properties:{cmd:{type:"string",pattern:"^tokenUpdate$"},ver:{type:"string"},tokenUpdate:{type:"array",minItems:0,uniqueItems:!0,items:{type:"object",properties:{id:{type:"string",pattern:"^0[xX][0-9a-fA-F]{2}$"},value:{type:"string",minLength:0,maxLength:40}},required:["id","value"]}}},required:["cmd","tokenUpdate"]}},function(e){e.exports={id:"http://igt.com/be2BasicFunction/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for be2BasicFunction",type:"object",properties:{cmd:{type:"string",pattern:"^be2BasicFunction$"},ver:{type:"string"},be2BasicFunction:{type:"array",minItems:1,maxItems:10,items:{type:"object",properties:{functionCode:{type:"integer",minimum:0,maximum:255},arguments:{type:"array",minItems:4,maxItems:4,items:{type:"integer"}}},required:["functionCode","arguments"]}}},required:["cmd","be2BasicFunction"]}},function(e){e.exports={id:"http://igt.com/be2BasicResponse/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for be2BasicResponse",type:"object",properties:{cmd:{type:"string",pattern:"^be2BasicResponse$"},ver:{type:"string"},be2BasicResponse:{type:"array",minItems:1,maxItems:10,items:{type:"object",properties:{functionCode:{type:"integer",minimum:0,maximum:255},retvals:{type:"array",minItems:4,maxItems:4,items:{type:"integer"}}},required:["functionCode","retvals"]}}},required:["cmd","be2BasicResponse"]}},function(e){e.exports={id:"http://igt.com/bonusHit/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for bonusHit",type:"object",properties:{cmd:{type:"string",pattern:"^bonusHit$"},ver:{type:"string"},bonusHit:{type:"object",properties:{isBe2Based:{type:"boolean"},bonusId:{type:"integer",minimum:0},hitNumber:{type:"integer",minimum:0},winAmount:{type:"integer",minimum:0},payTo:{type:"integer",minimum:0},winner:{type:"boolean"},nonCash:{type:"boolean"}},required:["isBe2Based","bonusId","hitNumber","winAmount","payTo","winner","nonCash"]}},required:["cmd","bonusHit"]}},function(e){e.exports={id:"http://igt.com/drawStatus/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for drawStatus",type:"object",properties:{cmd:{type:"string",pattern:"^drawStatus$"},ver:{type:"string"},drawStatus:{type:"object",properties:{bonusId:{type:"integer"},drawTime:{type:"integer"},drawStatus:{type:"integer",enum:[0,1,2,3,4,5,6]}},required:["bonusId","drawTime","drawStatus"]}},required:["cmd","drawStatus"]}},function(e){e.exports={id:"http://igt.com/fullscreenState/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for fullscreenState",type:"object",properties:{cmd:{type:"string",pattern:"^fullscreenState$"},ver:{type:"string"},fullscreenState:{type:"boolean"}},required:["cmd","fullscreenState"]}},function(e){e.exports={id:"http://igt.com/gameEnd/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for gameEnd",type:"object",properties:{cmd:{type:"string",pattern:"^gameEnd$"},ver:{type:"string"},gameEnd:{type:"object",properties:{winAmount:{type:"integer"}},required:["winAmount"]}},required:["cmd","gameEnd"]}},function(e){e.exports={id:"http://igt.com/gameEvent/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for gameEvent",type:"object",properties:{cmd:{type:"string",pattern:"^gameEvent$"},ver:{type:"string"},gameEvent:{type:"string",pattern:"^0[xX][0-9a-fA-F]{2}$"}},required:["cmd","gameEvent"]}},function(e){e.exports={id:"http://igt.com/gameStart/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for gameStart",type:"object",properties:{cmd:{type:"string",pattern:"^gameStart$"},ver:{type:"string"},gameStart:{type:"object",properties:{wagerCredits:{type:"integer"},isMaxBet:{type:"boolean"},wagerDenom:{type:"integer"},wagerAmount:{type:"integer"}},required:["wagerCredits","isMaxBet","wagerDenom","wagerAmount"]}},required:["cmd","gameStart"]}},function(e){e.exports={id:"http://igt.com/getServerAddresses/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for getServerAddresses",type:"object",properties:{cmd:{type:"string",pattern:"^getServerAddresses$"},ver:{type:"string"},getServerAddresses:{type:"array",minItems:1,maxItems:16,uniqueItems:!0,items:{type:"string"}}},required:["cmd","getServerAddresses"]}},function(e){e.exports={id:"http://igt.com/ismUpdate/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for ismUpdate",type:"object",properties:{cmd:{type:"string",pattern:"^ismUpdate$"},ver:{type:"string"},ismUpdate:{type:"object",properties:{triggerEnables:{type:"integer"},totalPointsTrigger:{type:"integer"},sessionPointsTrigger:{type:"integer"},sessionCoinInTrigger:{type:"integer"},sessionCoinOutTrigger:{type:"integer"},sessionGamesPlayedTrigger:{type:"integer"},denomTrigger:{type:"integer"},paytableTrigger:{type:"object",properties:{gameId:{type:"string"},additionalId:{type:"string"},paytableId:{type:"string"},basePercentage:{type:"string"}},required:["gameId","additionalId","paytableId","basePercentage"]},sessionLossTrigger:{type:"integer"},totalPointsValue:{type:"integer"},sessionPointsValue:{type:"integer"},sessionCoinInValue:{type:"integer"},sessionCoinOutValue:{type:"integer"},sessionGamesPlayedValue:{type:"integer"},denomValue:{type:"integer"},paytableValue:{type:"object",properties:{gameId:{type:"string"},additionalId:{type:"string"},paytableId:{type:"string"},basePercentage:{type:"string"}},required:["gameId","additionalId","paytableId","basePercentage"]},sessionLossValue:{type:"integer"}},required:["triggerEnables","totalPointsTrigger","sessionPointsTrigger","sessionCoinInTrigger","sessionCoinOutTrigger","sessionGamesPlayedTrigger","denomTrigger","paytableTrigger","sessionLossTrigger","totalPointsValue","sessionPointsValue","sessionCoinInValue","sessionCoinOutValue","sessionGamesPlayedValue","denomValue","paytableValue","sessionLossValue"]}},required:["cmd","ismUpdate"]}},function(e){e.exports={id:"http://igt.com/levelUpdate/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for levelUpdate",type:"object",properties:{cmd:{type:"string",pattern:"^levelUpdate$"},ver:{type:"string"},levelUpdate:{type:"array",minItems:0,maxItems:32,items:{type:"object",properties:{bonusId:{type:"integer"},balance:{type:"integer"},isBbPGBonus:{type:"boolean"},BbPGBonusMeter:{type:"integer"},levelName:{type:"string"}},required:["bonusId","balance","isBbPGBonus","BbPGBonusMeter","levelName"]}}},required:["cmd","levelUpdate"]}},function(e){e.exports={id:"http://igt.com/patronData/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for patronData",type:"object",properties:{cmd:{type:"string",pattern:"^patronData$"},ver:{type:"string"},patronData:{type:"object",properties:{xcAwardBalance:{type:"integer"},rpPointBalance:{type:"integer"},rpEarnedDay:{type:"integer"},ppTotalWon:{type:"integer"},ptpSPUsed:{type:"integer"},ptpBalance:{type:"integer"},awardEnable:{type:"object",properties:{ptpEnable:{type:"boolean"},rpEnable:{type:"boolean"},ppEnable:{type:"boolean"},xcEnable:{type:"boolean"},notUsed4:{type:"boolean"},srpEnable:{type:"boolean"},hidePoints:{type:"boolean"},notUsed7:{type:"boolean"}},required:["ptpEnable","rpEnable","ppEnable","xcEnable","srpEnable","hidePoints"]},BE2_AwardEnable:{type:"object",properties:{ptpEnable:{type:"boolean"},rpEnable:{type:"boolean"},ppEnable:{type:"boolean"},xcEnable:{type:"boolean"},xcViaAFT:{type:"boolean"},srpEnable:{type:"boolean"},notUsed6:{type:"boolean"},notUsed7:{type:"boolean"}},required:["ptpEnable","rpEnable","ppEnable","xcEnable","xcViaAFT","srpEnable"]},generalPTData:{type:"object",properties:{countUp:{type:"boolean"},vipLightOn:{type:"boolean"},zeroUnused:{type:"boolean"},PINLocked:{type:"boolean"},notUsed:{type:"boolean"},dupCard:{type:"boolean"},banned:{type:"boolean"},comboChange:{type:"boolean"}},required:["countUp","vipLightOn","zeroUnused","PINLocked","dupCard","banned","comboChange"]},srpPointBalance:{type:"integer"},srpLevel:{type:"integer"},xpcAward:{type:"integer"},ranking:{type:"integer"},languageId:{type:"integer"}},required:["xcAwardBalance","rpPointBalance","rpEarnedDay","ppTotalWon","ptpSPUsed","ptpBalance","awardEnable","BE2_AwardEnable","generalPTData","srpPointBalance","srpLevel","xpcAward","ranking","languageId"]}},required:["cmd","patronData"]}},function(e){e.exports={id:"http://igt.com/patronDataExt/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for patronDataExt",type:"object",properties:{cmd:{type:"string",pattern:"^patronDataExt$"},ver:{type:"string"},patronDataExt:{type:"object",properties:{sequenceId:{type:"integer"},playerRank:{type:"string"},playerRankIndex:{type:"integer"}},required:["sequenceId","playerRank","playerRankIndex"]}},required:["cmd","patronDataExt"]}},function(e){e.exports={id:"http://igt.com/serverAddresses/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for serverAddresses",type:"object",properties:{cmd:{type:"string",pattern:"^serverAddresses$"},ver:{type:"string"},serverAddresses:{type:"array",minItems:1,maxItems:16,items:{type:"object"}}},required:["cmd","serverAddresses"]}},function(e){e.exports={id:"http://igt.com/showWindow/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for showWindow",type:"object",properties:{cmd:{type:"string",pattern:"^showWindow$"},ver:{type:"string"},showWindow:{type:"boolean"}},required:["cmd","showWindow"]}},function(e){e.exports={id:"http://igt.com/statusUpdate/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for statusUpdate",type:"object",properties:{cmd:{type:"string",pattern:"^statusUpdate$"},ver:{type:"string"},statusUpdate:{type:"object",properties:{meterDenom:{type:"integer",minimum:0},tokenDenom:{type:"integer",minimum:0},gameId:{type:"string",minLength:0,maxLength:2},gameOtherId:{type:"string",minLength:0,maxLength:3},paytableId:{type:"string",minLength:0,maxLength:6},displayLimits:{type:"object",properties:{coinInRunaway:{type:"integer"},coinOutRunaway:{type:"integer"},jackpot:{type:"integer"},bonus:{type:"integer"},xtraCredit:{type:"integer"},points:{type:"integer"},comp:{type:"integer"},witness:{type:"integer"},pouchPay:{type:"integer"}},required:["coinInRunaway","coinOutRunaway","jackpot","bonus","xtraCredit","points","comp","witness","pouchPay"]}},required:["meterDenom","tokenDenom","gameId","gameOtherId","paytableId","displayLimits"]}},required:["cmd","statusUpdate"]}},function(e){e.exports={id:"http://igt.com/statusMap/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for statusmap",type:"object",properties:{pointPlay:{type:"object",properties:{init:{type:"object",properties:{0:{type:"string",examples:["Point Play available."]},1:{type:"string",examples:["Point Play not available: Bonusing not available on this machine."]},2:{type:"string",examples:["Point Play not available: PIN Locked."]},3:{type:"string",examples:["Point Play not available:  see players club."]},4:{type:"string",examples:["Point Play not available: Point balance too low to convert."]},5:{type:"string",examples:["Point Play not available: Conversion to Xtra Credit not available, see players club."]},6:{type:"string",examples:["Point Play not available: Conversion to Xtra Credit not available on this machine."]},7:{type:"string",examples:["Point Play not available: PIN validation failed."]},8:{type:"string",examples:["Point Play not converted. Amount not compatible with this denomination."]}},required:["0","1","2","3","4","5","6","7","8"]},convert:{type:"object",properties:{0:{type:"string",examples:["Point Play converted."]},1:{type:"string",examples:["Point Play not available: Bonusing not available on this machine."]},2:{type:"string",examples:["Point Play not available: PIN Locked."]}},required:["0","1","2"]}},required:["init","convert"]},xtraCredit:{type:"object",properties:{activate:{type:"object",properties:{0:{type:"string",examples:["Xtra Credit active."]},1:{type:"string",examples:["Xtra Credit active; not cancelable."]},2:{type:"string",examples:["Xtra Credit already active."]},3:{type:"string",examples:["Xtra Credit balance is too low to activate."]},4:{type:"string",examples:["Xtra Credit not active; not available on this device."]},5:{type:"string",examples:["Xtra Credit not active; see players club."]},6:{type:"string",examples:["Xtra Credit not active; duplicate card."]},7:{type:"string",examples:["Xtra Credit not active; abandoned card."]},8:{type:"string",examples:["Xtra Credit not active; PIN is locked."]},9:{type:"string",examples:["Xtra Credit not active; Bonusing not available on this machine."]},10:{type:"string",examples:["Xtra Credit not active; PIN validation failed."]},11:{type:"string",examples:["Xtra Credit not active; Input amount is invalid."]},12:{type:"string",examples:["Xtra Credit not active; Input amount is over limit."]},13:{type:"string",examples:["Xtra Credit not active; Input amount is less than machine denom."]},14:{type:"string",examples:["Xtra Credit not active; Last request still in progress."]},15:{type:"string",examples:["Xtra Credit not active; see players club."]},16:{type:"string",examples:["Xtra Credit not active; see players club."]},17:{type:"string",examples:["Xtra Credit not active; see players club."]}},required:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"]},cancel:{type:"object",properties:{0:{type:"string",examples:["Xtra Credit canceled."]},1:{type:"string",examples:["Xtra Credit not cancellable."]},2:{type:"string",examples:["Cancel Xtra Credit after game cycle completes."]}},required:["0","1","2"]}},required:["activate","cancel"]},pin:{type:"object",properties:{validate:{type:"object",properties:{0:{type:"string",examples:["waiting"]},1:{type:"string",examples:["valid"]},2:{type:"string",examples:["invalid PIN"]},3:{type:"string",examples:["PIN locked"]},4:{type:"string",examples:["no-response; try again"]},5:{type:"string",examples:["PIN Cancel"]}},required:["0","1","2","3","4","5"]}},required:["validate"]},cashless:{type:"object",properties:{transfer:{type:"object",properties:{0:{type:"string",examples:["Transfer successful."]},1:{type:"string",examples:["Transfer aborted."]},2:{type:"string",examples:["Transfer failed."]},3:{type:"string",examples:["Transfer started but ultimately aborted."]},4:{type:"string",examples:["Transfer started but ultimately failed."]},5:{$id:"/properties/cashless/properties/transfer/properties/5",type:"string",title:"The 5 Schema ",default:"",examples:["Transfer failed for an unknown reason."]},6:{type:"string",examples:["Transfer operation timed out."]},7:{type:"string",examples:["Transfer successful; SmartCard successfully unlocked."]},8:{type:"string",examples:["Transfer successful; SmartCard unlock failed due to credits on the machine."]},9:{type:"string",examples:["Transfer successful, SmartCard unlock failed due to a game in progress."]}},required:["0","1","2","3","4","5","6","7","8","9"]}},required:["transfer"]}},required:["pointPlay","xtraCredit","pin","cashless"]}},function(e){e.exports={id:"http://igt.com/urlMap/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for urlmap",type:"object",properties:{indexUrl:{type:"string",format:"uri"},baseUrl:{type:"string",format:"uri"},bannerUrl:{type:"string",format:"uri"},pinContentUrl:{type:"string",format:"uri"},screenIdMap:{type:"object"},ciHost:{type:"string",format:"uri"},loggerUrl:{type:"string",format:"uri"},logLevel:{type:"string",enum:["HEARTBEAT","DEBUG","INFO","WARN","ERROR"]},subscribeAllTriggers:{type:"boolean"},legacyIdList:{type:"array",items:{type:"string"}},securityServiceEndpoint:{type:"string",format:"uri"},webWorkers:{type:"array",items:{type:"string",format:"uri"}}},required:["indexUrl","bannerUrl","pinContentUrl","screenIdMap","loggerUrl"]}},function(e){e.exports={id:"http://igt.com/windowState/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for windowState",type:"object",properties:{cmd:{type:"string",pattern:"^windowState$"},ver:{type:"string"},windowState:{type:"boolean"}},required:["cmd","windowState"]}},function(e){e.exports={id:"http://igt.com/cardlessStatus/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for cardlessStatus",type:"object",properties:{cmd:{type:"string",pattern:"^cardlessStatus$"},ver:{type:"string"},cardlessStatus:{type:"object",properties:{interface:{type:"string"},status:{type:"string"},version:{type:"integer"},mobile:{type:"boolean"},app_label:{type:"string"},disconnectReason:{type:"integer"}},required:["interface","status"]}},required:["cmd","cardlessStatus"]}},function(e){e.exports={id:"http://igt.com/forceCardOut/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for forceCardOut",type:"object",properties:{cmd:{type:"string",pattern:"^forceCardOut$"},ver:{type:"string"}},required:["cmd"]}},function(e){e.exports={id:"http://igt.com/forceCardOutAck/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for forceCardOutAck",type:"object",properties:{cmd:{type:"string",pattern:"^forceCardOutAck$"},ver:{type:"string"},forceCardOutAck:{type:"boolean"}},required:["cmd","forceCardOutAck"]}},function(e){e.exports={id:"http://igt.com/getqrcode/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for getQRcode",type:"object",properties:{cmd:{type:"string",pattern:"^getQRcode$"},ver:{type:"string"}},required:["cmd"]}},function(e){e.exports={id:"http://igt.com/qrcode/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for qrCode",type:"object",properties:{cmd:{type:"string",pattern:"^qrCode$"},ver:{type:"string"},qrCode:{type:"object",properties:{qrCode:{type:"string"},duration:{type:"integer"}},required:["qrCode"]}},required:["cmd","qrCode"]}},function(e){e.exports={id:"http://igt.com/vpcButtonPress/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for vpcButtonPress",type:"object",properties:{cmd:{type:"string",pattern:"^vpcButtonPress$"},ver:{type:"string"},vpcButtonPress:{enum:["VPC_KEYPRESS_S","VPC_KEYPRESS_C","VPC_KEYPRESS_L","VPC_KEYPRESS_A"]}},required:["cmd","vpcButtonPress"]}},function(e){e.exports={id:"http://igt.com/vpcGetPlayerData/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for vpcGetPlayerData",type:"object",properties:{cmd:{type:"string",pattern:"^vpcGetPlayerData$"},ver:{type:"string"}},required:["cmd"]}},function(e){e.exports={id:"http://igt.com/vpcPIN/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for vpcPIN",type:"object",properties:{cmd:{type:"string",pattern:"^vpcPIN$"},ver:{type:"string"},pin:{type:"string",pattern:"^[0-9]{1,16}$"}},required:["cmd","pin"]}},function(e){e.exports={id:"http://igt.com/vpcPlayerData/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for vpcPlayerData",type:"object",properties:{cmd:{type:"string",pattern:"^vpcPlayerData$"},ver:{type:"string"},vpcPlayerData:{type:"object",properties:{limits:{type:"array",items:{type:"object",properties:{type:{type:"integer"},period:{type:"integer"},alertThresholds:{type:"array",items:{type:"integer"}},threshold:{type:"integer"},session:{type:"integer"},current:{type:"integer"},hit:{type:"integer"}},required:["type","period","alertThresholds","threshold","session","current","hit"]}},playerMessage:{type:"string"},limitToShow:{type:"integer"},lastTimeLimitSet:{type:"integer"},cardId:{type:"string",maxLength:20},haveHostData:{type:"integer"}},required:["limits","playerMessage","limitToShow","lastTimeLimitSet","cardId","haveHostData"]}},required:["cmd","vpcPlayerData"]}},function(e){e.exports={id:"http://igt.com/getUserToken/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for getUserToken",type:"object",properties:{cmd:{type:"string",pattern:"^getUserToken$"},ver:{type:"string"},getUserToken:{type:"array",minItems:1,uniqueItems:!0,items:{type:"string",pattern:"^0[xX][0-9a-fA-F]{2}$"}}},required:["cmd","getUserToken"]}},function(e){e.exports={id:"http://igt.com/languageUpdate/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for languageUpdate",type:"object",properties:{cmd:{type:"string",pattern:"^languageUpdate$"},ver:{type:"string"},languageUpdate:{type:"object",properties:{languageIndex:{type:"integer"},languageName:{type:"string"}},required:["languageIndex","languageName"]}},required:["cmd","languageUpdate"]}},function(e){e.exports={id:"http://igt.com/userTokenUpdate/V1.0",$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for userTokenUpdate",type:"object",properties:{cmd:{type:"string",pattern:"^userTokenUpdate$"},ver:{type:"string"},userTokenUpdate:{type:"array",minItems:0,uniqueItems:!0,items:{type:"object",properties:{id:{type:"string",pattern:"^0[xX][0-9a-fA-F]{2}$"},value:{type:"string",minLength:0,maxLength:40}},required:["id","value"]}}},required:["cmd","userTokenUpdate"]}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=T(s(197)),a=T(s(198)),n=T(s(199)),i=T(s(200)),o=T(s(201)),l=T(s(202)),u=T(s(203)),c=T(s(204)),d=T(s(206)),h=T(s(207)),p=T(s(208)),g=T(s(209)),f=T(s(210)),_=T(s(211)),E=T(s(212)),S=T(s(213)),C=T(s(3)),m=T(s(37)),A=T(s(36)),P=T(s(214)),b=T(s(215)),I=T(s(6));function T(e){return e&&e.__esModule?e:{default:e}}function v(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,s){return function r(a,n){try{var i=t[a](n),o=i.value}catch(e){return void s(e)}if(!i.done)return Promise.resolve(o).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(o)}("next")}))}}const y=({securityServiceEndpoint:e=null},t,s)=>new a.default({endpoint:e,auth:"/identity_zones/m5zone/user/authenticate",invalidate:"/user/access_token",retryDelay:500},t,s),R=(()=>{var e=v((function*(e,t,s,r){const a=window.parent.document.querySelector(s);if(null===a){const e=`Cannot find iframe element with id of ${s}. Please ensure it exists.`;return r.error({error:e},!0),Promise.reject(e)}yield e.setupIframe(a,t)}));return function(t,s,r,a){return e.apply(this,arguments)}})();t.default=class{constructor(e,t,s,a,T,N,O){var L=this;let B;this.logger=T,this.m5Config=N,this.ngxSubscriptionConfig=O,this.loadContent=(()=>{var e=v((function*(e){yield R(L.triggerContentVC,e,"#WrapperFrame",L.logger)}));return function(t){return e.apply(this,arguments)}})();try{B=m.default.normalizeUrlMap(s)}catch(e){T.error({error:e},!0)}const D=Object.keys(B.screenIdMap),M=s.subscribeAllTriggers,x=new i.default(D,T,M,B.legacyIdList,I.default,this.ngxSubscriptionConfig),U=new c.default(e,x,T,this.m5Config);U.setupWebSocket().then(()=>{T.debug({debug:"Content interface web socket setup at shell controller is complete."},!0),new A.default(s.webWorkers,T);const e=new o.default,i=new l.default(U,T,this.m5Config);((e,{subscription:{screenTrigger:t,tokenUpdate:s}},r)=>{t.forEach(t=>{e.registerScreenTrigger(t,({detail:{screenTrigger:e}})=>{r.storeTrigger(e.screenId,e.displayMessage,e.messageTokens)})}),s.forEach(t=>{e.registerTokenUpdate(t,({detail:{tokenUpdate:e}})=>{r.storeToken(e[0].id,e[0].value)})})})(U,x.getSubscription(),e),((e,{subscription:{screenTrigger:t,tokenUpdate:s}},r)=>{t.forEach(t=>{e.registerScreenTrigger(t,({detail:{screenTrigger:e}})=>{r.handleTriggerUpdate(e.screenId,e.displayMessage,e.messageTokens)})}),s.forEach(t=>{e.registerTokenUpdate(t,({detail:{tokenUpdate:e}})=>{r.handleTokenUpdate(e[0].id,e[0].value)})})})(U,x.getSubscription(),i),this.bannerVC=d.default.VCWRegistration(T,t,"BannerVC",U,x),this.pinContentVC=d.default.VCWRegistration(T,t,"PINContentVC",U,x),this.triggerContentVC=d.default.VCWRegAndTrigger(T,t,"TriggerContentVC",U,x,B,N);const c=y(B,T,U),I={enabled:-1!==Object.keys(B.screenIdMap).indexOf(C.default.W2G_ACCRUAL_SCREEN),resetTimeout:2e3,waitForCardTypeInterval:2e3},v=new n.default(U,T,I,i,this.m5Config),L=new S.default;this.pinService=new h.default(U,c,T,i,D),this.fullScreenToggle=new E.default(U,L,T,m.default.getUrlParamsObject(t)),this.xtraCreditService=new p.default(U,T,i,a),this.pointPlayService=new g.default(U,T,i),this.cashlessService=new f.default(U,T,i),this.pointPayService=new _.default(U,T),this.attendantService=new P.default(U,T),this.cardlessService=new b.default(U,T,N,i,O.cardlessStatus),this.statusMessageCache=new u.default,this.statusMessageCache.setStatusMessages(a);const M=e=>{this.bannerVC.sendMessage(e),this.triggerContentVC.sendMessage(e),A.default.Instance().broadcastMessage(e)},w=e=>{this.pinContentVC.sendMessage(e)};new r.default(U,M,this.loadContent,x,L,e,T,c,v,m.default.getUrlParamsObject(t),this.statusMessageCache,this.cardlessService),this.pinService.registerValidatePINRespCB(M),this.pinService.registerValidatePINRespCB(w),this.pinService.registerShowPINEntryScreenCB(w),this.pinService.registerHidePINEntryScreenCB(w),this.xtraCreditService.registerEnableXtraCreditRespCB(M),this.xtraCreditService.registerActivateXtraCreditRespCB(M),this.xtraCreditService.registerCancelXtraCreditRespCB(M),this.xtraCreditService.registerIsActiveXCRespCB(M),this.pointPlayService.registerEnablePointPlayRespCB(M),this.pointPlayService.registerInitiatePointPlayRespCB(M),this.pointPlayService.registerConvertPPRespCB(M),this.cashlessService.registerCashlessEnabledRespCB(M),this.cashlessService.registerGetCashlessBalanceRespCB(M),this.cashlessService.registerInitiateTransferRespCB(M),this.pointPayService.registerPointPayEnabledRespCB(M),this.pointPayService.registerPointPayCodeRespCB(M),this.pointPayService.registerInitiatePointPayRespCB(M),this.attendantService.registerCardTypeRespCB(M),this.cardlessService.registerCardlessStatusUpdateCB(M),U.registerLanguageUpdate(M),U.registerLanguageUpdate(w),U.registerFullScreenState(M),U.registerFullScreenState(w),Promise.all([R(this.triggerContentVC,B.indexUrl,"#WrapperFrame",T),R(this.bannerVC,B.bannerUrl,"#BannerFrame",T),R(this.pinContentVC,B.pinContentUrl,"#PinContentFrame",T)]).then(()=>{U.sendSubscription()}).catch(e=>{T.error({error:"Unable to setup iframes",data:e},!0)})}).catch(e=>{T.error({error:"Error in shell controller setup",data:e.message},!0)})}cleanup(){this.pinService.cleanup(),this.fullScreenToggle.cleanup(),this.xtraCreditService.cleanup(),this.pointPlayService.cleanup(),this.cashlessService.cleanup(),this.pointPayService.cleanup(),this.attendantService.cleanup(),this.cardlessService.cleanup()}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=u(s(1)),a=u(s(2)),n=u(s(6)),i=u(s(36)),o=u(s(63)),l=u(s(3));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,s){return function r(a,n){try{var i=t[a](n),o=i.value}catch(e){return void s(e)}if(!i.done)return Promise.resolve(o).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(o)}("next")}))}}t.default=class{constructor(e,t,s,n,i,o,l,u,c,d,h,p){this.ngxComm=e,this.broadcastToView=t,this.loadUrl=s,this.subManager=n,this.shellCache=i,this.enumBE2Func=r.default.enumBE2BasicFunc,this.contentCache=o,this.logger=l,this.sessionService=u,this.w2gAccrualService=c,this.urlParams=d,this.statusMessageCache=h,this.cardlessService=p,window.addEventListener("message",this.receiveMessage.bind(this),!1),a.default.subscribe("ww_message",this.receiveMessage.bind(this)),this.notifyActiveWindow()}sendMessage(e,t){e?e.postMessage(t,"*"):i.default.Instance().broadcastMessage(t)}addTransactionId(e,t){return void 0!==e&&(t.transactionId=e),t}createRejectionMsg(e){return e+" data message is invalid according to schema. Rejecting message."}validMessage(e,t){var s=this;return c((function*(){return yield n.default.validate(e,t).then((function(){return!0}),(function(){return s.logger.error({error:s.createRejectionMsg(t),data:e}),!1}))}))()}setPropSubAndSend(e,t){this.subManager.isAttrEqual(e,t)||(this.subManager.setAttribute(e,t),this.ngxComm.sendSubscription())}addIdsToSubAndSend(e,t){var s=this;return c((function*(){let r=!1;const a=t.filter((function(t){return!s.subManager.doesAttrContainId(e,t)}));yield o.default.asyncForEach(a,(()=>{var t=c((function*(t){r=!0;try{yield s.subManager.addId(e,t)}catch(r){s.logger.error({error:r.message,data:{prop:e,id:t}})}}));return function(e){return t.apply(this,arguments)}})(),s),r&&s.ngxComm.sendSubscription()}))()}callCmd(e,t,s,r){if(e){const n=["validatePIN","createPinSession","enableXtraCredit","activateXtraCredit","activateXtraCreditWithAmount","cancelXtraCredit","enablePointPlay","initPointPlay","convertPointPlay","cancelPointPlay","isXtraCreditActive","toggle-full-screen","show-full-screen","hide-full-screen","checkCashlessEnabled","getCashlessBalance","initiateTransferFromEgm","initiateTransferFromCard","pinEntryResp","pinEntryComplete","checkPointPayEnabled","checkPointPayCode","initiatePointPay","attendantCardInserted"],i=e.replace(/\./g,"_");if(n.includes(i))a.default.publish(i,t);else{const a=this[i];void 0===a?this.logger.warn("view listener - no case for cmd: "+e):a.call(this,e,t,s,r)}}}vpcGetPlayerData(e){var t=this;return c((function*(){const s=r.default.createVpcGetPlayerData();(yield t.validMessage(s,e))&&t.ngxComm.sendMessage(s)}))()}vpcButtonPress(e,t,s){var a=this;return c((function*(){const t=r.default.createVpcButtonPress(s);(yield a.validMessage(t,e))&&a.ngxComm.sendMessage(t)}))()}vpcPIN(e,t,s){var a=this;return c((function*(){const t=r.default.createVpcPin(s);(yield a.validMessage(t,e))&&a.ngxComm.sendMessage(t)}))()}hostEventButtonPress(e,t,s){var a=this;return c((function*(){const t=r.default.createHostEventButtonPress(s.hostEventId,s.subEventId,s.onlineOnly,s.bonusId);(yield a.validMessage(t,e))&&a.ngxComm.sendMessage(t)}))()}buttonPress(e,t,s){var a=this;return c((function*(){const e=r.default.createButtonPress(s);(yield a.validMessage(e,"buttonPress"))&&a.ngxComm.sendMessage(e)}))()}activateDiagnostics(e,t){var s=this;return c((function*(){(yield s.validMessage(t,"activateDiagnostics"))&&s.ngxComm.sendMessage(t)}))()}getQRcode(){var e=this;return c((function*(){const t=r.default.createGetQRCode();(yield e.validMessage(t,"getQRcode"))&&e.ngxComm.sendMessage(t)}))()}navigateToSession(e){this.logger.debug("******M5 forcefully initiated session screen"),this.ngxComm.initiateM5_AdvScreenTrigger(l.default.SESSION_SCREEN)}getTokens(e,t){t.getTokens?this.ngxComm.getTokens(t.getTokens):this.logger.warn("Ids not provided for cmd: "+e)}getCurrentTokenValue(e,t){if(t.getCurrentTokenValue){const e=this.ngxComm.getCurrentTokenValue(t.getCurrentTokenValue),s=this.addTransactionId(t.transactionId,{cmd:"getCurrentTokenValueResponse",ver:"1.0",token:{id:t.getCurrentTokenValue,value:e}});this.logger.debug(s,!0),this.broadcastToView(s)}else this.logger.warn("Id not provided for cmd: "+e)}getLevelUpdate(e,t){const s=this.ngxComm.getCurrentLevelUpdate(),r=this.addTransactionId(t.transactionId,{cmd:"getLevelUpdateResponse",ver:"1.0",levelUpdate:s});this.logger.debug(r,!0),this.broadcastToView(r)}getPatronData(e,t){const s=this.ngxComm.getCurrentPatronData(),r=this.addTransactionId(t.transactionId,{cmd:"getPatronDataResponse",ver:"1.0",patronData:s});this.logger.debug(r,!0),this.broadcastToView(r)}getPatronDataExt(e,t){const s=this.ngxComm.getCurrentPatronDataExt(),r=this.addTransactionId(t.transactionId,{cmd:"getPatronDataExtResponse",ver:"1.0",patronDataExt:s});this.logger.debug(r,!0),this.broadcastToView(r)}getCardlessStatus(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getCardlessStatusResp",ver:"1.0",cardlessStatus:{}});a.cardlessStatus=this.cardlessService.getCardlessStatus(),this.logger.debug({debug:"Sending getCardlessStatus response to content",data:a}),this.sendMessage(r,a)}getCardlessStatusHistory(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getCardlessStatusHistoryResp",ver:"1.0",cardlessStatusHistory:[]});a.cardlessStatusHistory=this.cardlessService.getCardlessStatusHistory(),this.logger.debug({debug:"Sending getCardlessStatusHistory response to content",data:a}),this.sendMessage(r,a)}showWindow(e,t,s){var a=this;return c((function*(){const t=r.default.createShowHost(s);(yield a.validMessage(t,e))&&a.ngxComm.sendMessage(t)}))()}getServerAddresses(e,t,s){var a=this;return c((function*(){const t=r.default.createGetServerAddresses(s);(yield a.validMessage(t,e))&&a.ngxComm.sendMessage(t)}))()}forceCardOut(e){var t=this;return c((function*(){const s=r.default.createForceCardOut();(yield t.validMessage(s,e))&&t.ngxComm.sendMessage(s)}))()}disableAutoHide(e,t,s){this.setPropSubAndSend("disableAutoHide",s);const r=this.addTransactionId(t.transactionId,{cmd:"disableAutoHideResp",ver:"1.0"});this.broadcastToView(r)}gameStartSubscribe(){this.setPropSubAndSend("gameStart",!0)}getGameStart(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getGameStartResp",ver:"1.0",gameStart:{}});a.gameStart=this.ngxComm.getCurrentGameStart().gameStart,this.logger.debug({debug:"Sending getGameStart response to content",data:a}),this.sendMessage(r,a)}gameEndSubscribe(){this.setPropSubAndSend("gameEnd",!0)}gameEventSubscribe(e,t){this.addIdsToSubAndSend("gameEvent",t.value)}getGameEnd(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getGameEndResp",ver:"1.0",gameEnd:{}});a.gameEnd=this.ngxComm.getCurrentGameEnd().gameEnd,this.logger.debug({debug:"Sending getGameEnd response to content",data:a}),this.sendMessage(r,a)}getBonusLevel(e,t){const s=t.transactionId,a=[[this.enumBE2Func.PT_GetPlayerLevel,[0,0,0,0]]],n=r.default.createBE2BasicFunctionArr(a);this.ngxComm.sendBe2Message(n,(e,t)=>{e?this.logger.error({error:"viewListener: Received an error in getBonusLevel.",data:e},!0):t[r.default.BE2_BASIC_RESPONSE].forEach(e=>{if(e.functionCode===this.enumBE2Func.PT_GetPlayerLevel){const t=this.addTransactionId(s,{cmd:"getBonusLevelResp",ver:"1.0",level:e.retvals[0]});this.broadcastToView(t)}},this)})}valueToPoints(e,t){const s=t.transactionId,a=[[this.enumBE2Func.ValueToPoints,[t.cents,0,0,0]]],n=r.default.createBE2BasicFunctionArr(a);this.ngxComm.sendBe2Message(n,(e,t)=>{e?this.logger.error({error:"viewListener: Received an error in valueToPoints.",data:e},!0):t[r.default.BE2_BASIC_RESPONSE].forEach(e=>{if(e.functionCode===this.enumBE2Func.ValueToPoints){const t=this.addTransactionId(s,{cmd:"valueToPointsResp",ver:"1.0",cents:e.retvals[0],points:e.retvals[1]});this.broadcastToView(t)}},this)})}disableMatchPlay(e,t){const s=[[this.enumBE2Func.MP_Toggle,[0,0,0,0]]],a=r.default.createBE2BasicFunctionArr(s);this.ngxComm.sendBe2Message(a,e=>{if(e){this.logger.error({error:"viewListener: Received an error in disableMatchPlay.",data:e},!0);const s=this.addTransactionId(t.transactionId,{cmd:"disableMatchPlayResp",ver:"1.0",status:1});this.broadcastToView(s)}else{const e=this.addTransactionId(t.transactionId,{cmd:"disableMatchPlayResp",ver:"1.0",status:0});this.broadcastToView(e)}})}getUrlParams(e,t){const s=this.addTransactionId(t.transactionId,{cmd:"getUrlParamsResp",ver:"1.0",data:this.urlParams});this.broadcastToView(s)}analytics_event(e,t,s){this.logger.info({analyticsReportingType:e,analyticsReportingData:s},!0)}analytics_view(e,t,s){this.logger.info({analyticsReportingType:e,analyticsReportingData:s},!0)}analytics_exception(e,t,s){this.logger.error({analyticsReportingType:e,analyticsReportingData:s},!0)}log_debug(e,t,s){this.logger.debug(s,!0)}log_info(e,t,s){this.logger.info(s,!0)}log_warn(e,t,s){this.logger.warn(s,!0)}log_error(e,t,s){this.logger.error(s,!0)}getLogLevel(e,t,s,r){let a=this.logger.logSeverity;0===this.logger.logSeverity&&(a=1);const n={cmd:"setLogLevel",ver:"1.0",logLevel:a};this.sendMessage(r,n)}getTokenHistory(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getTokenHistoryResp",ver:"1.0",value:this.contentCache.getTokens()});this.logger.debug({info:"Sending getTokenHistory response to content",data:a},!1),this.sendMessage(r,a)}getTriggerHistory(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getTriggerHistoryResp",ver:"1.0",value:this.contentCache.getTriggers()});this.logger.debug({info:"Sending getTriggerHistory response to content",data:a},!1),this.sendMessage(r,a)}requestSendTokens(){const e=this.contentCache.getTokens();this.logger.debug({info:"Sending cached tokens to content for DOM rendering"},!1);for(let t=0;t<e.length;t++)this.broadcastToView(r.default.createTokenUpdate(e[t].id,e[t].value))}requestSendTriggers(){const e=this.contentCache.getTriggers();this.logger.debug({info:"Sending cached screenTriggers to content for DOM rendering"},!1);for(let t=0;t<e.length;t++)this.broadcastToView(r.default.createScreenTrigger(e[t].id,e[t].value,e[t].messageTokens))}getAllHistory(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getAllHistoryResp",ver:"1.0",value:this.contentCache.getAll()});this.logger.debug({info:"Sending getAllHistory response to content",data:a},!1),this.sendMessage(r,a)}getStateElement(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getStateElementResp",ver:"1.0",value:this.contentCache.getStateElement(t.value)});this.logger.debug({info:"Sending getStateElement response to content",data:a},!1),this.sendMessage(r,a)}getAllStateElements(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getAllStateElementsResp",ver:"1.0",value:this.contentCache.getContentState()});this.logger.debug({info:"Sending getAllStateElements response to content",data:a},!1),this.sendMessage(r,a)}setStateElement(e,t,s,r){this.contentCache.storeStateElement(t.key,t.value,t.timeout).then(e=>{const s=this.addTransactionId(t.transactionId,{cmd:"setStateElementResp",ver:"1.0",value:e});this.logger.debug({info:"Sending setStateElement response to content",data:s},!1),this.sendMessage(r,s)})}deleteStateElement(e,t,s,r){this.contentCache.deleteStateElement(t.value).then(e=>{const s=this.addTransactionId(t.transactionId,{cmd:"deleteStateElementResp",ver:"1.0",value:e});this.logger.debug({info:"Sending deleteStateElement response to content",data:s},!1),this.sendMessage(r,s)})}clearAllStateElements(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"clearAllStateElementsResp",ver:"1.0",value:this.contentCache.clearContentState()});this.logger.debug({info:"Sending clearAllStateElements response to content",data:a},!1),this.sendMessage(r,a)}getStatusMessages(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getStatusMessagesResp",ver:"1.0",value:this.statusMessageCache.getStatusMessages()});this.sendMessage(r,a)}isBe2Error(e){return!!e&&(this.logger.error({error:"viewListener: error while trying to set auto play status.",data:e},!0),!0)}getBe2Resp(e){const t=e[r.default.BE2_BASIC_RESPONSE];return 0===t.length?(this.logger.error({error:"Viewlistener: No BE2 responses.",data:e}),[]):t}setAutoplay(e,t,s,a){if(void 0===t.enabled)return void this.logger.error({error:"viewListener: unable to set auto play, enabled property is undefined.",data:t});const n=!0===t.enabled?1:0,i=[[this.enumBE2Func.MENU_SetAutoPlayStatus,[n,0,0,0]]],o=r.default.createBE2BasicFunctionArr(i),l=this.addTransactionId(t.transactionId,{cmd:"setAutoplayResp",ver:"1.0",enabled:null});this.ngxComm.sendBe2Message(o,(e,t)=>{this.isBe2Error(e)||(this.getBe2Resp(t).forEach(e=>{e.functionCode===this.enumBE2Func.MENU_SetAutoPlayStatus?l.enabled=1===e.retvals[0]:this.logger.warn({warn:"Unknown BE2Response!",data:""})},this),this.logger.debug({debug:"Sending setAutoplay response to content",data:l}),this.sendMessage(a,l))})}getAutoplayStatus(e,{checkEGMState:t=!0,transactionId:s},a,n){const i=!0===t?1:0,o=[[this.enumBE2Func.MENU_GetAutoPlayStatus,[i,0,0,0]]],l=r.default.createBE2BasicFunctionArr(o),u=this.addTransactionId(s,{cmd:"getAutoplayStatusResp",ver:"1.0",status:null});this.ngxComm.sendBe2Message(l,(e,t)=>{this.isBe2Error(e)||(this.getBe2Resp(t).forEach(e=>{e.functionCode===this.enumBE2Func.MENU_GetAutoPlayStatus?u.status=1===e.retvals[0]:this.logger.warn({warn:"Unknown BE2Response!",data:""})},this),this.logger.debug({debug:"Sending getAutoplayStatus response to content",data:u}),this.sendMessage(n,u))})}setBonusLight(e,t,s,a){if(void 0===t.enabled)return void this.logger.error({error:"viewListener: unable to set bonus light, enabled property is undefined.",data:t});const n=!0===t.enabled?1:0,i=[[this.enumBE2Func.MP_SetBonusLight,[n,0,0,0]]],o=r.default.createBE2BasicFunctionArr(i),l=this.addTransactionId(t.transactionId,{cmd:"setBonusLightResp",ver:"1.0",enabled:null});this.ngxComm.sendBe2Message(o,(e,t)=>{this.isBe2Error(e)||(this.getBe2Resp(t).forEach(e=>{e.functionCode===this.enumBE2Func.MP_SetBonusLight?l.enabled=1===e.retvals[0]:this.logger.warn({warn:"Unknown BE2Response!",data:""})},this),this.logger.debug({debug:"Sending setBonusLight response to content",data:l}),this.sendMessage(a,l))})}playTone(e,t,s,a){if("number"!=typeof t.tone)return void this.logger.error({error:"viewListener: unable to play tone, tone should be a number.",data:t});const n=[[this.enumBE2Func.MISC_ToneABI,[t.tone,0,0,0]]],i=r.default.createBE2BasicFunctionArr(n),o=this.addTransactionId(t.transactionId,{cmd:"playToneResp",ver:"1.0",tone:null});this.ngxComm.sendBe2Message(i,(e,t)=>{this.isBe2Error(e)||(this.getBe2Resp(t).forEach(e=>{e.functionCode===this.enumBE2Func.MISC_ToneABI?o.tone=e.retvals[0]:this.logger.warn({warn:"Unknown BE2Response!",data:""})},this),this.logger.debug({debug:"Sending playTone response to content",data:o}),this.sendMessage(a,o))})}setBezel(e,t,s,a){if("number"!=typeof t.color)return void this.logger.error({error:"viewListener: unable to set bezel, color should be a number.",data:t});if("number"!=typeof t.flash)return void this.logger.error({error:"viewListener: unable to set bezel, flash should be a number.",data:t});const n=[[this.enumBE2Func.MISC_BezelColor,[t.color,t.flash,0,0]]],i=r.default.createBE2BasicFunctionArr(n),o=this.addTransactionId(t.transactionId,{cmd:"setBezelResp",ver:"1.0",color:null,flash:null});this.ngxComm.sendBe2Message(i,(e,t)=>{this.isBe2Error(e)||(this.getBe2Resp(t).forEach(e=>{e.functionCode===this.enumBE2Func.MISC_BezelColor?(o.color=e.retvals[0],o.flash=e.retvals[1]):this.logger.warn({warn:"Unknown BE2Response!",data:""})},this),this.logger.debug({debug:"Sending setBezel response to content",data:o}),this.sendMessage(a,o))})}payToCreditEnableEGM(e,t,s,a){const n=[[this.enumBE2Func.PayToCreditEnableEgm,[0,0,0,0]]],i=r.default.createBE2BasicFunctionArr(n),o=this.addTransactionId(t.transactionId,{cmd:"payToCreditEnableEGMResp",ver:"1.0"});this.ngxComm.sendBe2Message(i,(e,t)=>{this.isBe2Error(e)||this.getBe2Resp(t).forEach(e=>{e.functionCode!==this.enumBE2Func.PayToCreditEnableEgm?this.logger.warn({warn:"Unknown BE2Response!",data:""}):(this.logger.debug({debug:"Sending payToCreditEnableEGM response to content",data:o}),this.sendMessage(a,o))},this)})}isPINLocked(e,t,s,a){const n=t.transactionId,i=[[this.enumBE2Func.Cashless_IsPinLocked,[0,0,0,0]]],o=r.default.createBE2BasicFunctionArr(i);this.ngxComm.sendBe2Message(o,(e,t)=>{e?this.logger.error({error:"viewListener: Received an error in isPINLocked.",data:e},!0):t[r.default.BE2_BASIC_RESPONSE].forEach(e=>{if(e.functionCode!==this.enumBE2Func.Cashless_IsPinLocked)this.logger.warn({warn:"Unknown BE2Response!",data:""});else{const t=this.addTransactionId(n,{cmd:"isPINLockedResp",ver:"1.0",locked:Boolean(e.retvals[0])});this.logger.debug({debug:"viewListener: Sending Cashless_IsPinLockedResp.",data:t},!0),this.sendMessage(a,t)}},this)})}lockPIN(){const e=[[this.enumBE2Func.LockPin,[0,0,0,0]]],t=r.default.createBE2BasicFunctionArr(e);this.ngxComm.sendBe2Message(t,(e,t)=>{e?this.logger.error({error:"viewListener: Received an error in LockPin.",data:e},!0):this.logger.debug({debug:"viewListener: Received BE2 response for LockPin.",data:t},!0)})}patronCardUnlock(e,t,s,a){const n=t.transactionId,i=[[this.enumBE2Func.LOLSCH_PatronRequestUnlock,[0,0,0,0]]],o=r.default.createBE2BasicFunctionArr(i);this.ngxComm.sendBe2Message(o,(e,t)=>{e?this.logger.error({error:"viewListener: Received an error in patronCardUnlock.",data:e},!0):t[r.default.BE2_BASIC_RESPONSE].forEach(e=>{if(e.functionCode!==this.enumBE2Func.LOLSCH_PatronRequestUnlock)this.logger.warn({warn:"Unknown BE2Response!",data:""});else{const t=this.addTransactionId(n,{cmd:"patronCardUnlockResp",ver:"1.0",status:e.retvals[0]});this.logger.debug({debug:"Sending patronCardUnlock response to content",data:t}),this.sendMessage(a,t)}},this)})}attendantCardUnlock(e,t){const s=parseInt(t.unlockCode,10),a=t.unlockCode.toString().length,n=[[this.enumBE2Func.Cashless_ForceUnlock,[s,a,0,0]]],i=r.default.createBE2BasicFunctionArr(n);this.ngxComm.sendBe2Message(i,(e,t)=>{e?this.logger.error({error:"viewListener: Received an error in Cashless_ForceUnlock.",data:e},!0):this.logger.debug({debug:"viewListener: Received BE2 response for Cashless_ForceUnlock.",data:t},!0)})}getPinSessionToken(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getPinSessionTokenResp",ver:"1.0",token:this.sessionService.accessTokenPIN});this.logger.debug({debug:"Sending getPinSessionToken response to content",data:a}),this.sendMessage(r,a)}getLanguage(e,t,s,r){const{languageUpdate:a={}}=this.ngxComm.getCurrentLanguageUpdate(),{languageIndex:n=1,languageName:i="Primary"}=a,o=this.addTransactionId(t.transactionId,{cmd:"getLanguageResp",ver:"1.0",language:{languageIndex:n,languageName:i}});this.logger.debug({debug:"Sending getLanguage response to content",data:o}),this.sendMessage(r,o)}getUserTokens(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getUserTokensResp",ver:"1.0",userTokenUpdate:[]});t.userTokens.forEach((function(e){a.userTokenUpdate.push({id:e,value:this.ngxComm.getCurrentUserTokenValue(e)})}),this),this.logger.debug({debug:"Sending getUserTokens response to content",data:a}),this.sendMessage(r,a)}getFullscreenState(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getFullscreenStateResp",ver:"1.0",fullscreenState:this.shellCache.getShellStateElement("fullscreenState")});this.logger.debug({debug:"Sending getFullscreenState response to content",data:a}),this.sendMessage(r,a)}getIsmUpdate(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getIsmUpdateResp",ver:"1.0",ismUpdate:{}});a.ismUpdate=this.ngxComm.getCurrentIsmUpdateData().ismUpdate,this.logger.debug({debug:"Sending getIsmUpdate response to content",data:a}),this.sendMessage(r,a)}getDrawStatus(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getDrawStatusResp",ver:"1.0",drawStatus:{}});a.drawStatus=this.ngxComm.getCurrentDrawStatus().drawStatus,this.logger.debug({debug:"Sending getDrawStatus response to content",data:a}),this.sendMessage(r,a)}getBonusHit(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"getBonusHitResp",ver:"1.0",bonusHit:{}});a.bonusHit=this.ngxComm.getCurrentBonusHit().bonusHit,this.logger.debug({debug:"Sending getBonusHit response to content",data:a}),this.sendMessage(r,a)}w2gInit(e,t,s,r){this.w2gAccrualService.getSpecifics().then(e=>{const s=this.addTransactionId(t.transactionId,{cmd:"w2gInitResp",ver:"1.0"});Object.keys(e).forEach(t=>{s[t]=e[t]}),this.logger.debug({debug:"Sending w2gInit response to content",data:s}),this.sendMessage(r,s)}).catch(e=>{this.logger.error({error:"viewListener: Received an error in w2gInit.",data:e.message},!0)})}w2grequestAttendant(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"w2grequestAttendantResp",ver:"1.0"});this.w2gAccrualService.requestAttendant(t.handpayAmount).then(e=>{Object.keys(e).forEach(t=>{a[t]=e[t]})}).catch(e=>{a.error=!0,this.logger.error({error:"viewListener: Received an error in w2grequestAttendant.",data:e.message},!0)}).then(()=>{this.logger.debug({debug:"Sending w2grequestAttendant response to content",data:a}),this.sendMessage(r,a)})}w2gresetToCreditMeter(e,t,s,r){const a=this.addTransactionId(t.transactionId,{cmd:"w2gresetToCreditMeterResp",ver:"1.0"});this.w2gAccrualService.resetToCreditMeter(t.handPayAmount,t.creditHandPayAmount,t.witnessInitiated,t.pinValidated).then(e=>{Object.keys(e).forEach(t=>{a[t]=e[t]})}).catch(e=>{a.success=!1,this.logger.error({error:"viewListener: Received an error in w2gresetToCreditMeter.",data:e.message},!0)}).then(()=>{this.logger.debug({debug:"Sending w2gresetToCreditMeter response to content",data:a}),this.sendMessage(r,a)})}w2gsetAttendantReturn(e,t,s,r){this.w2gAccrualService.setAttendantReturn().then(e=>{const s=this.addTransactionId(t.transactionId,{cmd:"w2gsetAttendantReturnResp",ver:"1.0",success:e.success});this.logger.debug({debug:"Sending w2gsetAttendantReturnResp response to content",data:s}),this.sendMessage(r,s)}).catch(e=>{this.logger.error({error:"viewListener: Received an error in w2gsetAttendantReturn.",data:e.message},!0)})}w2gvalidateWitness(e,t,s,r){this.w2gAccrualService.validateWitness().then(e=>{const s=this.addTransactionId(t.transactionId,{cmd:"w2gvalidateWitnessResp",ver:"1.0",success:e.success});this.logger.debug({debug:"Sending w2gvalidateWitnessResp response to content",data:s}),this.sendMessage(r,s)}).catch(e=>{this.logger.error({error:"viewListener: Received an error in w2gvalidateWitness",data:e.message},!0)})}w2gisWitnessRequired(e,t,s,r){this.w2gAccrualService.isWitnessRequired().then(e=>{const s=this.addTransactionId(t.transactionId,{cmd:"w2gisWitnessRequiredResp",ver:"1.0",required:e.required});this.logger.debug({debug:"Sending w2gisWitnessRequiredResp response to content",data:s}),this.sendMessage(r,s)}).catch(e=>{this.logger.error({error:"viewListener: Received an error in w2gisWitnessRequiredResp",data:e.message},!0)})}w2ggotoLegacyRequest(e,t,s,r){this.w2gAccrualService.gotoLegacy().then(e=>{const s=this.addTransactionId(t.transactionId,{cmd:"w2ggotoLegacyResp",ver:"1.0"});this.logger.debug({debug:"Sending w2ggotoLegacyResp response to content",data:s}),this.sendMessage(r,s)}).catch(e=>{this.logger.error({error:"viewListener: Received an error in w2ggotoLegacyRequest",data:e.message},!0)})}w2gCancelRequest(e,t,s,r){this.w2gAccrualService.cancelw2g().then(e=>{const s=this.addTransactionId(t.transactionId,{cmd:"w2gCancelResp",ver:"1.0"});this.logger.debug({debug:"Sending w2gCancelResp response to content",data:s}),this.sendMessage(r,s)}).catch(e=>{this.logger.error({error:"viewListener: Received an error in w2gCancelRequest",data:e.message},!0)})}loadContent(e,t,s,r){var a=this;return c((function*(){let e=!0;try{yield a.loadUrl(t.url),a.logger.debug({info:"viewListener: Loaded content url: ",data:t.url},!1)}catch(t){e=!1,a.logger.error({error:"viewListener: error loading content url: ",data:t},!0)}a.sendMessage(r,a.addTransactionId(t.transactionId,{cmd:"loadContentResp",ver:"1.0",success:e}))}))()}notifyActiveWindow(){let e=document.getElementById("WrapperFrame");e.addEventListener("load",()=>{try{e.contentWindow.document.body&&(e.contentWindow.document.body.onclick=()=>{this.buttonPress(void 0,void 0,"TOUCHSCREEN").catch(e=>{this.logger.error({error:"There was an error sending the TOUCHSCREEN buttonPress.",data:e},!0)})})}catch(e){this.logger.debug({info:"viewListener: Wrapper Load listener error: ",data:e},!1)}})}receiveMessage(e){const t=t=>{const s=t.data,r=s.cmd?s.cmd:null,a=void 0===s.value?null:s.value;this.callCmd(r,s,a,e.source)};e.data?t(e):e.detail&&e.detail.data?t(e.detail):this.logger.warn("view listener - event data is undefined")}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(s(3));t.default=class{constructor(e,t,s){this._config=(e=>{if("string"!=typeof e.auth)throw"Auth path must be defined";if("string"!=typeof e.invalidate)throw"Invalidate path must be defined";return"number"!=typeof e.retries&&(e.retries=3),"number"!=typeof e.retryDelay&&(e.retryDelay=1e3),JSON.parse(JSON.stringify(e))})(e),this._logger=t,this._accessTokenPIN=null,this._configured=!0,this._logger.debug({debug:"SessionService configuration",data:this._config}),"string"!=typeof this._config.endpoint?(this._logger.debug("SessionService - config endpoint is not defined, will not attempt to make sessions"),this._configured=!1):(s.registerScreenTrigger(r.default.ABANDONED_CARD_SCREEN,this.deletePINSession.bind(this)),s.registerScreenTrigger(r.default.VPC_ABANDONDED_CARD_SCREEN,this.deletePINSession.bind(this)),s.registerScreenTrigger(r.default.VPC_IDLE_SCREEN,this.deletePINSession.bind(this)),s.registerScreenTrigger(r.default.IDLE_SCREEN,this.deletePINSession.bind(this)))}get accessTokenPIN(){return this._accessTokenPIN}createPINSession(e){if(!this._configured)return Promise.reject("SessionService is not configured");if("string"!=typeof e||e.length<1)return Promise.reject("create PIN session requires an identity");if(null!==this._accessTokenPIN)return Promise.resolve(this._accessTokenPIN);const t=Date.now(),s=this._config.retries,r=JSON.stringify({username:e,password:"password"}),a=new Headers,n=`${this._config.endpoint}${this._config.auth}`;a.append("Content-Type","application/json"),a.append("Cache-Control","no-cache");const i={headers:a,mode:"cors",method:"POST",body:r};let o=0;return this._logger.debug({msg:`SessionService createPINSession calling ${i.method} on ${n}`}),new Promise((e,r)=>{const a=()=>{o+=1,fetch(n,i).then(n=>{n.json().then(i=>{const l=Date.now()-t;switch(n.status){case 200:this._createPINSessionSuccess(e,i,l,n.status);break;case 400:case 401:case 404:this._createPINSessionError(r,i,l,n.status);break;case 500:default:o<=s?setTimeout(()=>{a()},this._config.retryDelay):this._createPINSessionError(r,i,l,n.status,o)}})}).catch(e=>{o<=s?setTimeout(()=>{a()},this._config.retryDelay):this._createPINSessionError(r,e,Date.now()-t,null,o)})};a()})}deletePINSession(){if(!this._accessTokenPIN)return;const e=Date.now(),t=this._config.retries,s=this._config.retryDelay,r=this._logger,a=new Headers,n=`${this._config.endpoint}${this._config.invalidate}`;a.append("Authorization",`Bearer ${this._accessTokenPIN.access_token}`),this._accessTokenPIN=null;const i={headers:a,mode:"cors",method:"DELETE"};let o=0;this._logger.debug({msg:`SessionService deletePINSession calling ${i.method} on ${n}`});const l=()=>{o+=1,fetch(n,i).then(a=>{const n=Date.now()-e;switch(a.status){case 204:const e={msg:`SessionService deletePINSession success duration:${n} - attempts:${o} - status:${a.status}`};n>1e3?r.warn(e):r.debug(e);break;case 401:a.json().then(e=>{r.error({msg:`SessionService deletePINSession error - duration:${n} - attempts:${o} - status:${a.status}`,data:e})});break;default:o<=t?setTimeout(()=>{l()},s):a.json().then(e=>{r.error({msg:`SessionService deletePINSession error - duration:${n} - attempts:${o} - status:${a.status}`,data:e})})}}).catch(a=>{if(o<=t)setTimeout(()=>{l()},s);else{const t=Date.now()-e;r.error({msg:`SessionService deletePINSession error - duration:${t} - attempts:${o} - status:null`,data:a})}})};l()}cleanup(){this._config=null,this._logger=null,this._accessTokenPIN=null}_createPINSessionSuccess(e,t,s,r=null,a=1){const n={msg:`SessionService createPINSession success duration:${s} - attempts:${a} - status:${r}`};s>1e3?this._logger.warn(n):this._logger.debug(n),this._accessTokenPIN=t,e(this._accessTokenPIN)}_createPINSessionError(e,t,s,r=null,a=1){this._logger.error({msg:`SessionService createPINSession error - duration:${s} - attempts:${a} - status:${r}`,data:t}),e(t)}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=n(s(1)),a=n(s(3));function n(e){return e&&e.__esModule?e:{default:e}}const i="w2g",o=r.default.enumBE2BasicFunc,l=r.default.createBE2BasicFunctionArr,u={override:o.OverrideW2GAccrualScreen,init:o.FJP_Init,operation:o.FJP_Op,getHandpayParams:o.FJP_GetCurrentHandpayParams,isWitnessRequired:o.FJP_IsJPWitnessRequired,event:o.FJP_Event,cardType:o.PIN_GetCardType},c=2,d=4,h=5,p=6,g=7,f=0,_=2,E=10,S=14,C=15,m=16,A=17,P=0,b=1,I=3,T=8,v=Error("No BE2 Response"),y=Error("Unknown BE2Response!"),R=Error("W2G Accrual Service is not enabled.");let N=2e3,O=!0,L=-1,B=-1,D=0,M=0,x="-1";const U=function(e,t){return new Promise((s,a)=>{t.sendBe2Message(e,(e,t)=>{if(e)a(e);else{const e=t[r.default.BE2_BASIC_RESPONSE];0===e.length?a(v):s(e)}})})},w=function(e){return new Promise((t,s)=>{let a=0;const n=l([[u.operation,[0,A,0,0]]]),i=()=>{e.sendBe2Message(n,(e,n)=>{if(++a>=15)s(new Error("W2GAccrualService: initiateHandpayResetCycle response timeout"));else if(e)s(e);else{const e=n[r.default.BE2_BASIC_RESPONSE];0===e.length&&s(v),e.forEach((function(e){e.functionCode===u.operation?255!==e.retvals[2]?t({success:!0,handpayResetCode:e.retvals[2]}):setTimeout(()=>i(),N):s(y)}))}})};i()})},k=function(e,t,s,r,a){return new Promise((n,i)=>{const o=l([[u.event,[e,t,s,r]]]);U(o,a).then(e=>{e.forEach((function(e){e.functionCode!==u.event&&i(y),n(e.retvals)}))}).catch(e=>i(e))})};t.default=class{constructor(e,t,s,r,n){this._ngxComm=e,this._logger=t,this._config=s,this._m5Config=n,this._appStore=r,N=this._config.resetTimeout,O="boolean"!=typeof this._config.enabled||this._config.enabled,this._waitForCardTypeInterval=this._config.waitForCardTypeInterval,this._sentW2GOverride=!1;const o=()=>{this._appStore.setJackpotInProgressStatus(!1),this._sentW2GOverride||(this._sentW2GOverride=!0,c())},l=()=>{this._sentW2GOverride=!1,this._appStore.setJackpotInProgressStatus(!1),this.cleanup()},u=e=>{this._appStore.setJackpotInProgressStatus(!0),t.debug("W2GAccrualService: Received W2G Accrual screen trigger for Txn Id : "+e,null,i)},c=()=>{this.cleanup(),this.overrideW2GAccrual(1).then(()=>{t.debug("W2GAccrualService: OverrideW2GAccrualScreen Success at screen trigger.",null,i)}).catch(e=>{t.error({error:"W2GAccrualService: Received an error while trying to override W2G Accrual menu at screen trigger.",data:e.message},null,i)})};O&&(this._ngxComm.registerScreenTrigger(a.default.SESSION_SCREEN,()=>o()),this._ngxComm.registerScreenTrigger(a.default.XTRA_CREDIT_SESSION_SCREEN,()=>o()),this._ngxComm.registerScreenTrigger(a.default.W2G_ACCRUAL_SCREEN,({detail:{screenTrigger:e}})=>{if(this.resetW2GTxnId(),e&&e.displayMessage&&e.displayMessage.length>1){let t=e.displayMessage;this.setW2GTxnId(t),u(t)}else t.error({error:"W2GAccrualService: Txn Id is missing in W2G Screen Trigger from Adv",data:e},null,i)}),this._ngxComm.registerScreenTrigger(a.default.IDLE_SCREEN,()=>l()),c())}setW2GTxnId(e){this._logger.debug("W2GAccrualService: setW2GTxnId - updated W2G Txn Id from  "+x+" to "+e,null,i),x=e}getW2GTxnId(){return x}resetW2GTxnId(){this._logger.debug("W2GAccrualService: resetW2GTxnId - reset W2G Txn Id from  "+x+" to -1",null,i),x="-1"}overrideW2GAccrual(e=1){return O?new Promise((t,s)=>{const r=l([[u.override,[e,0,0,0]]]);U(r,this._ngxComm).then(e=>{e.forEach((function(e){if(e.functionCode!==u.override)return s(y)})),t()}).catch(e=>s(e))}):Promise.reject(R)}getSpecifics(){return this._logger.debug("W2GAccrualService: W2G getSpecifics requested from content.",null,i),D=0,O?new Promise((e,t)=>{B=setInterval(()=>{this.overrideW2GAccrual(1).then(()=>{this._logger.debug("W2GAccrualService: OverrideW2GAccrualScreen Success to extend timer.",null,i)}).catch(e=>{this._logger.error({error:"W2GAccrualService: Received an error while trying to override W2G Accrual to extend timer.",data:e.message},null,i)})},15e3);const s=l([[u.init,[0,0,0,0]],[u.operation,[0,S,0,0]],[u.getHandpayParams,[0,0,0,0]]]);U(s,this._ngxComm).then(s=>{const r={};r.w2gTransactionId=x,s.forEach((function(e){switch(e.functionCode){case u.init:break;case u.operation:r.selfServeOption=e.retvals[0],r.keytoCreditAvailable=1===e.retvals[2];break;case u.getHandpayParams:r.handpayType=e.retvals[0],M=r.handpayType,r.amountInCredits=e.retvals[1],r.amountInCents=e.retvals[2],r.w2gStatus=e.retvals[3];break;default:return t(y)}})),e(r)}).catch(e=>t(e))}):Promise.reject(R)}requestAttendant(e){return this._logger.debug("W2GAccrualService: requestAttendant called from content for Hanpday Amount "+e,null,i),O?new Promise((t,s)=>{(e=>new Promise((t,s)=>{const r=l([[u.operation,[0,C,0,0]]]);U(r,e).then(e=>{const r={};e.forEach((function(e){e.functionCode===u.operation?r.success=0===e.retvals[0]:s(y)})),t(r)}).catch(e=>s(e))}))(this._ngxComm).then(e=>{if(this._logger.debug({debug:"W2GAccrualService: call attendant result",data:e},null,i),e.success)return((e,t,s)=>new Promise((r,a)=>{const n=()=>{(e=>new Promise((t,s)=>{const r=l([[u.cardType,[0,0,0,0]]]);U(r,e).then(e=>{e.forEach((function(e){e.functionCode===u.cardType?t({cardType:e.retvals[0]}):s(y)}))}).catch(e=>s(e))}))(s).then(s=>{-1!==e.indexOf(s.cardType)?(clearTimeout(L),r()):L=setTimeout(n,t)}).catch(e=>{clearTimeout(L),a(e)})};n()}))([h,p,g],this._waitForCardTypeInterval,this._ngxComm);s(new Error("W2GAccrualService: failed to call attendant"))}).then(r=>{this._logger.debug({debug:"W2GAccrualService: wait for card type attendant result",data:r},null,i),this._m5Config.w2g&&this._m5Config.w2g.jackpotLimitsCheck?((e,t)=>new Promise((s,r)=>{const a=l([[u.operation,[0,E,t,0]]]);U(a,e).then(e=>{const t={};e.forEach((function(e){e.functionCode===u.operation?t.success=e.retvals[0]:r(y)})),s(t)}).catch(e=>r(e))}))(this._ngxComm,e).then(e=>{e&&e.hasOwnProperty("success")&&(0===e.success?t({success:!0}):t({success:!1})),s(new Error("W2GAccrualService: failed to check Attendant Authroization Limits"))}):t({success:!0})}).catch(e=>s(e))}):Promise.reject(R)}resetToCreditMeter(e,t,s,r=!1){let a=0;return this._logger.debug("W2GAccrualService: resetToCreditMeter requested from content for amount : "+e+" witnessInitiated "+s+" pinValidated "+r+" Txn Id :"+x,null,i),O?(D+=r?D|c|d:D|d,new Promise((r,n)=>{let o="";M===P||M===b||M===I?(a=t,o="credits"):(a=e,o="cents"),this._logger.debug("W2GAccrualService: 1st publishFJPEvent hp_type : "+M+" - fjp_param : "+D+" - for amount : "+a+" - in : "+o,null,i),k(a,M,0,D,this._ngxComm).then(e=>{if(0!==e[2])return n(new Error(`W2GAccrualService: FJPEvent Expected return value 0 for event , received ${e[2]}`))}).then(()=>{if(s)return this._logger.debug("W2GAccrualService: 2nd publishFJPEvent with KP_EVENT_WITNESS for amount : "+a,null,i),k(a,T,0,0,this._ngxComm)}).then(()=>{this._logger.debug("W2GAccrualService: resetToCreditMeter with OP RESET_HANDPAY_TO_CREDIT_METER called for amount : "+a,null,i),"-1"===x&&this._logger.error({error:"W2GAccrualService: resetToCreditMeter - Invalid Txn Id",data:x},null,i);const e=parseInt(x,16);return this._logger.debug("W2GAccrualService: resetToCreditMeter w2g_txnId : "+x+" binaryTxnId : "+e,null,i),function(e,t){return new Promise((s,r)=>{const a=l([[u.operation,[0,m,t,0]]]);U(a,e).then(e=>{e.forEach((function(e){e.functionCode!==u.operation&&r(y),s(e.retvals)}))}).catch(e=>r(e))})}(this._ngxComm,e)}).then(()=>(this._logger.debug("W2GAccrualService: initiateHandpayResetCycle with op GET_REMOTE_HANDPAY_RESETCODE called for amount : "+a,null,i),w(this._ngxComm))).then(e=>{this.resetW2GTxnId(),this.cleanup(),this._logger.debug("W2GAccrualService: W2G Keyoff successfully completed for amount : "+a+" Txn Id :"+x,null,i),r({success:!0,handPayAmount:a,handpayResetCode:e.handpayResetCode})}).catch(e=>{this._logger.error({error:"W2GAccrualService: Received an error while trying to process resetToCreditMeter",data:e.message},null,i),this.cleanup(),this.overrideW2GAccrual(0).then(()=>{this._logger.debug("W2GAccrualService: OverrideW2GAccrualScreen Canceled at reset to credit meter.",null,i)}).catch(e=>{this._logger.error({error:"W2GAccrualService: Received an error while trying to cancel Override W2G Accrual menu at reset to credit meter.",data:e.message},null,i)}),n(e)})})):Promise.reject(R)}setAttendantReturn(){return this._logger.debug("W2GAccrualService: setAttendantReturn called",null,i),O?new Promise((e,t)=>{const s=l([[u.operation,[0,f,0,0]]]);U(s,this._ngxComm).then(s=>{const r={};s.forEach((function(e){if(e.functionCode!==u.operation)return t(y);r.success=0===e.retvals[0]})),e(r)}).catch(e=>t(e))}):Promise.reject(R)}validateWitness(){return this._logger.debug("W2GAccrualService: validateWitness called",null,i),O?new Promise((e,t)=>{const s=l([[u.operation,[0,_,0,0]]]);U(s,this._ngxComm).then(s=>{const r={};s.forEach((function(e){if(e.functionCode!==u.operation)return t(y);r.success=0===e.retvals[0]})),e(r)}).catch(e=>t(e))}):Promise.reject(R)}isWitnessRequired(){return this._logger.debug("W2GAccrualService: isWitnessRequired called",null,i),O?new Promise((e,t)=>{const s=l([[u.isWitnessRequired,[0,0,0,0]]]);U(s,this._ngxComm).then(s=>{const r={};s.forEach((function(e){if(e.functionCode!==u.isWitnessRequired)return t(y);r.required=1===e.retvals[0]})),e(r)}).catch(e=>t(e))}):Promise.reject(R)}gotoLegacy(){return this._logger.debug("W2GAccrualService: gotoLegacy called",null,i),O?new Promise((e,t)=>{const s=r.default.createButtonPress("KEYPRESS_E");this.cleanup(),this.overrideW2GAccrual(0).then(()=>{this._logger.debug("W2GAccrualService: OverrideW2GAccrualScreen cancel Success at gotoLegacy.",null,i),this._ngxComm.sendMessage(s),e()}).catch(e=>t(e))}):Promise.reject(R)}cancelw2g(){return this._logger.debug("W2GAccrualService: cancelw2g called",null,i),O?new Promise((e,t)=>{this.cleanup(),this.overrideW2GAccrual(0).then(()=>{this._logger.debug("W2GAccrualService: OverrideW2GAccrualScreen cancel Success at cancelw2g.",null,i),e()}).catch(e=>t(e))}):Promise.reject(R)}cleanup(){this._logger.debug("W2GAccrualService: M5 W2G cleanup called",null,i),clearInterval(B),clearTimeout(L),L=-1,N=this._config.resetTimeout,D=0}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=n(s(1)),a=n(s(6));function n(e){return e&&e.__esModule?e:{default:e}}const i=["0x00","0x10","0x11","0x12","0x13","0x14","0x15","0x16","0x17","0x1B","0x1C","0x1D","0x1E","0x1F","0x20","0x21","0x22","0x23","0x24","0x25","0x26","0x27","0x28","0x29","0x2A","0x2B","0x2C","0x2D","0x2E","0x30","0x31","0x32","0x33","0x34","0x35","0x36","0x37","0x38","0x39","0x3A","0x3B","0x3C","0x3D","0x3E","0x40","0x44","0x45","0x46","0x47","0x4B","0x4D","0x4E","0x4F","0x50","0x51","0x52","0x53","0x54","0x55","0x56","0x57","0x58","0x59","0x5A","0x5B","0x5C","0x5D","0x5E","0x5F","0x68","0x69","0x6A","0x6B","0x6C","0x6D","0x6E","0x6F","0x78","0x79","0x7A","0x7B","0x7C","0x7D","0x7E","0x7F","0x80","0x81","0x82","0x83","0x84","0x85","0x86","0x87","0x88","0x89","0x8A","0x8B","0x8C","0x8D","0x8E","0x8F","0x90","0x91","0x92","0x93","0x94","0x95","0x96","0x97","0x98","0x99","0x9A","0x9B","0x9C","0x9D","0x9E","0x9F","0xA0","0xA1","0xA2","0xA3","0xA4","0xA5","0xA6","0xA7","0xA8","0xA9","0xAA","0xAB","0xAC","0xAD","0xAE","0xAF"],o=[],l=function(e){return JSON.parse(JSON.stringify(e))},u=function(e,t,s){return s.subscription[e]===t},c=function(e,t,s){const a=s.subscription[e];return void 0!==a&&"[object Array]"===Object.prototype.toString.call(a)&&0!==a.length&&-1!==a.indexOf(r.default.normalizeId(t))},d=function(e,t,s,a){let n=!0===e?l(i):t.map(r.default.normalizeId);return!0===e&&(t.forEach(e=>{-1===n.indexOf(e)&&n.push(e)}),n=n.filter(e=>-1===s.indexOf(e))),{cmd:"subscription",ver:"1.0",subscription:{screenTrigger:n.map(r.default.normalizeId),tokenUpdate:p(a),gameEvent:o.map(r.default.normalizeId),vpcPlayerData:h("vpcPlayerData",a),statusUpdate:h("statusUpdate",a),levelUpdate:h("levelUpdate",a),bonusHit:h("bonusHit",a),gameStart:h("gameStart",a),gameEnd:h("gameEnd",a),patronData:h("patronData",a),fullscreenState:h("fullscreenState",a),windowState:h("windowState",a),drawStatus:h("drawStatus",a),ismUpdate:h("ismUpdate",a),disableAutoHide:h("disableAutoHide",a),languageUpdate:h("languageUpdate",a),userTokenUpdate:function(e){const t=[];if(e&&e.userTokenUpdate&&e.userTokenUpdate.enabled&&e.userTokenUpdate.list)for(let s=0;s<e.userTokenUpdate.list.length;s++)t.push(`0x${e.userTokenUpdate.list[s].toString(16).toUpperCase().padStart(2,"0")}`);return t}(a),cardlessStatus:h("cardlessStatus",a)}}},h=function(e,t){var s=!0;return t&&t.hasOwnProperty(e)&&(s=t[e]),s},p=function(e){const t=[];return e&&e.tokenUpdate&&e.tokenUpdate.enabled&&e.tokenUpdate.list&&e.tokenUpdate.list.map((function(e){e.enabled&&e.id&&t.push(r.default.normalizeId(e.id))})),t};t.default=class{constructor(e,t,s=!1,r=[],n=a.default,i){if(!e)throw"screen id list is not optional";this.schemas=n,this.logger=t,this.screenIdList=e,this.subscribeAllTriggers=s,this.legacyIdList=r,this.ngxSubscriptionConfig=i,this.currentSub=d(this.subscribeAllTriggers,this.screenIdList,this.legacyIdList,this.ngxSubscriptionConfig),this.schemas.validate(this.currentSub,"subscription").then(()=>{},e=>{throw e})}getSubscription(){return l(this.currentSub)}resetSubscription(){this.currentSub=d(this.subscribeAllTriggers,this.screenIdList,this.legacyIdList,this.ngxSubscriptionConfig)}isAttrEqual(e,t){return this.currentSub.subscription[e]instanceof Array?function(e,t,s){const a=s.subscription[e];return a.length===t.length&&t.map(r.default.normalizeId).filter((function(e){return-1!==a.indexOf(e)})).length===a.length}(e,t,this.currentSub):u(e,t,this.currentSub)}doesAttrContainId(e,t){return this.currentSub.subscription[e]instanceof Array?c(e,r.default.normalizeId(t),this.currentSub):u(e,r.default.normalizeId(t),this.currentSub)}setAttribute(e,t){const s=l(this.currentSub);s.subscription[e]=t instanceof Array?t.map(r.default.normalizeId):t,this.schemas.validate(s,"subscription").then(()=>{this.currentSub=s},()=>{this.logger.error({error:"Setting subscription attribute resulted in a invalid subscription according to schema. The attribute value will not be set.",data:{attribute:e,value:t}},!0)})}addId(e,t){return new Promise((s,a)=>{if("[object Array]"!==Object.prototype.toString.call(this.currentSub.subscription[e]))return a(new Error("Unable to add Id, attribute is not an array."));if(c(e,t,this.currentSub))return this.logger.warn({warn:"Adding subscription id that already exists. The attibute value will not be updated.",data:{attribute:e,id:t}},!0),s();const n=l(this.currentSub);n.subscription[e].push(r.default.normalizeId(t)),this.schemas.validate(n,"subscription").then(()=>{this.currentSub=n,s()}).catch(()=>{a(new Error("Adding subscription id resulted in a invalid subscription according to schema. The attibute value will not be updated."))})})}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(s(3));t.default=class{constructor(){this.TRIGGER_TYPE="trigger",this.TOKEN_TYPE="token",this.tokens={},this.lastTokenId=null,this.triggers={},this.lastTriggerId=null,this.ordinal=0,this.contentState={}}sortByOrdinal(e,t){return e.ordinal-t.ordinal}removeOrdinal(e){return delete e.ordinal,e}addStateElement(e,t,s){return new Promise(r=>{let a;return a=setTimeout(function(){delete this.contentState[e]}.bind(this),s),t={value:t,timeoutinstance:a},void 0!==this.contentState[e]&&void 0!==this.contentState[e].timeoutinstance&&clearTimeout(this.contentState[e].timeoutinstance),this.contentState[e]=t,r()})}removeStateElement(e){return new Promise(t=>(void 0!==this.contentState[e]&&void 0!==this.contentState[e].timeoutinstance&&clearTimeout(this.contentState[e].timeoutinstance),delete this.contentState[e],t()))}add(e,t,s,a){e===this.TRIGGER_TYPE&&t===r.default.IDLE_SCREEN&&this.clear(),e===this.TRIGGER_TYPE&&(this.triggers[t]={value:s,ordinal:this.ordinal++,messageTokens:a},this.lastTriggerId=t),e===this.TOKEN_TYPE&&(this.tokens[t]={value:s,ordinal:this.ordinal++},this.lastTokenId=t)}storeToken(e,t){this.add(this.TOKEN_TYPE,e,t)}getTokens(){const e=[];return Object.keys(this.tokens).forEach(t=>{e.push({id:t,value:this.tokens[t].value,ordinal:this.tokens[t].ordinal})},this),e.sort(this.sortByOrdinal).map(this.removeOrdinal)}getLastToken(){if(null!==this.lastTokenId)return{id:this.lastTokenId,value:this.tokens[this.lastTokenId].value}}storeTrigger(e,t,s={}){this.add(this.TRIGGER_TYPE,e,t,s)}getTriggers(){const e=[];return Object.keys(this.triggers).forEach(t=>{e.push({id:t,value:this.triggers[t].value,ordinal:this.triggers[t].ordinal,messageTokens:this.triggers[t].messageTokens})},this),e.sort(this.sortByOrdinal).map(this.removeOrdinal)}getLastTrigger(){if(null!==this.lastTriggerId)return{id:this.lastTriggerId,value:this.triggers[this.lastTriggerId].value,messageTokens:this.triggers[this.lastTriggerId].messageTokens}}getAll(){let e=[];const t=Object.keys(this.triggers),s=Object.keys(this.tokens);return t.forEach(t=>{e.push({type:this.TRIGGER_TYPE,id:t,value:this.triggers[t].value,ordinal:this.triggers[t].ordinal,messageTokens:this.triggers[t].messageTokens})},this),s.forEach(t=>{e.push({type:this.TOKEN_TYPE,id:t,value:this.tokens[t].value,ordinal:this.tokens[t].ordinal})},this),e.sort(this.sortByOrdinal).map(this.removeOrdinal)}clear(){this.tokens={},this.triggers={},this.lastTokenId=null,this.lastTriggerId=null,this.ordinal=0}storeStateElement(e,t,s){return new Promise(r=>{0===(s=s||0)&&(s=864e5),this.addStateElement(e,t,s).then(()=>r(this.contentState))})}getStateElement(e){if(void 0!==this.contentState[e])return this.contentState[e].value}getContentState(){return this.contentState}deleteStateElement(e){return new Promise(t=>{this.removeStateElement(e).then(()=>t(this.contentState))})}clearContentState(){return this.contentState={},this.contentState}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=o(s(3)),a=o(s(64)),n=o(s(1)),i=o(s(2));function o(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(e,t,s,r=!0){this.lastKnownTrigger="0x00",this.ngxComm=e,this.logger=t,this.m5Config=s,this.delayPatronBuildCacheTime=2e3,this.delayInitialCashlessRetry=2e3,this.startSubscriptions=r,this.m5Config&&(this.m5Config.delayPatronCache&&(this.delayPatronBuildCacheTime=1e3*this.m5Config.delayPatronCache),this.m5Config.delayInitialCashlessRetry&&(this.delayInitialCashlessRetry=1e3*this.m5Config.delayInitialCashlessRetry)),this.minEgmDenom=200,this.defaultMinCentsBalance=this.m5Config.minimumPointPlayBalanceInCents,this.mapEgmDenomToMinCentsBalance=this.m5Config.mapEgmDenomToMinCentsBalance,this.enumInitiatePPStatus={PP_AVAILABLE:0,PP_NOT_AVAILABLE_EGM:1,PP_NOT_AVAILABLE_PINLOCK:2,PP_NOT_AVAILABLE_GOTO_BOOTH:3,PP_NOT_AVAILABLE_BALANCE_LOW:4,PP_NOT_AVAILABLE_CANNOT_CONVERT_XTRACREDIT:5,PP_NOT_AVAILABLE_CANNOT_CONVERT_XTRACREDIT_EGM:6,PP_NOT_AVAILABLE_PIN_FAILED:7,PP_NOT_AVAILABLE:8},this.INITIATE_PP_INIT_RESP_TOPIC="initPointPlayResp",this.CONVERT_PP_RESP_TOPIC="convertPointPlayResp",this.enumActivateXCStatus={XC_ACTIVE:0,XC_ACTIVE_NOT_CANCELABLE:1,XC_ALREADY_ACTIVE:2,XC_INACTIVE_BALANCE_TOO_LOW:3,XC_INACTIVE_NOT_AVAILABLE_ON_DEVICE:4,XC_INACTIVE_SEE_PLAYERS_CLUB:5,XC_INACTIVE_DUPLICATE_CARD:6,XC_INACTIVE_ABANDONED_CARD:7,XC_INACTIVE_PIN_LOCKED:8,XC_INACTIVE_BONUSING_UNAVAILABLE:9,XC_INACTIVE_PIN_VALIDATION_FAILED:10},this.enumCancelXCStatus={XC_CANCELLED:0,XC_NOT_CANCELABLE:1,XC_NOT_CANCELLED_IN_GAME_CYCLE:2},this.ACTIVATE_XC_RESP_TOPIC="activateXtraCreditResp",this.CANCEL_XC_RESP_TOPIC="cancelXtraCreditResp",this.enumPINStatus={VALID:1,INVALID:2,LOCKED:3,NO_RESPONSE:4,NOT_ENTERED:5},this.VALIDATE_PIN_RESP_TOPIC="validatePINResp",this.enumCardType={NONE:0,UNKNOWN:1,PLAYER:2,VIP:3,DROP_CARD:4,ATTENDANT:5,SUPERVISOR:6,WITNESS:7,UNREG_PLAYER:8,REG_PLAYER:9,REG_VIP_PLAYER:10},this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC="initiateTransferResp",this.enumM5States={IDLE:"IDLE",SESSION:"SESSION",GAME_LOCKED:"GAME_LOCKED",ATTENDANT:"ATTENDANT",W2G_ACCRUAL:"W2G_ACCRUAL",JACKPOT:"JACKPOT",IRESERVE:"RESERVED"},this.AppStore={player_info:{name:null,rankIndex:null,rank:null,playerId:null,dupCard:null,banned:null,isAbandoned:null,isBanned:null,isAnniversary:null,isBirthday:null,ptpEnable:null,xcEnable:null,rpEnable:null,srpEnable:null,ppEnable:null,haveCardData:null},playerBonuses:{pointPlay:{enable:null,total_balance:null,available_balance:null,available_balance_in_Cents:null,available_balance_in_Credits:null,points_Limit:null,points_Limit_Credits:null},xtraCredit:{enable:null,active:null,activeBalance:null,inActiveBalance:null,total_balance:null,cancellable:null,player_based:null,game_based:null},cashless:{enable:null,cardType:null,transferLimits:{minToEgm:null,maxToEgm:null,minFrEgm:null,maxFrEgm:null,maxBal:null},balances:{egmCents:null,cardCents:null,egmDenom:null},flags:{bonusing:null,haveData:null,haveLock:null,gameEnabled:null,coinlessAvailable:null,balanceActive:null,cashlessEnabled:null,haveCTSData:null,haveCardData:null,coinlessEnabled:null}}},player_session:{sessionPoints:null,total_games:null,win_loss:null,comps:null,pointMultiplier:null},machine:{isCarded:!1,asset:null,uid:null,floorLoc:null,cardId:null,isInvalidCard:null,ptpEnable:null,xcEnable:null,rpEnable:null,srpEnable:null,ppEnable:null,denom:null},bonuses:{enable:null},pin:{length:null,enter_required:null,check_pin_needed:null,force_pin:null,locked:null},display_limits:{coinInRunaway:null,coinOutRunaway:null,jackpot:null,bonus:null,xtraCredit:null,points:null,comp:null,witness:null,pouchPay:null},config:{RRConfigEndpoint:null,RRAwardEndpoint:null,bonusEndpoint:null,iReserveEndpoint:null},builtPatronDataCache:null,receivedPatronSessionScreen:null,receivedPlayerPinParams:null,isM5InitiatedScreenTrigger:null,retriedCashless:null,isJackpotInProgress:null,receivedAdvPatronData:null},this.startSubscriptions&&(this.setupAdvSubscription(),this.setupM5Subscription())}getDefaultMinCentsBalance(){return this.defaultMinCentsBalance}getMapEgmDenomToMinCentsBalance(e){return this.mapEgmDenomToMinCentsBalance[e]}delay(e){return new Promise(t=>setTimeout(t,e))}getAppStoreCache(){return Object.assign({},this.AppStore)}formatEvent(e){return e&&e instanceof CustomEvent?e.detail:e}getCurrentScreenTrigger(){return this.lastKnownTrigger}setupAdvSubscription(){this.ngxComm.registerPatronData(this.handleAdvPatronData.bind(this)),this.m5Config&&this.m5Config.playerRanking.enabled&&"legacyAdv"===this.m5Config.playerRanking.mode&&this.ngxComm.registerPatronDataExt(this.handleAdvPatronDataExt.bind(this)),this.ngxComm.registerServerAddresses(this.handleAdvServerAddresses.bind(this)),this.ngxComm.registerStatusUpdate(this.handleAdvStatusUpdate.bind(this))}setupM5Subscription(){i.default.subscribe(this.INITIATE_PP_INIT_RESP_TOPIC,this.handlePPInitiateResponse.bind(this)),i.default.subscribe(this.CONVERT_PP_RESP_TOPIC,this.handlePPConvertResponse.bind(this)),i.default.subscribe(this.ACTIVATE_XC_RESP_TOPIC,this.handleXCActivateResponse.bind(this)),i.default.subscribe(this.CANCEL_XC_RESP_TOPIC,this.handleXCCancelResponse.bind(this)),i.default.subscribe(this.VALIDATE_PIN_RESP_TOPIC,this.handleValidatePINResp.bind(this)),i.default.subscribe(this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC,this.handleCashlessTransferResponse.bind(this))}handleAdvPatronData(e){const t=this.formatEvent(e);if(this.logger.debug({debug:"AppStore:handleAdvPatronData - Received ADV Patron Data",data:t},!0),t&&t.patronData){if(this.AppStore.receivedAdvPatronData=!0,(t.patronData.hasOwnProperty("playerRank")||t.patronData.hasOwnProperty("playerRankIndex"))&&(this.logger.debug({debug:"AppStore:handleAdvPatronData - Received New Player Ranking (ABS)",data:{index:t.patronData.playerRankIndex,rank:t.patronData.playerRank}},!0),this.AppStore.player_info.rankIndex=t.patronData.playerRankIndex,this.AppStore.player_info.rank=t.patronData.playerRank),this.m5Config&&this.m5Config.playerRanking.enabled&&"ABS"===this.m5Config.playerRanking.mode){let e=this.AppStore.player_info.rank,s=this.AppStore.player_info.rankIndex;this.logger.debug({debug:"AppStore:handleAdvPatronData - Set New Player Ranking (ABS) to NgxComm",data:{index:s,rank:t.patronData.playerRank}},!0),this.ngxComm.setNewPatronRank(s,e)}t.patronData.awardEnable&&t.patronData.BE2_AwardEnable?(this.AppStore.machine.ptpEnable=t.patronData.BE2_AwardEnable.ptpEnable,this.AppStore.player_info.ptpEnable=t.patronData.awardEnable.ptpEnable,this.AppStore.playerBonuses.pointPlay.total_balance=t.patronData.ptpBalance,this.AppStore.machine.xcEnable=t.patronData.BE2_AwardEnable.xcEnable,this.AppStore.player_info.xcEnable=t.patronData.awardEnable.xcEnable,this.AppStore.playerBonuses.xtraCredit.total_balance=t.patronData.xcAwardBalance):this.logger.error({error:"AppStore:handleAdvPatronData - Received Invalid Patron Data for awardEnable or BE2_AwardEnable",data:t},!0),t.patronData.generalPTData?(t.patronData.generalPTData.dupCard?(this.AppStore.player_info.dupCard=t.patronData.generalPTData.dupCard,this.logger.debug({debug:"AppStore:handleAdvPatronData - Dup card",data:t.patronData.generalPTData.dupCard},!0)):this.AppStore.player_info.dupCard=!1,t.patronData.generalPTData.banned?(this.AppStore.player_info.banned=t.patronData.generalPTData.banned,this.logger.debug({debug:"AppStore:handleAdvPatronData - banned card",data:t.patronData.generalPTData.dupCard},!0)):this.AppStore.player_info.banned=!1,t.patronData.generalPTData.PINLocked?(this.AppStore.pin.locked=t.patronData.generalPTData.PINLocked,this.logger.debug({debug:"AppStore:handleAdvPatronData - pin locked card",data:t.patronData.generalPTData.dupCard},!0)):this.AppStore.pin.locked=!1):this.logger.error({error:"AppStore:handleAdvPatronData - Received Invalid Patron Data for generalPTData",data:t},!0),this.AppStore.machine.ptpEnable&&this.AppStore.player_info.ptpEnable?(this.AppStore.playerBonuses.pointPlay.enable=!0,this.logger.debug({debug:"AppStore:handleAdvPatronData - PP Enabled",data:null},!0)):(this.AppStore.playerBonuses.pointPlay.enable=!1,this.logger.debug({debug:"AppStore:handleAdvPatronData - PP Disabled",data:null},!0)),this.AppStore.machine.xcEnable&&this.AppStore.player_info.xcEnable?(this.AppStore.playerBonuses.xtraCredit.enable=!0,this.logger.debug({debug:"AppStore:handleAdvPatronData - XC Enabled",data:null},!0)):(this.AppStore.playerBonuses.xtraCredit.enable=!1,this.logger.debug({debug:"AppStore:handleAdvPatronData - XC Disabled",data:null},!0))}else this.logger.error({error:"AppStore:handleAdvPatronData - Received Invalid Patron Data",data:t},!0)}handleAdvPatronDataExt(e){const t=this.formatEvent(e);t&&t.patronDataExt?(this.AppStore.player_info.rankIndex=t.patronDataExt.playerRankIndex,this.AppStore.player_info.rank=t.patronDataExt.playerRank):(this.AppStore.player_info.rankIndex=null,this.AppStore.player_info.rank=null),this.AppStore.isM5InitiatedScreenTrigger||(this.logger.debug({debug:"AppStore:call checkAndOverrideScreenTrigger from Player Ranking",data:""},!0),this.checkAndOverrideScreenTrigger())}handleAdvServerAddresses(e){const t=this.formatEvent(e);t&&t.serverAddresses&&t.serverAddresses.forEach((function(e){}))}handleAdvStatusUpdate(e){const t=this.formatEvent(e);t&&t.statusUpdate&&(this.AppStore.display_limits.coinInRunaway=t.statusUpdate.displayLimits.coinInRunaway,this.AppStore.display_limits.coinOutRunaway=t.statusUpdate.displayLimits.coinOutRunaway,this.AppStore.display_limits.jackpot=t.statusUpdate.displayLimits.jackpot,this.AppStore.display_limits.bonus=t.statusUpdate.displayLimits.bonus,this.AppStore.display_limits.xtraCredit=t.statusUpdate.displayLimits.xtraCredit,this.AppStore.display_limits.points=t.statusUpdate.displayLimits.points,this.AppStore.display_limits.comp=t.statusUpdate.displayLimits.comp,this.AppStore.display_limits.witness=t.statusUpdate.displayLimits.witness,this.AppStore.display_limits.pouchPay=t.statusUpdate.displayLimits.pouchPay)}refreshPlayerAccountData(){if(this.lastKnownTrigger===r.default.IDLE_SCREEN)return void this.logger.debug({debug:"AppStore: refreshPlayerAccountData - cancelling due to no carded session."},!0);this.AppStore.receivedPlayerPinParams||this.getPlayerPinParams();const e=[[n.default.enumBE2BasicFunc.GetPointPlayBalance,[0,0,0,0]],[n.default.enumBE2BasicFunc.GetPointPlayLimitedBalance,[0,0,0,0]],[n.default.enumBE2BasicFunc.GetXtraCreditBalance,[0,0,0,0]],[n.default.enumBE2BasicFunc.MP_GetEgmDenom,[0,0,0,0]]],t=n.default.createBE2BasicFunctionArr(e);this.ngxComm.sendBe2Message(t,this.processRefreshPlayerAccountDataResp.bind(this))}processRefreshPlayerAccountDataResp(e,t){let s;if(e)this.logger.error({error:"AppStore: processRefreshPlayerAccountDataResp - Received an error",data:e});else{if(null!==t){if(0===(s=t[n.default.BE2_BASIC_RESPONSE]).length)return void this.logger.debug({debug:"AppStore: processPlayerAccountDataResp - No BE2 responses.",data:t},!0);s.forEach(e=>{e.functionCode===n.default.enumBE2BasicFunc.GetPointPlayBalance?(this.AppStore.playerBonuses.pointPlay.available_balance=e.retvals[0],this.AppStore.playerBonuses.pointPlay.available_balance_in_Cents=e.retvals[1],this.AppStore.playerBonuses.pointPlay.available_balance_in_Credits=e.retvals[2]):e.functionCode===n.default.enumBE2BasicFunc.GetPointPlayLimitedBalance?(this.AppStore.playerBonuses.pointPlay.points_Limit=e.retvals[0],this.AppStore.playerBonuses.pointPlay.points_Limit_Credits=e.retvals[2]):e.functionCode===n.default.enumBE2BasicFunc.GetXtraCreditBalance?(this.AppStore.playerBonuses.xtraCredit.total_balance=e.retvals[0],this.AppStore.playerBonuses.xtraCredit.cancellable=e.retvals[1]):e.functionCode===n.default.enumBE2BasicFunc.MP_GetEgmDenom?this.AppStore.machine.denom=e.retvals[0]:this.logger.debug({debug:"AppStore:processPlayerAccountDataResp - Unknown BE2Response!",data:""},!0)})}this.checkXCEnabled(),this.checkPPEnabled(),this.AppStore.isM5InitiatedScreenTrigger||(this.logger.debug({debug:"AppStore:call checkAndOverrideScreenTrigger from XC && PP Handler",data:""},!0),this.checkAndOverrideScreenTrigger())}}refreshCashlessAccountData(){const e=[];if(e.push([n.default.enumBE2BasicFunc.PIN_GetCardType,[0,0,0,0]]),e.push([n.default.enumBE2BasicFunc.GetCashlessLimits,[0,0,0,0]]),e.push([n.default.enumBE2BasicFunc.GetMoreCashlessLimits,[0,0,0,0]]),e.push([n.default.enumBE2BasicFunc.GetCashlessParameters,[0,0,0,0]]),e.length>0){const t=n.default.createBE2BasicFunctionArr(e);this.ngxComm.sendBe2Message(t,this.processRefreshCashlessAccountDataResp.bind(this))}}checkCashlessDisabledReasons(){this.logger.debug({debug:"AppStore: Check Cashless Disabled Reasons",data:null});const e=[[n.default.enumBE2BasicFunc.GetCashlessFlags,[0,0,0,0]],[n.default.enumBE2BasicFunc.PIN_GetStateInfo,[0,0,0,0]],[n.default.enumBE2BasicFunc.Cashless_Get_Config_Data,[0,0,0,0]],[n.default.enumBE2BasicFunc.PT_Get_Bonusing_Status,[0,0,0,0]]],t=n.default.createBE2BasicFunctionArr(e);this.ngxComm.sendBe2Message(t,this.processCheckCashlessDisabledReasonsResp.bind(this))}processCheckCashlessDisabledReasonsResp(e,t){let s;if(e)this.logger.error({error:"AppStore: Received an error in processCheckCashlessDisabledReasonsResp",data:e});else if(null!==t){if(0===(s=t[n.default.BE2_BASIC_RESPONSE]).length)return void this.logger.debug({debug:"AppStore: processCheckCashlessDisabledReasonsResp - No BE2 responses.",data:t},!0);s.forEach(e=>{switch(e.functionCode){case n.default.enumBE2BasicFunc.GetCashlessFlags:this.AppStore.playerBonuses.cashless.flags.haveData=1===e.retvals[0],this.AppStore.playerBonuses.cashless.flags.haveLock=1===e.retvals[1],this.AppStore.playerBonuses.cashless.flags.gameEnabled=1===e.retvals[2];break;case n.default.enumBE2BasicFunc.PIN_GetStateInfo:this.AppStore.playerBonuses.cashless.flags.haveCTSData=1===e.retvals[0],this.AppStore.playerBonuses.cashless.flags.haveCardData=1===e.retvals[1],this.AppStore.playerBonuses.cashless.flags.coinlessEnabled=1===e.retvals[3];break;case n.default.enumBE2BasicFunc.Cashless_Get_Config_Data:this.AppStore.playerBonuses.cashless.flags.cashlessEnabled=1===e.retvals[0];break;case n.default.enumBE2BasicFunc.PT_Get_Bonusing_Status:this.AppStore.playerBonuses.cashless.flags.bonusing=1===e.retvals[0];break;default:this.logger.debug({debug:"AppStore: processCheckCashlessDisabledReasonsResp - Unknown BE2Response!",data:""},!0)}}),this.logger.debug({debug:"AppStore: Cashless Disabled Reason : ",data:this.AppStore.playerBonuses.cashless})}}processRefreshCashlessAccountDataResp(e,t){let s;if(e)this.logger.error({error:"AppStore: Received an error in processRefreshCashlessAccountDataResp",data:e});else{if(null!==t){if(0===(s=t[n.default.BE2_BASIC_RESPONSE]).length)return void this.logger.debug({debug:"AppStore: processRefreshCashlessAccountDataResp - No BE2 responses.",data:t},!0);s.forEach(e=>{e.functionCode===n.default.enumBE2BasicFunc.PIN_GetCardType?this.checkCashlessEnabled(e.retvals[0]):e.functionCode===n.default.enumBE2BasicFunc.GetCashlessLimits?(this.AppStore.playerBonuses.cashless.transferLimits.minToEgm=e.retvals[0],this.AppStore.playerBonuses.cashless.transferLimits.maxToEgm=e.retvals[1],this.AppStore.playerBonuses.cashless.transferLimits.minFrEgm=e.retvals[2],this.AppStore.playerBonuses.cashless.transferLimits.maxFrEgm=e.retvals[3]):e.functionCode===n.default.enumBE2BasicFunc.GetMoreCashlessLimits?this.AppStore.playerBonuses.cashless.transferLimits.maxBal=e.retvals[0]:e.functionCode===n.default.enumBE2BasicFunc.GetCashlessParameters?(this.AppStore.playerBonuses.cashless.balances.cardCents=e.retvals[0],this.AppStore.playerBonuses.cashless.balances.egmCents=e.retvals[1],this.AppStore.playerBonuses.cashless.flags.coinlessAvailable=1===e.retvals[2],this.AppStore.playerBonuses.cashless.flags.balanceActive=1===e.retvals[3]):this.logger.debug({debug:"AppStore: processRefreshCashlessAccountDataResp - Unknown BE2Response!",data:""},!0)})}if(!1===this.AppStore.playerBonuses.cashless.enable){if(!this.AppStore.retriedCashless&&!this.AppStore.receivedPatronSessionScreen)return this.AppStore.retriedCashless=!0,this.AppStore.playerBonuses.cashless.enable=null,this.logger.debug({debug:"AppStore: processRefreshCashlessAccountDataResp - BE2 reported cashless disabled for first time, so retrying one more time ",data:""},!0),void this.delay(this.delayInitialCashlessRetry).then(()=>{this.refreshCashlessAccountData()});this.checkCashlessDisabledReasons()}else this.AppStore.playerBonuses.cashless.flags.haveData=!0,this.AppStore.playerBonuses.cashless.flags.haveLock=!0,this.AppStore.playerBonuses.cashless.flags.gameEnabled=!0,this.AppStore.playerBonuses.cashless.flags.haveCTSData=!0,this.AppStore.playerBonuses.cashless.flags.haveCardData=!0,this.AppStore.playerBonuses.cashless.flags.coinlessEnabled=!0,this.AppStore.playerBonuses.cashless.flags.cashlessEnabled=!0,this.AppStore.playerBonuses.cashless.flags.bonusing=!0,this.logger.debug({debug:"AppStore: processRefreshCashlessAccountDataResp Cashless Enabled True",data:""},!0);this.AppStore.isM5InitiatedScreenTrigger||(this.logger.debug({debug:"AppStore:call checkAndOverrideScreenTrigger from Cashless",data:""},!0),this.checkAndOverrideScreenTrigger())}}checkPPEnabled(){this.AppStore.machine.ptpEnable&&this.AppStore.player_info.ptpEnable?(this.logger.debug({debug:"AppStore: checkPPEnabled - PTP Enabled",data:this.AppStore.playerBonuses.pointPlay.available_balance},!0),this.AppStore.playerBonuses.pointPlay.enable=!0):(this.logger.debug({debug:"AppStore:checkPPEnabled - PTP Disabled, Machine or Player not enabled for PP",data:{playerPTP:this.AppStore.player_info.ptpEnable,machinePTP:this.AppStore.machine.ptpEnable}},!0),this.AppStore.playerBonuses.pointPlay.enable=!1)}checkXCEnabled(){this.AppStore.machine.xcEnable&&this.AppStore.player_info.xcEnable?(this.logger.debug({debug:"AppStore:checkXCEnabled - XC Enabled",data:this.AppStore.playerBonuses.xtraCredit.total_balance},!0),this.AppStore.playerBonuses.xtraCredit.enable=!0):(this.AppStore.playerBonuses.xtraCredit.enable=!1,this.logger.debug({debug:"AppStore:checkXCEnabled - XC Disabled",data:{playerXC:this.AppStore.player_info.xcEnable,machineXC:this.AppStore.machine.xcEnable}},!0))}checkCashlessEnabled(e){e===this.enumCardType.REG_PLAYER||e===this.enumCardType.REG_VIP_PLAYER||e===this.enumCardType.UNREG_PLAYER?this.AppStore.playerBonuses.cashless.enable=!0:this.AppStore.playerBonuses.cashless.enable=!1,this.AppStore.playerBonuses.cashless.cardType=e,this.logger.debug({debug:"AppStore:checkCashlessEnabled, Enabled = "+this.AppStore.playerBonuses.cashless.enable+" ",data:this.AppStore.playerBonuses.cashless.cardType},!0)}handlePPInitiateResponse(e){const t=this.formatEvent(e);t&&t.cmd===this.INITIATE_PP_INIT_RESP_TOPIC&&this.m5Config&&this.m5Config.hidePPAndXCOnFailures&&(this.AppStore.playerBonuses.pointPlay.enable?t.status===this.enumInitiatePPStatus.PP_NOT_AVAILABLE_EGM||t.status===this.enumInitiatePPStatus.PP_NOT_AVAILABLE||t.status===this.enumInitiatePPStatus.PP_NOT_AVAILABLE_PINLOCK?(this.AppStore.playerBonuses.pointPlay.enable=!1,this.logger.debug({debug:"AppStore:handlePPInitiateResponse - Point Play Disabled",data:t},!0)):this.logger.debug({debug:"AppStore:handlePPInitiateResponse - Point Play Remains Enabled",data:t},!0):this.logger.debug({debug:"AppStore:handlePPInitiateResponse - Point Play Already Disabled",data:t},!0))}handlePPConvertResponse(e){const t=this.formatEvent(e);t&&t.cmd===this.CONVERT_PP_RESP_TOPIC&&t.status===this.enumInitiatePPStatus.PP_AVAILABLE&&this.refreshPlayerAccountData()}handleXCActivateResponse(e){const t=this.formatEvent(e);t&&t.cmd===this.ACTIVATE_XC_RESP_TOPIC&&(t.status===this.enumActivateXCStatus.XC_ACTIVE&&this.refreshPlayerAccountData(),this.m5Config&&this.m5Config.hidePPAndXCOnFailures&&this.AppStore.playerBonuses.xtraCredit.enable&&(t.status!==this.enumActivateXCStatus.XC_INACTIVE_ABANDONED_CARD&&t.status!==this.enumActivateXCStatus.XC_INACTIVE_BONUSING_UNAVAILABLE&&t.status!==this.enumActivateXCStatus.XC_INACTIVE_SEE_PLAYERS_CLUB&&t.status!==this.enumActivateXCStatus.XC_INACTIVE_NOT_AVAILABLE_ON_DEVICE&&t.status!==this.enumActivateXCStatus.XC_INACTIVE_PIN_LOCKED&&t.status!==this.enumActivateXCStatus.XC_INACTIVE_DUPLICATE_CARD||(this.AppStore.playerBonuses.xtraCredit.enable=!1,this.logger.debug({debug:"AppStore:handleXCActivateResponse - XC Disabled",data:t},!0))))}handleXCCancelResponse(e){const t=this.formatEvent(e);t&&t.cmd===this.CANCEL_XC_RESP_TOPIC&&t.status===this.enumCancelXCStatus.XC_CANCELLED&&this.refreshPlayerAccountData()}handleValidatePINResp(e){this.formatEvent(e).status===this.enumPINStatus.LOCKED&&(this.AppStore.pin.locked=!0),this.getPlayerPinParams()}handleCashlessTransferResponse(e){const t=this.formatEvent(e);t&&t.cmd===this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC&&0===t.status&&this.refreshCashlessAccountData()}checkAndOverrideScreenTrigger(){let e=!1,t=!1,s=!1,a=!1,n=this.lastKnownTrigger,i=!1;this.m5Config.overrideSessionScreenTrigger&&null===this.AppStore.isM5InitiatedScreenTrigger&&(null!==this.AppStore.playerBonuses.xtraCredit.enable&&null!==this.AppStore.playerBonuses.pointPlay.enable&&(t=!0),this.m5Config.cashlessEnabled?null!==this.AppStore.playerBonuses.cashless.enable&&(s=!0):s=!0,this.m5Config.playerRanking.enabled&&"legacyAdv"===this.m5Config.playerRanking.mode?null===this.AppStore.player_info.rank&&null===this.AppStore.player_info.rankIndex||(a=!0):this.m5Config.playerRanking.enabled&&"ABS"===this.m5Config.playerRanking.mode?this.AppStore.receivedAdvPatronData?a=!0:this.logger.debug({debug:"AppStore:checkAndOverrideScreenTrigger - Patron Data not received for New Player Ranking via ABS )",data:{}},!0):a=!0,e=t&&s&&a,this.m5Config.ignoreOverrideSessionTriggerList&&this.m5Config.ignoreOverrideSessionTriggerList.length>0&&this.m5Config.ignoreOverrideSessionTriggerList.includes(n)&&(i=!0),(n===r.default.IRESERVE_SCREEN||"0x00"===n||i)&&(e=!1,this.logger.debug({debug:"AppStore:checkAndOverrideScreenTrigger - Cancelling M5 Override)",data:{lastKnownTrigger:n}},!0)),e?(this.logger.debug({debug:"AppStore:checkAndOverrideScreenTrigger - M5 Override Session Screen",data:{isXCAndPPDone:t,isCashlessDone:s,isPlayerRankingDone:a,lastKnownTrigger:n}},!0),this.AppStore.isM5InitiatedScreenTrigger=!0,this.ngxComm.initiateM5_AdvScreenTrigger(r.default.SESSION_SCREEN)):this.logger.debug({debug:"AppStore:checkAndOverrideScreenTrigger - M5 Override cancelled)",data:{isXCAndPPDone:t,isCashlessDone:s,isPlayerRankingDone:a,lastKnownTrigger:n}},!0))}handleTokenUpdate(e,t){if(null!=e)switch(e){case a.default.PLAYERS_PREFERRED_NAME:this.AppStore.player_info.name=t;break;case a.default.PLAYER_ID:t&&"0"!==t&&""!==t&&"Unk Tok"!==t&&(this.AppStore.player_info.playerId===t||this.AppStore.isJackpotInProgress||this.lastKnownTrigger===r.default.IRESERVE_SCREEN?this.logger.debug({debug:"AppStore:handleTokenUpdate2 - Ignoring build Patron Data cache for Player Id "+t,data:{value:t,playerId:this.AppStore.player_info.playerId,isJackpotInProgress:this.AppStore.isJackpotInProgress,lastKnownTrigger:this.lastKnownTrigger,builtPatronDataCache:this.AppStore.builtPatronDataCache}},!0):this.AppStore.builtPatronDataCache||this.lastKnownTrigger===r.default.IDLE_SCREEN?this.logger.debug({debug:"AppStore:handleTokenUpdate1 - Ignoring build Patron Data cache for Player Id "+t,data:{value:t,playerId:this.AppStore.player_info.playerId,isJackpotInProgress:this.AppStore.isJackpotInProgress,lastKnownTrigger:this.lastKnownTrigger,builtPatronDataCache:this.AppStore.builtPatronDataCache}},!0):(this.logger.debug({debug:"AppStore:handleTokenUpdate - Delay Build Patron Data cache for Player Id "+t+" by "+this.delayPatronBuildCacheTime,data:t},!0),this.AppStore.builtPatronDataCache=!0,this.delay(this.delayPatronBuildCacheTime).then(()=>{this.buildPatronData(t)}))),this.AppStore.isJackpotInProgress||this.lastKnownTrigger===r.default.IRESERVE_SCREEN||(this.AppStore.player_info.playerId=t);break;case a.default.PLAYERS_CARD_NUMBER:this.AppStore.machine.cardId=t,this.AppStore.machine.isCarded=!0;break;case a.default.PLAYER_POINT_BALANCE:this.AppStore.playerBonuses.pointPlay.total_balance=t;break;case a.default.PLAYER_POINTS_EARNED_SESSION:this.AppStore.player_session.sessionPoints=t;break;case a.default.FREE_PLAY_AMOUNT_CENTS:"number"==typeof t?this.AppStore.playerBonuses.xtraCredit.activeBalance=t:"string"==typeof t&&(t=t.substring(1),this.AppStore.playerBonuses.xtraCredit.activeBalance=parseFloat(t)),this.AppStore.playerBonuses.xtraCredit.active&&this.AppStore.playerBonuses.xtraCredit.activeBalance<=0&&(this.AppStore.playerBonuses.xtraCredit.active=!1,this.logger.debug({debug:"AppStore:handleTokenUpdate - XC became in active",data:t},!0)),!this.AppStore.playerBonuses.xtraCredit.active&&this.AppStore.playerBonuses.xtraCredit.activeBalance>0&&(this.AppStore.playerBonuses.xtraCredit.active=!0,this.logger.debug({debug:"AppStore:handleTokenUpdate - XC became active",data:t},!0));break;case a.default.XTRA_CREDIT_INACTIVE_AMOUNT:"number"==typeof t?this.AppStore.playerBonuses.xtraCredit.inActiveBalance=t:"string"==typeof t&&(t=t.substring(1),this.AppStore.playerBonuses.xtraCredit.inActiveBalance=parseFloat(t)),this.AppStore.playerBonuses.xtraCredit.inActiveBalance=t;break;case a.default.COMP_BALANCE_MONEY_TOKEN:this.AppStore.player_session.comps=t;break;case a.default.POINT_MULTIPLIER_INTEGER_TOKEN:this.AppStore.player_session.pointMultiplier=t;break;case a.default.MACHINE_ASSET_NUMBER:this.AppStore.machine.asset=t;break;case a.default.UNIQUE_ID_OF_BE2:this.AppStore.machine.uid=t;break;case a.default.FLOOR_LOCATION:this.AppStore.machine.floorLoc=t;break;case a.default.NON_NULL_ON_ABANDONED_CARD:null!=t&&t.length>0?(this.AppStore.player_info.isAbandoned=!0,this.logger.debug({debug:"AppStore:handleTokenUpdate - card is Abandoned",data:t},!0)):this.AppStore.player_info.isAbandoned=!1;break;case a.default.FLOOR_LOCATION_DUPLICATE_CARD:null!=t&&t.length>0?(this.AppStore.player_info.dupCard=!0,this.logger.debug({debug:"AppStore:handleTokenUpdate - card is duplicate",data:t},!0)):this.AppStore.player_info.dupCard=!1}}handleTriggerUpdate(e,t,s={}){if(null!=e)switch(this.lastKnownTrigger=e,e){case r.default.IDLE_SCREEN:this.logger.debug({debug:"AppStore: handleTriggerUpdate - Cleared Player Cache for Idle Screen",data:null},!0),this.clearPlayerSession(),this.sendStatusUpdateToSystem(this.enumM5States.IDLE),this.logger.debug({debug:"AppStore:handleTriggerUpdate - Received Idle Screen Trigger",data:t},!0);break;case r.default.BIRTHDAY_SCREEN:this.AppStore.player_info.isBirthday=!0;break;case r.default.ANNIVERSARY_SCREEN:this.AppStore.player_info.isAnniversary=!0;break;case r.default.INVALID_CARD_SCREEN:this.AppStore.machine.isInvalidCard=!0;break;case r.default.ATTENDANT_WELCOME_SCREEN:this.logger.debug({debug:"AppStore: handleTriggerUpdate - Cleared Player Cache for Attendant Welcome Screen",data:null},!0),this.clearPlayerSession(),this.sendStatusUpdateToSystem(this.enumM5States.ATTENDANT);break;case r.default.JACKPOT_SCREEN:this.setJackpotInProgressStatus(!0),this.sendStatusUpdateToSystem(this.enumM5States.JACKPOT);case r.default.W2G_ACCRUAL_SCREEN:this.setJackpotInProgressStatus(!0),this.sendStatusUpdateToSystem(this.enumM5States.W2G_ACCRUAL);break;case r.default.WELCOME_SCREEN:this.AppStore.builtPatronDataCache||(this.logger.debug({debug:"AppStore:handleTriggerUpdate - Start Build Patron Data cache from Session Screen Trigger ",data:t},!0),this.AppStore.builtPatronDataCache=!0,this.buildPatronData("X"));break;case r.default.SESSION_SCREEN:this.logger.debug({debug:"AppStore:handleTriggerUpdate - Received Session Screen Trigger",data:t},!0),this.AppStore.receivedPatronSessionScreen=!0,this.AppStore.builtPatronDataCache=!0,this.AppStore.isM5InitiatedScreenTrigger=!0,this.sendStatusUpdateToSystem(this.enumM5States.SESSION);break;case r.default.IRESERVE_SCREEN:this.sendStatusUpdateToSystem(this.enumM5States.IRESERVE)}}sendStatusUpdateToSystem(e){this.logger.sendStatusUpdateCommand(e)}getPlayerPinParams(){const e=[];this.logger.debug({debug:"AppStore:getPlayerPinParams - Get Player Pin Params",data:this.AppStore.pin},!0),e.push([n.default.enumBE2BasicFunc.MENU_IsENTEROnPINReq,[0,0,0,0]]),e.push([n.default.enumBE2BasicFunc.PIN_ForcePIN,[0,0,0,0]]),e.push([n.default.enumBE2BasicFunc.PIN_Check_PIN_Needed,[0,0,0,0]]),e.push([n.default.enumBE2BasicFunc.PIN_GetStateInfo,[0,0,0,0]]);const t=n.default.createBE2BasicFunctionArr(e);this.ngxComm.sendBe2Message(t,this.processPlayerPinParamsResponse.bind(this))}processPlayerPinParamsResponse(e,t){let s;if(e)this.logger.error({error:"AppStore: Received an error in processPlayerPinParamsResponse",data:e});else{if(null!==t){if(0===(s=t[n.default.BE2_BASIC_RESPONSE]).length)return void this.logger.debug({debug:"AppStore: processPlayerPinParamsResponse - No BE2 responses.",data:t},!0);s.forEach(e=>{e.functionCode===n.default.enumBE2BasicFunc.MENU_IsENTEROnPINReq?(this.AppStore.pin.enter_required=1===e.retvals[0],this.AppStore.pin.length=e.retvals[1]):e.functionCode===n.default.enumBE2BasicFunc.PIN_ForcePIN?this.AppStore.pin.force_pin=1===e.retvals[0]:e.functionCode===n.default.enumBE2BasicFunc.PIN_Check_PIN_Needed?this.AppStore.pin.check_pin_needed=1===e.retvals[0]:e.functionCode===n.default.enumBE2BasicFunc.PIN_GetStateInfo?(this.AppStore.pin.locked=1===e.retvals[2],this.AppStore.player_info.haveCardData=1===e.retvals[1]):this.logger.debug({debug:"AppStore: processPlayerPinParamsResponse - Unknown BE2Response!",data:""},!0)}),this.logger.debug({debug:"AppStore: processPlayerPinParamsResponse - pin params",data:this.AppStore.pin},!0)}this.AppStore.receivedPlayerPinParams=!0}}buildPatronData(e){this.logger.debug({debug:"AppStore:buildPatronData - building Patron Data",data:e},!0);const t=[];t.push([n.default.enumBE2BasicFunc.PT_Get_Player_Menu_State,[0,0,0,0]]),t.push([n.default.enumBE2BasicFunc.MENU_GetXPCParameters,[0,0,0,0]]),t.push([n.default.enumBE2BasicFunc.PIN_GetStateInfo,[0,0,0,0]]);const s=n.default.createBE2BasicFunctionArr(t);this.ngxComm.sendBe2Message(s,this.processbuildPatronDataResp.bind(this)),this.m5Config.cashlessEnabled&&null===this.AppStore.playerBonuses.cashless.cardType&&this.refreshCashlessAccountData()}processbuildPatronDataResp(e,t){let s;if(e)this.logger.error({error:"AppStore: Received an error in processbuildPatronDataResp",data:e});else{if(null!==t){if(0===(s=t[n.default.BE2_BASIC_RESPONSE]).length)return void this.logger.debug({debug:"AppStore: processbuildPatronDataResp - No BE2 responses.",data:t},!0);s.forEach(e=>{e.functionCode===n.default.enumBE2BasicFunc.PT_Get_Player_Menu_State?(1===e.retvals[2]?(this.AppStore.player_info.ptpEnable=!0,this.AppStore.machine.ptpEnable=!0):(this.AppStore.player_info.ptpEnable=!1,this.AppStore.machine.ptpEnable=!1,this.AppStore.playerBonuses.pointPlay.enable=!1,this.logger.debug({debug:"AppStore: processbuildPatronDataResp - PTP disabled.",data:e.retvals},!0)),e.retvals[3]>0&&!this.AppStore.playerBonuses.xtraCredit.active&&(this.AppStore.playerBonuses.xtraCredit.active=!0,this.logger.debug({debug:"AppStore: processbuildPatronDataResp - XC became Active.",data:e.retvals},!0))):e.functionCode===n.default.enumBE2BasicFunc.MENU_GetXPCParameters?(this.AppStore.playerBonuses.xtraCredit.player_based=1===e.retvals[0],this.AppStore.playerBonuses.xtraCredit.game_based=1===e.retvals[2],this.AppStore.playerBonuses.xtraCredit.player_based||this.AppStore.playerBonuses.xtraCredit.game_based?(this.AppStore.player_info.xcEnable=!0,this.AppStore.machine.xcEnable=!0,this.AppStore.playerBonuses.xtraCredit.enable=!0,this.logger.debug({debug:"AppStore: processbuildPatronDataResp - XC enabled.",data:e.retvals},!0)):(this.AppStore.player_info.xcEnable=!1,this.AppStore.machine.xcEnable=!1,this.AppStore.playerBonuses.xtraCredit.enable=!1)):e.functionCode===n.default.enumBE2BasicFunc.PIN_GetStateInfo?(this.AppStore.pin.locked=1===e.retvals[2],this.AppStore.player_info.haveCardData=1===e.retvals[1],this.AppStore.pin.locked&&this.logger.debug({debug:"AppStore: processbuildPatronDataResp - Pin Locked.",data:e.retvals},!0)):this.logger.debug({debug:"AppStore: processbuildPatronDataResp - Unknown BE2Response!",data:""},!0)})}this.refreshPlayerAccountData()}}UpdatePinParams(e,t,s,r,a){this.AppStore.pin.locked=e,this.AppStore.pin.force_pin=t,this.AppStore.pin.check_pin_needed=s,this.AppStore.pin.enter_required=r,this.AppStore.pin.length=a,this.AppStore.receivedPlayerPinParams=!0,this.logger.debug({debug:"AppStore: UpdatePinParams - Pin params updated !",data:this.AppStore.pin},!0)}setJackpotInProgressStatus(e){this.AppStore.isJackpotInProgress=e,this.logger.debug({debug:"AppStore: setW2GInProgressStatus - setting isJackpotInProgress to "+e,data:this.AppStore.isJackpotInProgress},!0)}clearPlayerSession(){let e=this.AppStore.player_info.playerId;this.AppStore.receivedPlayerPinParams=null,this.AppStore.builtPatronDataCache=null,this.AppStore.receivedAdvPatronData=null,this.AppStore.receivedPatronSessionScreen=null,this.AppStore.isM5InitiatedScreenTrigger=null,this.AppStore.retriedCashless=null,this.AppStore.isJackpotInProgress=null,this.clearPlayerInfoStore(),this.clearPlayerBonusesStore(),this.clearPlayerSessionStore(),this.clearPlayerSpecificMachineStore(),this.clearBonusesStore(),this.clearConfigStore(),this.clearPinStore(),this.clearDisplayLimits(),this.logger.debug({debug:"AppStore: clearPlayerSession - Cleared Player Cache for player ID : "+e,data:null},!0)}clearPlayerInfoStore(){this.AppStore.player_info.name=null,this.AppStore.player_info.rankIndex=null,this.AppStore.player_info.rank=null,this.AppStore.player_info.playerId=null,this.AppStore.player_info.dupCard=null,this.AppStore.player_info.banned=null,this.AppStore.player_info.isAbandoned=null,this.AppStore.player_info.isBanned=null,this.AppStore.player_info.isAnniversary=null,this.AppStore.player_info.isBirthday=null,this.AppStore.player_info.ptpEnable=null,this.AppStore.player_info.xcEnable=null,this.AppStore.player_info.rpEnable=null,this.AppStore.player_info.srpEnable=null,this.AppStore.player_info.ppEnable=null,this.AppStore.player_info.ppErrorStatus=null,this.AppStore.player_info.haveCardData=null}clearPlayerBonusesStore(){this.clearPointPlayStore(),this.clearXtraCreditStore(),this.clearCashlessStore()}clearPointPlayStore(){this.AppStore.playerBonuses.pointPlay.enable=null,this.AppStore.playerBonuses.pointPlay.total_balance=null,this.AppStore.playerBonuses.pointPlay.available_balance=null,this.AppStore.playerBonuses.pointPlay.available_balance_in_Cents=null,this.AppStore.playerBonuses.pointPlay.available_balance_in_Credits=null,this.AppStore.playerBonuses.pointPlay.points_Limit=null,this.AppStore.playerBonuses.pointPlay.points_Limit_Credits=null}clearXtraCreditStore(){this.AppStore.playerBonuses.xtraCredit.enable=null,this.AppStore.playerBonuses.xtraCredit.active=null,this.AppStore.playerBonuses.xtraCredit.activeBalance=null,this.AppStore.playerBonuses.xtraCredit.inActiveBalance=null,this.AppStore.playerBonuses.xtraCredit.total_balance=null,this.AppStore.playerBonuses.xtraCredit.cancellable=null,this.AppStore.playerBonuses.xtraCredit.player_based=null,this.AppStore.playerBonuses.xtraCredit.game_based=null}clearCashlessStore(){this.AppStore.playerBonuses.cashless.enable=null,this.AppStore.playerBonuses.cashless.cardType=null,this.AppStore.playerBonuses.cashless.transferLimits.minToEgm=null,this.AppStore.playerBonuses.cashless.transferLimits.maxToEgm=null,this.AppStore.playerBonuses.cashless.transferLimits.minFrEgm=null,this.AppStore.playerBonuses.cashless.transferLimits.maxFrEgm=null,this.AppStore.playerBonuses.cashless.transferLimits.maxBal=null,this.AppStore.playerBonuses.cashless.balances.cardCents=null,this.AppStore.playerBonuses.cashless.balances.egmCents=null,this.AppStore.playerBonuses.cashless.balances.egmDenom=null,this.AppStore.playerBonuses.cashless.flags.bonusing=null,this.AppStore.playerBonuses.cashless.flags.haveData=null,this.AppStore.playerBonuses.cashless.flags.haveLock=null,this.AppStore.playerBonuses.cashless.flags.gameEnabled=null,this.AppStore.playerBonuses.cashless.flags.coinlessAvailable=null,this.AppStore.playerBonuses.cashless.flags.balanceActive=null,this.AppStore.playerBonuses.cashless.flags.cashlessEnabled=null,this.AppStore.playerBonuses.cashless.flags.haveCTSData=null,this.AppStore.playerBonuses.cashless.flags.haveCardData=null,this.AppStore.playerBonuses.cashless.flags.coinlessEnabled=null}clearMachineStore(){this.AppStore.machine.isCarded=null,this.AppStore.machine.asset=null,this.AppStore.machine.uid=null,this.AppStore.machine.floorLoc=null,this.AppStore.machine.ptpEnable=null,this.AppStore.machine.rpEnable=null,this.AppStore.machine.srpEnable=null,this.AppStore.machine.ppEnable=null,this.AppStore.machine.ptpEnable=null,this.AppStore.machine.cardId=null,this.AppStore.machine.denom=null}clearPlayerSpecificMachineStore(){this.AppStore.machine.isCarded=null,this.AppStore.machine.cardId=null,this.AppStore.machine.isInvalidCard=null,this.AppStore.machine.ptpEnable=null,this.AppStore.machine.xcEnable=null,this.AppStore.machine.rpEnable=null,this.AppStore.machine.srpEnable=null,this.AppStore.machine.ppEnable=null}clearBonusesStore(){this.AppStore.bonuses.enable=null}clearConfigStore(){this.AppStore.config.bonusEndpoint=null,this.AppStore.config.iReserveEndpoint=null,this.AppStore.config.RRAwardEndpoint=null,this.AppStore.config.RRConfigEndpoint=null}clearPlayerSessionStore(){this.AppStore.player_session.comps=null,this.AppStore.player_session.pointMultiplier=null,this.AppStore.player_session.total_games=null,this.AppStore.player_session.sessionPoints=null,this.AppStore.player_session.win_loss=null}clearPinStore(){this.AppStore.pin.length=null,this.AppStore.pin.enter_required=null,this.AppStore.pin.check_pin_needed=null,this.AppStore.pin.force_pin=null,this.AppStore.pin.locked=null}clearDisplayLimits(){this.AppStore.display_limits.coinInRunaway=null,this.AppStore.display_limits.coinOutRunaway=null,this.AppStore.display_limits.jackpot=null,this.AppStore.display_limits.bonus=null,this.AppStore.display_limits.xtraCredit=null,this.AppStore.display_limits.points=null,this.AppStore.display_limits.comp=null,this.AppStore.display_limits.witness=null,this.AppStore.display_limits.pouchPay=null}clearAll(){this.clearPlayerSession(),this.clearMachineStore()}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.statusMessageMap={}}setStatusMessages(e){this.statusMessageMap=e}getStatusMessages(){return this.statusMessageMap}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=l(s(3)),a=l(s(1)),n=l(s(205)),i=l(s(2)),o=l(s(6));function l(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(e,t,s,r){if(!t)throw"subscription manager is not optional";this.wsHost=e,this.subManager=t,this.logger=s,this.m5Config=r,this.gamePlayActive=!1,this.SCREEN_TRIGGER_CMD="screenTrigger",this.TOKEN_CMD="tokenUpdate",this.SUB_ACK_CMD="subscriptionAck",this.VPC_PLAYER_DATA_CMD="vpcPlayerData",this.STATUS_UPDATE_CMD="statusUpdate",this.LEVEL_UPDATE_CMD="levelUpdate",this.BONUS_HIT_CMD="bonusHit",this.GAME_START_CMD="gameStart",this.GAME_END_CMD="gameEnd",this.PATRON_DATA_CMD="patronData",this.PATRON_DATAEXT_CMD="patronDataExt",this.BE2FUNCTION_RESPONSE_CMD="be2BasicResponse",this.BE2FUNCTION_CMD="be2BasicFunction",this.QR_CODE_CMD="qrCode",this.GAME_EVENT_CMD="gameEvent",this.FULL_SCREEN_STATE="fullscreenState",this.WINDOW_STATE="windowState",this.ISM_UPDATE="ismUpdate",this.DRAW_STATUS="drawStatus",this.SERVER_ADDRESSES="serverAddresses",this.FORCE_CARD_OUT_ACK="forceCardOutAck",this.LANGUAGE_UPDATE="languageUpdate",this.USER_TOKEN_CMD="userTokenUpdate",this.CARDLESS_STATUS_CMD="cardlessStatus",this.HEARTBEAT_MESSAGE={cmd:"heartbeat",ver:"1.0"},this.STATE_STARTUP=0,this.STATE_SUB_SENT=1,this.STATE_CONTENT_READY=2,this.be2MsgProcessor=new n.default(e=>{this.sendMessage(e)},s,r.be2MessageProcessor),this.heartbeatInterval=0,this.connectionWatcherHandler=0,this.serverPingFailed=!1,this.state=this.STATE_STARTUP,this.screenTriggers=[],this.tokenUpdates=[],this.userTokenUpdates=[],this.currentTokenValues={},this.currentUserTokenValues={},this.vpcPlayerData={},this.statusUpdate={},this.levelUpdate={},this.bonusHit={},this.gameStart={},this.gameEnd={},this.patronData={},this.patronDataExt={},this.windowState={},this.ismUpdate={},this.drawStatus={},this.subscribers=[],this.languageUpdate={},this.cardlessStatus={};const a=/^0[xX][0-9a-fA-F]{2}$/;this.isValidId=function(e){return a.test(e)},this.isIdInList=function(e,t){const s="string"==typeof t?parseInt(t,16):t;return e.indexOf(s)>-1},this.sendSubscriptionTimeout=0,this.m5OverrideSessionScreenTrigger=!1,this.m5OverrideSessionScreenTriggerTime=null,this.firstSessionScreenFromAdv=null,this.SERVER_FORCE_STOP_HEARTBEAT="serverForceStopHeartBeat",this.serverInitiatedStopHeartbeat=!1,i.default.subscribe(this.SERVER_FORCE_STOP_HEARTBEAT,this.forceStopHeartBeat.bind(this))}resetNgxCache(){this.vpcPlayerData={},this.statusUpdate={},this.levelUpdate={},this.patronData={},this.patronDataExt={},this.ismUpdate={},this.drawStatus={},this.cardlessStatus={},this.m5OverrideSessionScreenTrigger=!1,this.m5OverrideSessionScreenTriggerTime=null,this.firstSessionScreenFromAdv=null}forceStopHeartBeat(){this.serverInitiatedStopHeartbeat=!0}hostReachable(){var e=new(window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP");e.open("HEAD","//"+window.location.host+"/shell/launcher.html?rand="+(new Date).getTime(),!1);var t=!1;try{e.send(),t=e.status>=200&&(e.status<300||304===e.status)}catch(e){t=!1}return t||(this.serverPingFailed=!0),t}monitorConnection(){var e=!navigator.onLine,t=!this.hostReachable();(e||t)&&this.stopHeartbeat(),this.connectionWatcherHandler=setTimeout(this.monitorConnection.bind(this),this.m5Config.unreachableHeartbeatInterval)}setupWebSocket(){return new Promise(e=>{const t=()=>{0!==this.connectionWatcherHandler&&(clearTimeout(this.connectionWatcherHandler),this.connectionWatcherHandler=0),this.m5Config.unreachableHeartbeatInterval>0?this.connectionWatcherHandler=setTimeout(this.monitorConnection.bind(this),this.m5Config.unreachableHeartbeatInterval):this.logger.debug({debug:"Not monitoring connection to M5 server. Interval set to:",data:this.m5Config.unreachableHeartbeatInterval},!0),this.ngxSocket=new WebSocket(this.wsHost),this.ngxSocket.onopen=()=>{this.actuallySendSubscription(),e()},this.ngxSocket.onmessage=e=>{this.logger.debug({debug:"Got an event from Adv:",data:e.data},!0);try{const t=JSON.parse(e.data);this.gotMessage(t)}catch(t){const s="Got something that wasn't JSON, giving up";this.logger.error({error:s,data:e.data},!0)}},this.ngxSocket.onerror=e=>{this.logger.error({error:"Ngx websocket connection errored out with: "+JSON.stringify(e)},!0),this.state=self.STATE_STARTUP},this.ngxSocket.onclose=e=>{this.logger.warn({warning:"Ngx is disconnected, waiting 2 seconds to connect again. Connection message: "+JSON.stringify(e)},!0),this.state=this.STATE_STARTUP,this.stopHeartbeat(),setTimeout(t,2e3)}};t()})}registerScreenTrigger(e,t){if(!this.isValidId(e))return void this.logger.error({error:"Register screen trigger called with invalid triggerName: "+e},!0);const s=parseInt(e,16);-1===this.screenTriggers.indexOf(s)&&this.screenTriggers.push(s);const r={type:"s"+a.default.createIdString(s),callback:t};this.subscribers.push(r),i.default.subscribe(r.type,r.callback)}registerTokenUpdate(e,t){if(!this.isValidId(e))return void this.logger.error({error:"Register token update called with invalid tokenName: "+e},!0);const s=parseInt(e,16);-1===this.tokenUpdates.indexOf(s)&&(this.tokenUpdates.push(s),this.currentTokenValues[a.default.createIdString(s)]="");const r={type:"t"+a.default.createIdString(s),callback:t};this.subscribers.push(r),i.default.subscribe(r.type,r.callback)}registerPatronDataExt(e){const t={type:this.PATRON_DATAEXT_CMD,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerPatronData(e){const t={type:this.PATRON_DATA_CMD,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerCardlessStatus(e){const t={type:this.CARDLESS_STATUS_CMD,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerIsmUpdate(e){const t={type:this.ISM_UPDATE,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerVpcPlayerData(e){const t={type:this.VPC_PLAYER_DATA_CMD,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerLevelUpdate(e){const t={type:this.LEVEL_UPDATE_CMD,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerQRCode(e){const t={type:this.QR_CODE_CMD,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerGameEvent(e){const t={type:this.GAME_EVENT_CMD,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerFullScreenState(e){const t={type:this.FULL_SCREEN_STATE,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerStatusUpdate(e){const t={type:this.STATUS_UPDATE_CMD,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerDrawStatus(e){const t={type:this.DRAW_STATUS,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerForceCardOutAck(e){const t={type:this.FORCE_CARD_OUT_ACK,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}sendSubscription(){clearTimeout(this.sendSubscriptionTimeout),this.sendSubscriptionTimeout=setTimeout(()=>this.actuallySendSubscription(),100,this)}registerWindowState(e){const t={type:this.WINDOW_STATE,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerServerAddresses(e){const t={type:this.SERVER_ADDRESSES,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerGameStart(e){const t={type:this.GAME_START_CMD,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerGameEnd(e){const t={type:this.GAME_END_CMD,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerBonusHit(e){const t={type:this.BONUS_HIT_CMD,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerLanguageUpdate(e){const t={type:this.LANGUAGE_UPDATE,callback:e};this.subscribers.push(t),i.default.subscribe(t.type,t.callback)}registerUserTokenUpdate(e,t){if(!this.isValidId(e))return void this.logger.error({error:"Register user token update called with invalid userTokenName: "+e},!0);const s=parseInt(e,16);-1===this.userTokenUpdates.indexOf(s)&&(this.userTokenUpdates.push(s),this.currentUserTokenValues[a.default.createIdString(s)]="");const r={type:"u"+a.default.createIdString(s),callback:t};this.subscribers.push(r),i.default.subscribe(r.type,r.callback)}actuallySendSubscription(){if(this.ngxSocket.readyState===WebSocket.OPEN){const e=this.subManager.getSubscription();this.sendMessage(e),this.state=this.STATE_SUB_SENT}}getTokens(e){const t={cmd:"getToken",ver:"1.0",getToken:[]};if(e.length<=5)t.getToken=e,this.sendMessage(t);else for(let s=0;s<e.length;s++)t.getToken=e[s],this.sendMessage(t)}getCurrentTokenValue(e){return this.currentTokenValues[a.default.normalizeId(e)]}getCurrentVpcPlayerData(){return this.vpcPlayerData}getCurrentIsmUpdateData(){return this.ismUpdate}getCurrentStatusUpdate(){return this.statusUpdate}getCurrentLevelUpdate(){return this.levelUpdate}getCurrentBonusHit(){return this.bonusHit}getCurrentGameStart(){return this.gameStart}getCurrentGameEnd(){return this.gameEnd}getCurrentPatronDataExt(){return this.patronDataExt}getCurrentPatronData(){return this.patronData}getCurrentWindowState(){return this.windowState}getCurrentDrawStatus(){return this.drawStatus}getCurrentLanguageUpdate(){return this.languageUpdate}getCurrentUserTokenValue(e){return this.currentUserTokenValues[a.default.normalizeId(e)]}gotMessage(e){const t=e.cmd,s=e.cmd+" is invalid according to the schema. Rejecting message.",n=e.cmd+" is invalid according to the schema. Continuing anyway.";if(this.state===this.STATE_SUB_SENT){if(t===this.SUB_ACK_CMD)return this.validateSchema(e.cmd,e,n).then(()=>{this.logger.debug(e,!0)}),this.state=this.STATE_CONTENT_READY,void this.startHeartbeat()}else this.state!==this.STATE_CONTENT_READY&&this.logger.warn({warn:"Got a message before we were ready. Using it anyway",data:e},!0);switch(e.cmd){case this.SCREEN_TRIGGER_CMD:this.validateSchema(e.cmd,e,s).then(()=>{if(this.isIdInList(this.screenTriggers,e.screenTrigger.screenId)){this.logger.debug({debug:"Valid screen trigger received",data:e},!0);const t=a.default.normalizeId(e.screenTrigger.screenId);let s={};t===r.default.IDLE_SCREEN&&this.resetNgxCache();for(const t in e.screenTrigger)e.screenTrigger.hasOwnProperty(t)&&e.screenTrigger[t]!==e.screenTrigger.screenId&&e.screenTrigger[t]!==e.screenTrigger.displayMessage&&(s[t]=e.screenTrigger[t]);this.checkM5InitiatedSessionScreen(t)||i.default.publish("s"+t,a.default.createScreenTrigger(t,e.screenTrigger.displayMessage,s))}else this.logger.error({error:"Unsolicited Screen Trigger. Rejecting message.",data:e},!0)});break;case this.TOKEN_CMD:this.validateSchema(e.cmd,e,s).then(()=>{for(let t=0;t<e.tokenUpdate.length;t++){if(!this.isIdInList(this.tokenUpdates,e.tokenUpdate[t].id)){this.logger.error({error:"Unsolicited Token Update. Rejecting message.",data:e.tokenUpdate[t]},!0);continue}const s=a.default.normalizeId(e.tokenUpdate[t].id);this.currentTokenValues[s]=e.tokenUpdate[t].value,i.default.publish("t"+s,a.default.createTokenUpdate(s,this.currentTokenValues[s]))}});break;case this.BE2FUNCTION_RESPONSE_CMD:this.validateSchema(e.cmd,e,s).then(()=>{this.be2MsgProcessor.processResponse(e)});break;case this.GAME_EVENT_CMD:this.validateSchema(e.cmd,e,s).then(()=>{const t=a.default.normalizeId(e.gameEvent);this.subManager.doesAttrContainId("gameEvent",t)?i.default.publish(this.GAME_EVENT_CMD,{cmd:e.cmd,ver:e.ver,gameEvent:t}):this.logger.error({error:"Unsolicited Game Event. Rejecting message.",data:e},!0)});break;case this.USER_TOKEN_CMD:this.validateSchema(e.cmd,e,s).then(()=>{for(let t=0;t<e.userTokenUpdate.length;t++){if(!this.isIdInList(this.userTokenUpdates,e.userTokenUpdate[t].id)){this.logger.error({error:"Unsolicited Token Update. Rejecting message.",data:e.userTokenUpdate[t]},!0);continue}const s=a.default.normalizeId(e.userTokenUpdate[t].id);this.currentUserTokenValues[s]=e.userTokenUpdate[t].value,i.default.publish("u"+s,a.default.createUserTokenUpdate(s,this.currentUserTokenValues[s]))}});break;case this.LEVEL_UPDATE_CMD:Array.isArray(e.levelUpdate)&&e.levelUpdate.map(e=>{if("number"==typeof e.isBbPGBonus)return e.isBbPGBonus=1==e.isBbPGBonus,e}),this.validateSchema(e.cmd,e,s).then(()=>{"object"==typeof this[t]&&(this[t]=e),i.default.publish(e.cmd,e)});break;case this.ISM_UPDATE:case this.DRAW_STATUS:case this.BONUS_HIT_CMD:case this.PATRON_DATAEXT_CMD:case this.PATRON_DATA_CMD:case this.QR_CODE_CMD:case this.FULL_SCREEN_STATE:case this.VPC_PLAYER_DATA_CMD:case this.STATUS_UPDATE_CMD:case this.WINDOW_STATE:case this.SERVER_ADDRESSES:case this.FORCE_CARD_OUT_ACK:case this.GAME_START_CMD:case this.GAME_END_CMD:case this.LANGUAGE_UPDATE:case this.CARDLESS_STATUS_CMD:this.validateSchema(e.cmd,e,s).then(()=>{var s=!1;e.cmd===this.GAME_START_CMD?this.gamePlayActive=!0:e.cmd===this.GAME_END_CMD&&(this.gamePlayActive||(s=!0),this.gamePlayActive=!1),"object"==typeof this[t]&&(this[t]=e),s||i.default.publish(e.cmd,e)});break;case this.SUB_ACK_CMD:break;default:this.logger.error({error:"Received unhandled command",data:e},!0)}}startHeartbeat(){this.serverPingFailed||(0!==this.heartbeatInterval&&clearInterval(this.heartbeatInterval),this.heartbeatInterval=setInterval(()=>{this.serverInitiatedStopHeartbeat||this.sendMessage(this.HEARTBEAT_MESSAGE)},5e3))}stopHeartbeat(){0!==this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=0)}createFunctionList(e){const t=[];for(let s=0;s<e.length;s++)e[s].hasOwnProperty("functionCode")&&t.push(e[s].functionCode);return t}sendMessage(e){this.ngxSocket.readyState===WebSocket.OPEN?(void 0!==e.cmd&&e.cmd===this.HEARTBEAT_MESSAGE.cmd||(void 0!==e.cmd&&e.cmd===this.BE2FUNCTION_CMD?this.logger.debug({debug:"Be2 Function sent",data:e},!0):this.logger.debug(e,!1)),this.ngxSocket.send(JSON.stringify(e))):this.logger.error({error:"Tried to send message but websocket is not connected.",data:e},!1)}sendBe2Message(e,t){this.be2MsgProcessor.makeRequest(e,t)}validateSchema(e,t,s){return new Promise((r,a)=>{o.default.validate(t,e).then(()=>{r()}).catch(e=>{this.logger.error({error:"Schema validation threw an exception: "+e+s,data:t},!0),a()})})}cleanup(){this.subscribers.forEach((function(e){i.default.unsubscribe(e.type,e.callback)})),this.logger.debug({debug:"NgxComm: Cleaning up."},!0)}initiateM5_AdvScreenTrigger(e){this.m5OverrideSessionScreenTrigger=!0,this.m5OverrideSessionScreenTriggerTime=(new Date).getTime();const t=a.default.normalizeId(e);if(t){let s=this.m5Config.overrideSessionScreenMessage,r=[],n=a.default.createScreenTrigger(e,s,r);i.default.publish("s"+t,n)}}setNewPatronRank(e,t){let s={cmd:"patronDataExt",ver:"1.0",patronDataExt:{sequenceId:0,playerRank:t,playerRankIndex:e}};this.patronDataExt=s,i.default.publish(s.cmd,s)}checkM5InitiatedSessionScreen(e){let t=!1;if(this.m5Config.overrideSessionScreenTrigger&&(!this.m5OverrideSessionScreenTrigger||e!==r.default.SESSION_SCREEN&&e!==r.default.PRELIMINARY_WELCOME&&e!==r.default.WELCOME_SCREEN||(t=!0),e===r.default.SESSION_SCREEN))if(null===this.firstSessionScreenFromAdv&&this.m5OverrideSessionScreenTrigger){this.firstSessionScreenFromAdv=(new Date).getTime();var s=((this.firstSessionScreenFromAdv-this.m5OverrideSessionScreenTriggerTime)/1e3).toFixed(2);this.logger.debug({debug:"NgxComm: checkM5InitiatedSessionScreen - m5 session screen performance time in secs : "+s},!0),this.m5OverrideSessionScreenTrigger=!1,t=!1}else if(null!==this.firstSessionScreenFromAdv){var a=((new Date).getTime()-this.firstSessionScreenFromAdv)/1e3;this.m5Config.duplicateSessionScreenTimeInSecs>=a&&(this.logger.debug({debug:"NgxComm: checkM5InitiatedSessionScreen - Duplicate session screen received from Adv with in  : "+a+" secs, so ignore this"},!0),t=!0)}return t}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(s(6));t.default=class{constructor(e,t,s){this.metricCounter=0,this.successfulRequests=0,this.failedRequests=0,this.unsolicitedResponses=0,this.requests=[],this.pendingRequests=[],this.pendingResponses=[],this.logger=t,this.dropQueueOnTimeout=!(!s||"boolean"!=typeof s.dropQueueOnTimeout)&&s.dropQueueOnTimeout,this.delay=50,this.maxTicks=50,this.metricInterval=36e5,s&&(s.interval&&s.interval>=5&&s.interval<=1e3&&(this.delay=s.interval),s.timeout&&s.timeout>=this.delay&&s.timeout<=6e4?this.maxTicks=s.timeout/this.delay:this.maxTicks=2500/this.delay,s.metricInterval&&s.metricInterval>=6e4&&s.metricInterval<=864e5&&(this.metricInterval=s.metricInterval)),this.errorMsg=(e,t,s,r,a,n)=>({error:e,request:t,response:s,ticks:r,delay:a,maxTicks:n}),this.debugMsg=(e,t,s,r,a,n)=>({debug:e,request:t,response:s,ticks:r,delay:a,maxTicks:n}),this.metricMsg=(()=>(e,t,s,r,a,n)=>{let i=t+s,o="";return{debug:e,successfulRequests:t,unsuccessfulRequests:s,unsolicitedResponses:r,successRate:o=i>0?0===s?"%100":"%"+Math.trunc(t/i*100):"N/A",delay:a,maxTicks:n}})(),this.tickId=window.setInterval(()=>{const t=()=>{let e=this.dropQueueOnTimeout?"All requests":"Request",t=this.errorMsg("BE2 Basic Function request timed out. "+e+" removed from the queue.",this.requests[0].request,null,this.requests[0].ticks,this.delay,this.maxTicks);if(this.logger.error(t,!0),this.dropQueueOnTimeout)this.requests.forEach(e=>{this.failedRequests++,"function"==typeof e.callback&&(t=this.errorMsg("BE2 Basic Function request timed out. Request removed from the queue.",e.request,null,e.ticks,this.delay,this.maxTicks),e.callback.call(void 0,t))}),this.requests=[];else{this.failedRequests++;let e=this.requests[0];"function"==typeof e.callback&&e.callback.call(void 0,t),this.requests.splice(0,1)}};let s=null,r=[...this.pendingResponses];this.pendingResponses=[];for(let e=r.length-1;e>-1;e--)try{let t=this.requests[0];if(this.isRequest(t.request,r[e])){this.successfulRequests++,"function"==typeof t.callback&&t.callback.call(void 0,null,r[e]);const s={debug:"Response from BE2 matched the active request. Total Response time: "+t.ticks*this.delay+"ms. ",totalTicks:t.ticks,delay:this.delay,maxTicks:this.maxTicks};this.logger.debug(s,!0),this.requests.splice(0,1);break}s=this.errorMsg("Be2 Basic Response processed but no matching request available. Rejecting message.",r[e],t),this.logger.error(s,!0),this.unsolicitedResponses++}catch(e){s=this.errorMsg("An exception occurred while processing active be2BasicResponses. "+e),this.logger.error(s,!0)}this.requests=this.requests.concat(this.pendingRequests),this.pendingRequests=[];try{if(this.requests.length>0){let s=this.requests[0];s.pending?(t=>{t.pending=!1,e(t.request)})(s):s.ticks>=this.maxTicks?t():s.ticks++}}catch(e){s=this.errorMsg("An exception occurred while processing active be2BasicFunction requests."+e),this.logger.error(s,!0)}},this.delay),window.setInterval(()=>{this.metricCounter++;let e=this.metricMsg("BE2 Request/Response health check: "+this.metricCounter,this.successfulRequests,this.failedRequests,this.unsolicitedResponses,this.delay,this.maxTicks);this.logger.debug(e,!0)},this.metricInterval)}makeRequest(e,t){const s=(e=>({cmd:"be2BasicFunction",ver:"1.0",be2BasicFunction:(e=>JSON.parse(JSON.stringify(e)))(e)}))(e);r.default.validate(s,"be2BasicFunction").then(()=>{this.pendingRequests.push({request:s,callback:t,pending:!0,ticks:0})},()=>{const e=this.errorMsg("Be2 Basic Function is invalid according to the schema. Rejecting message.",s);this.logger.error(e,!0),"function"==typeof t&&t.call(void 0,e)})}processResponse(e){r.default.validate(e,"be2BasicResponse").then(()=>{const t=this.errorMsg("Be2 Basic Response received but there are no active requests. Rejecting message.",e);this.requests.length>0&&!this.requests[0].pending?this.pendingResponses.push(e):(this.logger.error(t,!0),this.unsolicitedResponses++)},()=>{const t=this.errorMsg("Be2 Basic Response is invalid according to the schema. Rejecting message.",e);this.logger.error(t,!0)})}isRequest(e,t){if(e.be2BasicFunction.length!==t.be2BasicResponse.length)return!1;let s,r=null;const a=e.be2BasicFunction.map(e=>e.functionCode),n=t.be2BasicResponse.map(e=>e.functionCode);for(s=0;s<a.length;s++)if(a[s]!==n[s]){if(0!==n[s])return!1;r=this.debugMsg("WARN: NgxCommBe2MessageProcessor received a response for the invalid be2BasicFunction: "+a[s]+". It's likely this function should not be called."),this.logger.debug(r,!0)}else-1===t.be2BasicResponse[s].retvals[0]&&-1===t.be2BasicResponse[s].retvals[1]&&-1===t.be2BasicResponse[s].retvals[2]&&-1===t.be2BasicResponse[s].retvals[3]&&(r=this.debugMsg("WARN: NgxCommBe2MessageProcessor received a response for the disabled be2BasicFunction: "+n[s]+". It's likely this function should not be called."),this.logger.debug(r,!0));return!0}cleanup(){window.clearInterval(this.tickId)}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=u(s(1)),a=u(s(37)),n=u(s(63)),i=u(s(36)),o=u(s(3)),l=u(s(2));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,s){return function r(a,n){try{var i=t[a](n),o=i.value}catch(e){return void s(e)}if(!i.done)return Promise.resolve(o).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(o)}("next")}))}}let d=document.createElement("a"),h=document.createElement("a");t.default=class{static compareURLs(e,t){d.href=e.toLocaleLowerCase(),h.href=t.toLocaleLowerCase();let s=d.protocol==h.protocol&&d.host==h.host&&d.pathname==h.pathname&&d.search==h.search,r=d.hash==h.hash;return{exactSame:s&&r,needsRefresh:!s,onlyHashChanged:s&&!r}}static isEmptyObject(e){return null===e||0===Object.keys(e).length}static createUrl(e,t){if(void 0===t)return e.toString();let s;if(void 0!==e){d.href=t;let r=""==d.search?`?${e}`:`${d.search}&${e}`;s=d.protocol+"//"+d.hostname+(""==d.port?"":`:${d.port}`)+d.pathname+r+d.hash}else s=t;return s}static registerForUpdates(e,t,s){const r=s.getSubscription().subscription,a=r.screenTrigger,n=r.tokenUpdate,i=r.userTokenUpdate;a.forEach(s=>{t.registerScreenTrigger(s,e.sendMessage)}),n.forEach(s=>{t.registerTokenUpdate(s,e.sendMessage)}),i.forEach(s=>{t.registerUserTokenUpdate(s,e.sendMessage)}),t.registerWindowState(e.sendMessage),t.registerVpcPlayerData(e.sendMessage),t.registerPatronData(e.sendMessage),t.registerPatronDataExt(e.sendMessage),t.registerQRCode(e.sendMessage),t.registerLevelUpdate(e.sendMessage),t.registerIsmUpdate(e.sendMessage),t.registerGameEvent(e.sendMessage),t.registerStatusUpdate(e.sendMessage),t.registerDrawStatus(e.sendMessage),t.registerServerAddresses(e.sendMessage),t.registerForceCardOutAck(e.sendMessage),t.registerGameStart(e.sendMessage),t.registerGameEnd(e.sendMessage),t.registerBonusHit(e.sendMessage)}static formatEvent(e){return e&&e instanceof CustomEvent?e.detail:e}static getLatestAndSend(e,t,s,a=[]){const n=s.getSubscription().subscription.tokenUpdate;let i;a&&"length"in a&&a.forEach(t=>{e.sendMessage(this.formatEvent(t))}),n.forEach(s=>{const a=t.getCurrentTokenValue(s);void 0!==a&&e.sendMessage(r.default.createTokenUpdate(s,a))}),i=t.getCurrentVpcPlayerData(),this.isEmptyObject(i)||e.sendMessage(i),i=t.getCurrentStatusUpdate(),this.isEmptyObject(i)||e.sendMessage(i),i=t.getCurrentLevelUpdate(),this.isEmptyObject(i)||e.sendMessage(i),i=t.getCurrentBonusHit(),this.isEmptyObject(i)||e.sendMessage(i),i=t.getCurrentPatronData(),this.isEmptyObject(i)||e.sendMessage(i),i=t.getCurrentPatronDataExt(),this.isEmptyObject(i)||e.sendMessage(i),i=t.getCurrentWindowState(),this.isEmptyObject(i)||e.sendMessage(i),i=t.getCurrentDrawStatus(),this.isEmptyObject(i)||e.sendMessage(i),i=t.getCurrentIsmUpdateData(),this.isEmptyObject(i)||e.sendMessage(i)}static load(e,t){return new Promise(s=>{e.setAttribute("src",t),e.onload=function(){s(this.src)}})}static loadAndSendLatest(e,t,s,r,a,n=[]){return new Promise((i,o)=>{try{if(e.element.contentWindow.location.href&&""!==t){t=this.createUrl(e.pageUrl,t);let u=this.compareURLs(t,e.element.contentWindow.location.href);u.needsRefresh?(this.load(e.element,t).then(t=>{this.getLatestAndSend(e,s,r,n),e.element.onload=()=>{this.getLatestAndSend(e,s,r,n)},i(t)}).catch(o),a.autoHideFullscreenWhenNewContentTriggered&&l.default.publish("hide-full-screen")):(u.onlyHashChanged&&(e.element.setAttribute("src",t),this.getLatestAndSend(e,s,r,n)),i(t))}else o()}catch(e){o(e)}})}static canSendMessage(e){return{sendMessage:t=>{const s=this.formatEvent(t);null!==e.element&&void 0!==e.element&&null!==e.element.contentWindow&&void 0!==e.element.contentWindow?(n.default.postMessage(e.element.contentWindow,s),i.default.Instance().broadcastMessage(s)):e.logger.warn({warn:`ViewController: ${e.name} - Unable to send message to content, the element or content window is not defined`,data:s},!1)}}}static canSetupIframe(e){var t=this;return{setupIframe:(()=>{var s=c((function*(s,r){e.element=s;let a=t.createUrl(e.pageUrl,r);e.logger.debug({info:"Switched iFrame source to: ",data:a},!1),yield t.load(e.element,a)}));return function(e,t){return s.apply(this,arguments)}})()}}static canSetupIframeWStartupTokens(e,t,s,r){var a=this;return{setupIframe:(()=>{var n=c((function*(n,i){e.element=n,yield a.loadAndSendLatest(e,i,t,s,r)}));return function(e,t){return n.apply(this,arguments)}})()}}static BaseVC(e,t,s){const r={name:s,logger:e,pageUrl:t,urlParams:a.default.getUrlParamsObject(t),element:null};return Object.assign(r,this.canSendMessage(r),this.canSetupIframe(r))}static VCWRegistration(e,t,s,r,n,i){const o={name:s,logger:e,pageUrl:t,urlParams:a.default.getUrlParamsObject(t),element:null,currentTriggerId:null,currentUrl:null};return Object.assign(o,this.canSendMessage(o),this.canSetupIframeWStartupTokens(o,r,n,i)),this.registerForUpdates(o,r,n),o}static VCWRegAndTrigger(e,t,s,r,n,i,l){const u={name:s,logger:e,pageUrl:t,urlParams:a.default.getUrlParamsObject(t),element:null};return Object.assign(u,this.canSendMessage(u),this.canSetupIframeWStartupTokens(u,r,n,l)),this.registerForUpdates(u,r,n),n.getSubscription().subscription.screenTrigger.forEach(t=>{r.registerScreenTrigger(t,t=>{const s=this.formatEvent(t).screenTrigger.screenId;if("string"==typeof i.screenIdMap[s]){let a=i.screenIdMap[s];a=a===i.baseUrl?"":a,u.currentTriggerId!==s?(u.currentTriggerId=s,l&&l.enableAdvNgxSubscriptionPerScreen&&(n.resetSubscription(),r.sendSubscription()),l&&l.forceOpenServiceWindow&&l.forceOpenServiceWindow.enabled&&l.forceOpenServiceWindow.screenTriggerList&&l.forceOpenServiceWindow.screenTriggerList.length>0&&l.forceOpenServiceWindow.screenTriggerList.includes(s)&&this.forceOpenServiceWindow(r),this.loadAndSendLatest(u,a,r,n,l,[t]).then(t=>{e.debug({debug:"Switched iFrame source to: ",data:t},!1)}),e.debug({debug:"Switching iFrame source to: ",data:a},!1),this.getLatestAndSend(u,r,n,[t])):(this.getLatestAndSend(u,r,n,[t]),e.debug({debug:"Sending trigger event and tokens to iFrame: ",data:t},!1)),u.currentTriggerId>=o.default.VPC_PIN_SCREEN&&u.currentTriggerId<=o.default.VPC_CARD_OUT_SCREEN?this.setAutoHideSubscription(n,r,!0):this.setAutoHideSubscription(n,r,!1)}else this.getLatestAndSend(u,r,n,[t]),e.debug({debug:"Sending unknown event to iFrame: ",data:t},!1)})}),u}static setAutoHideSubscription(e,t,s){e.isAttrEqual("disableAutoHide",s)||(e.setAttribute("disableAutoHide",s),t.sendSubscription())}static forceOpenServiceWindow(e){const t=r.default.createShowHost(!0);e.sendMessage(t)}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=i(s(1)),a=i(s(2)),n=i(s(64));function i(e){return e&&e.__esModule?e:{default:e}}const o="validatePINResp",l="createPinSessionResp",u="showPINEntryScreen",c="hidePINEntryScreen",d="pinEntryResp",h=1,p=2,g=3,f=4,_=5,E=r.default.enumBE2BasicFunc,S=(e,t)=>({cmd:e,ver:"1.0",status:t});t.default=class{constructor(e,t,s,n,i){this.ngxComm=e,this.sessionService=t,this.logger=s,this.appStore=n,this.attempt=0,this.pinStatusCheckIntervalID=0;const o=["0x47"];this.sessionBased=!1,this.subscribers=[],this.overridePinInterval=0,this.overridePinRetryInterval=5e3,this.overridePinInterval=3e5,this.overridePin=i.includes("0x83")?1:0,this.overridePinArray=r.default.createBE2BasicFunctionArr([[E.PIN_OverridePINScreen,[this.overridePin,0,0,0]]]),this.overridePin&&e.registerScreenTrigger("0x83",this.beginValidatePIN.bind(this)),e.registerTokenUpdate("0x45",this.cancelPINEntryOnCardOut.bind(this)),this.ngxComm.sendBe2Message(this.overridePinArray,this.processOverridePinResponse.bind(this)),this.overridePinIntervalId=setInterval(()=>{this.ngxComm.sendBe2Message(this.overridePinArray,this.doNothing.bind(this)),this.logger.debug({debug:"PINService: Periodic PIN_OverridePINScreen("+this.overridePin+") sent. Interval: "+this.overridePinInterval,data:null})},this.overridePinInterval),this.subscribe=(e,t)=>{this.subscribers.push({type:e,cb:t}),a.default.subscribe(e,t)},this.subscribe("validatePIN",e=>{this.beginValidatePIN(e)}),this.subscribe("createPinSession",e=>{this.sessionBased=!0,this.beginValidatePIN(e)}),this.subscribe("pinEntryComplete",this.hidePINContent.bind(this));const l=this.validatePIN().bind(this);this.subscribe(d,l);for(let t=0;t<o.length;t++)e.registerScreenTrigger(o[t],this.cancelValidatePIN.bind(this))}get GET_PIN_STATUS_MAX_ATTEMPTS(){return 15}get GET_PIN_STATUS_INTERVAL(){return 1e3}processOverridePinResponse(e,t){e?setTimeout(()=>{this.logger.error({error:"PINService: Received an error in processOverridePinResponse. Retrying PIN Override with "+this.overridePin,data:e},!0),this.ngxComm.sendBe2Message(this.overridePinArray,this.processOverridePinResponse.bind(this))},this.overridePinRetryInterval):this.logger.debug({debug:"PINService: Successfully sent PIN_OverridePINScreen("+this.overridePin+").",data:t})}publishResponse(e){if(e!==h&&this.sessionService.deletePINSession(),this.sessionBased){const t=S(l,e);if(e===h){const s=this.ngxComm.getCurrentTokenValue(n.default.PLAYERS_CARD_NUMBER),r=this.ngxComm.getCurrentTokenValue(n.default.PLAYERS_PREFERRED_NAME);this.sessionService.createPINSession(`${s}_${r}`).then(s=>{t.token=s,a.default.publish(l,t),a.default.publish(o,S(o,e))}).catch(s=>{this.logger.error({error:"Received an error while trying to create a PIN session",data:s}),a.default.publish(l,t),a.default.publish(o,S(o,e))})}else a.default.publish(l,t),a.default.publish(o,S(o,e));this.sessionBased=!1}else a.default.publish(o,S(o,e))}processBeginValidatePINResp(e,t){return(s,n)=>{if(s)return void this.logger.error({error:"PINService: Received an error in processBeginValidatePINResp.",data:s},!0);t=t||!1;const i=n[r.default.BE2_BASIC_RESPONSE];if(4!==i.length)return void this.logger.error({error:"PINService: Received BE2 response with invalid number of function code(s). Expected response with four function codes.",data:n},!0);const o=[E.PIN_GetStateInfo,E.PIN_ForcePIN,E.PIN_Check_PIN_Needed,E.MENU_IsENTEROnPINReq],l=r.default.getBE2BasicFunctionMap(o,i);if(this.logger.debug({debug:"PINService: Function map is: ",data:l},!0),this.appStore.UpdatePinParams(1===l[E.PIN_GetStateInfo][2],1===l[E.PIN_ForcePIN][0],1===l[E.PIN_Check_PIN_Needed][0],1===l[E.MENU_IsENTEROnPINReq][0],l[E.MENU_IsENTEROnPINReq][1]),1===l[E.PIN_GetStateInfo][2]){this.logger.debug({debug:"PINService: PIN is locked. Sending BE2 request PIN_NotEntered, PIN_OverridePINScreen(1)publishing PIN LOCKED."},!0);const e=r.default.createBE2BasicFunctionArr([[E.PIN_NotEntered,[0,0,0,0]]]);return this.ngxComm.sendBe2Message(e,this.doNothing.bind(this)),void this.publishResponse(g)}if(0===l[E.PIN_ForcePIN][0]&&0===l[E.PIN_Check_PIN_Needed][0]&&!t)return this.logger.debug({debug:"PINService: PIN entry NOT needed. PIN is already valid."},!0),void this.publishResponse(h);if(void 0!==e)return this.logger.debug({debug:"PINService: Pin is already defined. Skip to PIN entry response step."},!0),void a.default.publish(d,{cmd:"pinEntryResp",ver:"1.0",PIN:e,cancelled:!1});this.logger.debug({debug:"PINService: dopinnow=1 or pinNeeded=1. Showing PIN entry content with PIN length="+l[E.MENU_IsENTEROnPINReq][1]},!0);const c=1===l[E.MENU_IsENTEROnPINReq][0];a.default.publish(u,{cmd:u,ver:"1.0",enterRequired:c,pinLength:l[E.MENU_IsENTEROnPINReq][1]}),document.getElementById("PinContentFrame").style.display="inline"}}cancelPINEntryOnCardOut(e){if(void 0!==e&&e.detail.hasOwnProperty("tokenUpdate")){let t=e.detail.tokenUpdate;"0"===t[0].value&&(this.cancelValidatePIN(),this.logger.debug({debug:"PINService: Card out detected, sending cancel PIN.",data:{cardId:t[0].value}}))}}beginValidatePIN(e){this.logger.debug({debug:"PINService: Sending BE2 request PIN_GetStateInfo, PIN_ForcePIN, PIN_Check_PIN_Needed, MENU_IsENTEROnPINReq.",data:""},!0);const t=r.default.createBE2BasicFunctionArr([[E.PIN_GetStateInfo,[0,0,0,0]],[E.PIN_ForcePIN,[0,0,0,0]],[E.PIN_Check_PIN_Needed,[0,0,0,0]],[E.MENU_IsENTEROnPINReq,[0,0,0,0]]]);let s=!1;e.detail.hasOwnProperty("forcePin")&&(s=e.detail.forcePin),this.ngxComm.sendBe2Message(t,this.processBeginValidatePINResp(e.detail.PIN,s).bind(this))}validatePIN(){return function(e){const t=e.detail;let s;if(this.isPinValidationTransaction())this.logger.warn({warn:"PINService: Pin validation transaction is in process. Rejecting subsequent call to validate pin.",data:t});else{if(null==t||void 0===t.cmd||void 0===t.cancelled){this.logger.error({error:"PINService: PIN entry response is invalid. Rejecting message. Sending BE2 request PIN_NotEntered, publishing PIN NOT_ENTERED.",data:t});const e=r.default.createBE2BasicFunctionArr([[E.PIN_NotEntered,[0,0,0,0]]]);return this.ngxComm.sendBe2Message(e,this.doNothing.bind(this)),void this.publishResponse(_)}if(t.cancelled){this.logger.debug({debug:"PINService: PIN was not entered. Sending BE2 request PIN_NotEntered, publishing PIN NOT_ENTERED.",data:t},!0);const e=r.default.createBE2BasicFunctionArr([[E.PIN_NotEntered,[0,0,0,0]]]);return this.ngxComm.sendBe2Message(e,this.doNothing.bind(this)),void this.publishResponse(_)}this.logger.debug({debug:"PINService: Sending BE2 request PIN_ValidatePIN with Pin cancelled: "+(t.cancelled?"true":"false")},!0),s=r.default.createBE2BasicFunctionArr([[r.default.enumBE2BasicFunc.PIN_ValidatePIN,[parseInt(t.PIN,10),t.PIN.length,0,0]]]),this.ngxComm.sendBe2Message(s,this.doNothing.bind(this)),this.logger.debug({debug:"PINService: Setting timer interval."},!0),this.attempt=0,this.pinStatusCheckIntervalID=window.setInterval(()=>{if(++this.attempt,this.attempt>this.GET_PIN_STATUS_MAX_ATTEMPTS)window.clearInterval(this.pinStatusCheckIntervalID),this.pinStatusCheckIntervalID=0,this.logger.error({error:"PINService: getPINStatus max attempts exceeded. Publishing validatePINResp with NO_RESPONSE."},!0),this.publishResponse(f);else{this.logger.debug({debug:"PINService: Sending BE2 request PIN_GetPinStatus. Attempt number= "+this.attempt},!0);const e=r.default.createBE2BasicFunctionArr([[r.default.enumBE2BasicFunc.PIN_GetPinStatus,[0,0,0,0]]]);this.ngxComm.sendBe2Message(e,this.processValidatePINStatusResp.bind(this))}},this.GET_PIN_STATUS_INTERVAL)}}}processValidatePINStatusResp(e,t){if(e)return void this.logger.error({error:"PINService: Received an error in processValidatePINStatusResp.",data:e},!0);const s=t[r.default.BE2_BASIC_RESPONSE];if(1!==s.length||77!==s[0].functionCode)return void this.logger.error({error:"PINService: Received a BE2 response with invalid function code(s). Expected response for function code 77 - PIN_GetPinStatus.",data:t},!0);const a=s[0].retvals[0];0!==a&&(window.clearInterval(this.pinStatusCheckIntervalID),this.pinStatusCheckIntervalID=0,1===a?(this.logger.debug({debug:"PINService: PIN entered is Valid .",data:t},!0),this.publishResponse(h)):2===a?(this.logger.debug({debug:"PINService: PIN entered is Invalid .",data:t},!0),this.publishResponse(p)):3===a?(this.logger.debug({debug:"PINService: PIN is locked.",data:t},!0),this.publishResponse(g)):4===a?(this.logger.debug({info:"PINService: No Response received from BE2 for validate PIN request.",data:t},!0),this.publishResponse(f)):5===a?(this.logger.debug({debug:"PINService: No PIN entered to be canceled.",data:t},!0),this.publishResponse(_)):this.logger.error({error:"PINService: Received unknown PIN status.",data:t},!0))}cancelValidatePIN(){this.logger.debug({debug:"PINService: Sending hide message to PIN entry content."}),a.default.publish(c,{cmd:c,ver:"1.0"}),this.hidePINContent()}hidePINContent(){this.logger.debug({debug:"PINService: Hiding PIN entry content."}),document.getElementById("PinContentFrame").style.display="none"}doNothing(e,t){e?this.logger.error({error:"PINService: Received an error in doNothing.",data:e},!0):this.logger.debug({debug:"PINService: Received BE2 response.",data:t},!0)}isPinValidationTransaction(){return 0!==this.pinStatusCheckIntervalID}registerValidatePINRespCB(e){this.subscribe(o,e),this.subscribe(l,e)}registerShowPINEntryScreenCB(e){this.subscribe(u,e)}registerHidePINEntryScreenCB(e){this.subscribe(c,e)}cleanup(){void 0!==this.subscribers&&this.subscribers.forEach((function(e){a.default.unsubscribe(e.type,e.cb)})),this.overridePinIntervalId&&clearInterval(this.overridePinIntervalId),this.logger.debug({debug:"PINService: Cleaning up"},!0)}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=n(s(1)),a=n(s(2));function n(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(e,t,s,r){this.ngxComm=e,this.logger=t,this.appStore=s,this.statusMessageCache=r,this.appStoreCache=null,this.CHECK_XC_ENABLED_TOPIC="enableXtraCredit",this.CHECK_XC_ENABLED_RESP_TOPIC="enableXtraCreditResp",this.IS_XC_ACTIVE_TOPIC="isXtraCreditActive",this.IS_XC_ACTIVE_RESP_TOPIC="isXtraCreditActiveResp",this.ACTIVATE_XC_TOPIC="activateXtraCredit",this.ACTIVATE_XC_WITH_AMOUNT_TOPIC="activateXtraCreditWithAmount",this.ACTIVATE_XC_RESP_TOPIC="activateXtraCreditResp",this.CANCEL_XC_TOPIC="cancelXtraCredit",this.CANCEL_XC_RESP_TOPIC="cancelXtraCreditResp",this.enumActivateXCStatus={XC_ACTIVE:0,XC_ACTIVE_NOT_CANCELABLE:1,XC_ALREADY_ACTIVE:2,XC_INACTIVE_BALANCE_TOO_LOW:3,XC_INACTIVE_NOT_AVAILABLE_ON_DEVICE:4,XC_INACTIVE_SEE_PLAYERS_CLUB:5,XC_INACTIVE_DUPLICATE_CARD:6,XC_INACTIVE_ABANDONED_CARD:7,XC_INACTIVE_PIN_LOCKED:8,XC_INACTIVE_BONUSING_UNAVAILABLE:9,XC_INACTIVE_PIN_VALIDATION_FAILED:10,XC_INACTIVE_INPUT_AMOUNT_INVALID:11,XC_INACTIVE_OVER_LIMIT:12,XC_INACTIVE_AMOUNT_LESS_THAN_DENOM:13,XC_INACTIVE_LAST_IN_PROCESSING:14,XC_INACTIVE_ABORTED_E:15,XC_INACTIVE_FAILED_E:16,XC_INACTIVE_RETRIED_OUT:17},this.enumTransferXCStatus={PENDING:0,SUCCESS:1,ABORTED:2,FAILED:3,IN_PROGRESS:4,ABORTED_E:5,FAILED_E:6,OVER_LIMIT:255},this.enumPINStatus={VALID:1,INVALID:2,LOCKED:3,NO_RESPONSE:4,NOT_ENTERED:5},this.enumCancelXCStatus={XC_CANCELLED:0,XC_NOT_CANCELABLE:1,XC_NOT_CANCELLED_IN_GAME_CYCLE:2},this.amountInput=0,this.isAtiveWithAmount=!1,this.isAppPinRequired=!1,this.VALIDATE_PIN_TOPIC="validatePIN",this.VALIDATE_PIN_RESP_TOPIC="validatePINResp",this.checkIsActiveXCRespSubscribers=[],this.checkXCEnabledReqSubscribers=[],this.checkXCEnabledRespSubscribers=[],this.activateXCReqSubscribers=[],this.activateXCRespSubscribers=[],this.cancelXCReqSubscribers=[],this.cancelXCRespSubscribers=[],this.handleValidatePINRespSubscribers=[];let n=this.checkXCEnabled.bind(this);this.checkXCEnabledReqSubscribers.push(n),a.default.subscribe(this.CHECK_XC_ENABLED_TOPIC,n);let i=this.activateXC.bind(this);this.activateXCReqSubscribers.push(i),a.default.subscribe(this.ACTIVATE_XC_TOPIC,i);let o=this.activateXCWithAmount.bind(this);this.activateXCReqSubscribers.push(o),a.default.subscribe(this.ACTIVATE_XC_WITH_AMOUNT_TOPIC,o);let l=this.cancelXC.bind(this);this.cancelXCReqSubscribers.push(l),a.default.subscribe(this.CANCEL_XC_TOPIC,l);let u=this.isAlreadyActiveXC.bind(this);this.checkIsActiveXCRespSubscribers.push(u),a.default.subscribe(this.IS_XC_ACTIVE_TOPIC,u),this.handleValidatePINRespFn=this.handleValidatePINResp.bind(this)}isAlreadyActiveXC(){this.processIsAlreadyActiveXC()}processIsAlreadyActiveXC(){let e=this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_SEE_PLAYERS_CLUB,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_SEE_PLAYERS_CLUB]);const t={cmd:this.IS_XC_ACTIVE_RESP_TOPIC,xtraCreditActive:!1,xtraCreditRespMsg:e};this.appStoreCache=this.appStore.getAppStoreCache(),this.appStoreCache.playerBonuses.xtraCredit.active?(e.status=this.enumActivateXCStatus.XC_ALREADY_ACTIVE,e.statusMessage=this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_ALREADY_ACTIVE],t.xtraCreditActive=!0,t.xtraCreditRespMsg=e,a.default.publish(this.IS_XC_ACTIVE_RESP_TOPIC,t)):a.default.publish(this.IS_XC_ACTIVE_RESP_TOPIC,t)}checkXCEnabled(){this.processCheckXCEnabled()}processCheckXCEnabled(){this.appStoreCache=this.appStore.getAppStoreCache(),this.appStoreCache.playerBonuses.xtraCredit.enable?a.default.publish(this.CHECK_XC_ENABLED_RESP_TOPIC,this.createXCEnabledResp(this.CHECK_XC_ENABLED_RESP_TOPIC,!0)):a.default.publish(this.CHECK_XC_ENABLED_RESP_TOPIC,this.createXCEnabledResp(this.CHECK_XC_ENABLED_RESP_TOPIC,!1))}activateXC(e){const t=e.detail;void 0===t.validatePin?this.logger.error({error:"XCService: Received Activate XC request without validatePin parameter.",data:t},!0):(this.isAppPinRequired=t.validatePin,this.processActivateXC())}activateXCWithAmount(e){const t=e.detail;this.isAppPinRequired=t.validatePin,this.isAtiveWithAmount=!0,this.amountInput=t.amount,this.logger.info({info:"XCService: Received Active XC With Amount:",data:t},!0),this.processActivateXC(!0,t.amount)}processActivateXC(e=!1,t=0){this.logger.debug({info:"XCService: process Activate XC,amount:",data:t},!0);let s,n=!1,i=!1,o=!1;if(this.appStoreCache=this.appStore.getAppStoreCache(),null!==this.appStoreCache.player_info.dupCard&&!0===this.appStoreCache.player_info.dupCard&&(i=!0),null!==this.appStoreCache.player_info.isAbandoned&&!0===this.appStoreCache.player_info.isAbandoned&&(n=!0),s=this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_SEE_PLAYERS_CLUB,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_SEE_PLAYERS_CLUB]),i?(s.status=this.enumActivateXCStatus.XC_INACTIVE_DUPLICATE_CARD,s.statusMessage=this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_DUPLICATE_CARD]):n?(s.status=this.enumActivateXCStatus.XC_INACTIVE_ABANDONED_CARD,s.statusMessage=this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_ABANDONED_CARD]):this.appStoreCache.builtPatronDataCache?this.appStoreCache.machine.xcEnable?this.appStoreCache.player_info.xcEnable&&this.appStoreCache.playerBonuses.xtraCredit.enable?!e&&this.appStoreCache.playerBonuses.xtraCredit.active?(s.status=this.enumActivateXCStatus.XC_ALREADY_ACTIVE,s.statusMessage=this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_ALREADY_ACTIVE]):this.appStoreCache.playerBonuses.xtraCredit.total_balance<=0&&this.appStoreCache.playerBonuses.xtraCredit.inActiveBalance<=0?(s.status=this.enumActivateXCStatus.XC_INACTIVE_BALANCE_TOO_LOW,s.statusMessage=this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_BALANCE_TOO_LOW]):o=!0:(s.status=this.enumActivateXCStatus.XC_INACTIVE_SEE_PLAYERS_CLUB,s.statusMessage=this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_SEE_PLAYERS_CLUB]):(s.status=this.enumActivateXCStatus.XC_INACTIVE_NOT_AVAILABLE_ON_DEVICE,s.statusMessage=this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_NOT_AVAILABLE_ON_DEVICE]):(s.status=this.enumActivateXCStatus.XC_INACTIVE_BONUSING_UNAVAILABLE,s.statusMessage=this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_BONUSING_UNAVAILABLE]),o){if(this.appStoreCache.pin.locked){const e=r.default.createBE2BasicFunctionArr([[r.default.enumBE2BasicFunc.PIN_NotEntered,[0,0,0,0]]]);return this.ngxComm.sendBe2Message(e,this.doNothing.bind(this)),s.status=this.enumActivateXCStatus.XC_INACTIVE_PIN_LOCKED,s.statusMessage=this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_PIN_LOCKED],void a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,s)}if(this.appStoreCache.pin.check_pin_needed||this.appStoreCache.pin.force_pin)return this.logger.info({info:"XCService: PIN required. Validating PIN.",data:null},!0),a.default.unsubscribe(this.VALIDATE_PIN_RESP_TOPIC,this.handleValidatePINRespFn),a.default.subscribe(this.VALIDATE_PIN_RESP_TOPIC,this.handleValidatePINRespFn),void a.default.publish(this.VALIDATE_PIN_TOPIC,this.createValidatePINReq());this.sendActivateXCResp(e,t)}else a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,s)}doNothing(e,t){e&&this.logError("doNothing",e)}doStatusPolling(){const e=r.default.enumBE2BasicFunc.CancelXtraCredit,t=r.default.createBE2BasicFunctionArr([[e,[0,0,0,0]]]);let s,n=!1,i=0;s=setInterval(()=>{if(++i>30)return clearInterval(s),void a.default.publish(this.CANCEL_XC_RESP_TOPIC,this.createXCResp(this.CANCEL_XC_RESP_TOPIC,this.enumCancelXCStatus.XC_NOT_CANCELLED_IN_GAME_CYCLE,this.statusMessageCache.xtraCredit.cancel[this.enumCancelXCStatus.XC_NOT_CANCELLED_IN_GAME_CYCLE]));(1===i||n)&&(n=!1,this.ngxComm.sendBe2Message(t,((e,t)=>{const i=t[r.default.BE2_BASIC_RESPONSE][0].retvals;return 0===i[0]?(this.logger.debug({debug:"XCService: Xtra Credit cancelled from status polling.",data:""},!0),clearInterval(s),void a.default.publish(this.CANCEL_XC_RESP_TOPIC,this.createXCResp(this.CANCEL_XC_RESP_TOPIC,this.enumCancelXCStatus.XC_CANCELLED,this.statusMessageCache.xtraCredit.cancel[this.enumCancelXCStatus.XC_CANCELLED]))):1===i[0]?(this.logger.debug({debug:"XCService: Xtra Credit not cancelable, in game cycle from status polling.",data:""},!0),clearInterval(s),void a.default.publish(this.CANCEL_XC_RESP_TOPIC,this.createXCResp(this.CANCEL_XC_RESP_TOPIC,this.enumCancelXCStatus.XC_NOT_CANCELABLE,this.statusMessageCache.xtraCredit.cancel[this.enumCancelXCStatus.XC_NOT_CANCELABLE]))):void(n=!0)}).bind(this)))},1e3)}doCashlessStatusPolling(){const e=r.default.enumBE2BasicFunc.Cashless_GetStatus,t=r.default.createBE2BasicFunctionArr([[e,[0,0,0,0]]]);let s,n=!1,i=0;s=setInterval(()=>{if(++i>30)return clearInterval(s),void a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_RETRIED_OUT,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_RETRIED_OUT]));(1===i||n)&&(n=!1,this.ngxComm.sendBe2Message(t,((e,t)=>{const i=t[r.default.BE2_BASIC_RESPONSE][0].retvals;if(i[0]!==this.enumTransferXCStatus.PENDING)return i[0]===this.enumTransferXCStatus.SUCCESS?(this.logger.debug({debug:"XCService: Xtra Credit is successfully activated. by CashlessStatus Polling.",data:""},!0),clearInterval(s),void this.checkCancellableResp()):i[0]===this.enumTransferXCStatus.ABORTED?(this.logger.debug({debug:"XCService: Fail to activate Xtra Credit, Reason: Input Amount is less than machine denom. by CashlessStatus Polling.",data:""},!0),clearInterval(s),void a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_AMOUNT_LESS_THAN_DENOM,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_AMOUNT_LESS_THAN_DENOM]))):i[0]===this.enumTransferXCStatus.IN_PROGRESS?(this.logger.debug({debug:"XCService: Fail to activate Xtra Credit, Reason: Last one is still in processing. by CashlessStatus Polling.",data:""},!0),clearInterval(s),void a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_LAST_IN_PROCESSING,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_LAST_IN_PROCESSING]))):i[0]===this.enumTransferXCStatus.OVER_LIMIT?(this.logger.debug({debug:"Xtra Credit can not be activated by over limit",data:""},!0),clearInterval(s),void a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_OVER_LIMIT,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_OVER_LIMIT]))):i[0]===this.enumTransferXCStatus.ABORTED_E?(this.logger.debug({debug:"Xtra Credit can not be activated by aborted_e",data:""},!0),clearInterval(s),void a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_ABORTED_E,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_ABORTED_E]))):i[0]===this.enumTransferXCStatus.FAILED_E?(this.logger.debug({debug:"Xtra Credit can not be activated by failed_e",data:""},!0),clearInterval(s),void a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_FAILED_E,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_FAILED_E]))):(this.logger.debug({debug:"XCService: Xtra Credit can not be activated  by CashlessStatus Polling.",data:""},!0),clearInterval(s),void a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_SEE_PLAYERS_CLUB,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_SEE_PLAYERS_CLUB])));this.logger.debug({debug:"XCService: It is pending, still need to poll status by Cashless_GetStatus",data:""},!0),n=!0}).bind(this)))},1e3)}cancelXC(){this.logger.debug({debug:"XCService: Sending BE2 Basic Function request CancelXtraCredit.",data:""},!0);const e=r.default.enumBE2BasicFunc.CancelXtraCredit,t=r.default.createBE2BasicFunctionArr([[e,[0,0,0,0]]]);this.ngxComm.sendBe2Message(t,this.processCancelXC.bind(this))}processCancelXC(e,t){let s;0!==(s=t[r.default.BE2_BASIC_RESPONSE]).length?s.forEach(e=>{switch(e.functionCode){case r.default.enumBE2BasicFunc.CancelXtraCredit:2===e.retvals[0]?this.doStatusPolling():0===e.retvals[0]?(this.logger.debug({debug:"XCService: Xtra Credit cancelled.",data:""},!0),a.default.publish(this.CANCEL_XC_RESP_TOPIC,this.createXCResp(this.CANCEL_XC_RESP_TOPIC,this.enumCancelXCStatus.XC_CANCELLED,this.statusMessageCache.xtraCredit.cancel[this.enumCancelXCStatus.XC_CANCELLED]))):1===e.retvals[0]&&(this.logger.debug({debug:"XCService: Xtra Credit not cancelable, in game cycle.",data:""},!0),a.default.publish(this.CANCEL_XC_RESP_TOPIC,this.createXCResp(this.CANCEL_XC_RESP_TOPIC,this.enumCancelXCStatus.XC_NOT_CANCELABLE,this.statusMessageCache.xtraCredit.cancel[this.enumCancelXCStatus.XC_NOT_CANCELABLE])));break;default:this.logger.debug({debug:"XCService: Unknown BE2Response!",data:t},!0)}}):this.logger.debug({debug:"XCService: No BE2 responses.",data:t},!0)}processTransferXC(e,t){let s;0!==(s=t[r.default.BE2_BASIC_RESPONSE]).length?s.forEach(e=>{switch(e.functionCode){case r.default.enumBE2BasicFunc.TransferXtraCredit:let s=e.retvals[0];if(s===this.enumTransferXCStatus.SUCCESS)return this.logger.debug({debug:"XCService: Xtra Credit is successfully activated.",data:""},!0),void this.checkCancellableResp();if(s!==this.enumTransferXCStatus.PENDING)return s===this.enumTransferXCStatus.ABORTED?(this.logger.debug({debug:"XCService: Fail to activate Xtra Credit, Reason: Input Amount is less than machine denom. by CashlessStatus Polling.",data:""},!0),void a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_AMOUNT_LESS_THAN_DENOM,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_AMOUNT_LESS_THAN_DENOM]))):s===this.enumTransferXCStatus.IN_PROGRESS?(this.logger.debug({debug:"XCService: Fail to activate Xtra Credit, Reason: Last one is still in processing. by CashlessStatus Polling.",data:""},!0),void a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_LAST_IN_PROCESSING,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_LAST_IN_PROCESSING]))):s===this.enumTransferXCStatus.OVER_LIMIT?(this.logger.debug({debug:"Xtra Credit can not be activated by over limit",data:""},!0),void a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_OVER_LIMIT,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_OVER_LIMIT]))):s===this.enumTransferXCStatus.ABORTED_E?(this.logger.debug({debug:"Xtra Credit can not be activated by aborted_e",data:""},!0),void a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_ABORTED_E,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_ABORTED_E]))):s===this.enumTransferXCStatus.FAILED_E?(this.logger.debug({debug:"Xtra Credit can not be activated by failed_e",data:""},!0),void a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_FAILED_E,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_FAILED_E]))):(this.logger.debug({debug:"XCService: Xtra Credit can not be activated  by CashlessStatus Polling.",data:""},!0),void a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_SEE_PLAYERS_CLUB,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_SEE_PLAYERS_CLUB])));this.logger.debug({debug:"XCService: Pending status, need to poll status by Cashless_GetStatus till getting result.",data:""},!0),this.doCashlessStatusPolling();break;default:this.logger.debug({debug:"Unknown BE2Response!",data:t},!0)}}):this.logger.debug({debug:"XCService: No BE2 responses.",data:t},!0)}checkCancellableResp(){this.appStoreCache=this.appStore.getAppStoreCache();let e=this.appStoreCache.playerBonuses.xtraCredit.cancellable;e<2?(this.logger.debug({debug:"XCService: Sending activateXCResp, but cancellation is either not supported (0) or not allowed (1). See data field for value.",data:e},!0),a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_ACTIVE_NOT_CANCELABLE,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_ACTIVE_NOT_CANCELABLE]))):(this.logger.debug({debug:"XCService: Sending activateXCResp, Xtra Credit cancellation is supported.",data:""},!0),a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_ACTIVE,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_ACTIVE])))}handleValidatePINResp(e){const t=e.detail;this.logger.info({info:"XCService: PIN validation response received.",data:t},!0),t.status!==this.enumPINStatus.VALID&&t.status!==this.enumPINStatus.LOCKED&&t.status!==this.enumPINStatus.NO_RESPONSE&&t.status!==this.enumPINStatus.NOT_ENTERED||a.default.unsubscribe(this.VALIDATE_PIN_RESP_TOPIC,this.handleValidatePINRespFn),t.status===this.enumPINStatus.VALID?(this.sendActivateXCResp(this.isAtiveWithAmount,this.amountInput),this.isAtiveWithAmount=!1,this.amountInput=0):t.status===this.enumPINStatus.LOCKED?a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_PIN_LOCKED,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_PIN_LOCKED])):a.default.publish(this.ACTIVATE_XC_RESP_TOPIC,this.createXCResp(this.ACTIVATE_XC_RESP_TOPIC,this.enumActivateXCStatus.XC_INACTIVE_PIN_VALIDATION_FAILED,this.statusMessageCache.xtraCredit.activate[this.enumActivateXCStatus.XC_INACTIVE_PIN_VALIDATION_FAILED]))}sendActivateXCResp(e=!1,t=0){if(e){this.logger.debug({debug:"XCService: Sending BE2 Basic Function request TransferXtraCredit, the amount is:",data:parseInt(t)},!0);const e=r.default.enumBE2BasicFunc.TransferXtraCredit,s=r.default.createBE2BasicFunctionArr([[e,[0,parseInt(t),1,1]]]);this.ngxComm.sendBe2Message(s,this.processTransferXC.bind(this))}else{this.checkCancellableResp(),this.logger.debug({debug:"XCService: Sending BE2 Basic Function request MoveCredits.",data:""},!0);const e=r.default.enumBE2BasicFunc.MoveCredits,t=r.default.createBE2BasicFunctionArr([[e,[0,0,0,0]]]);this.ngxComm.sendBe2Message(t,this.doNothing.bind(this))}}createXCEnabledResp(e,t){return{cmd:e,ver:"1.0",xtraCreditEnabled:t}}createValidatePINReq(){return{cmd:"validatePIN",ver:"1.0"}}createXCResp(e,t,s){return{cmd:e,ver:"1.0",status:t,statusMessage:s}}registerIsActiveXCRespCB(e){this.checkIsActiveXCRespSubscribers.push(e),a.default.subscribe(this.IS_XC_ACTIVE_RESP_TOPIC,e)}registerEnableXtraCreditRespCB(e){this.checkXCEnabledRespSubscribers.push(e),a.default.subscribe(this.CHECK_XC_ENABLED_RESP_TOPIC,e)}registerActivateXtraCreditRespCB(e){this.activateXCRespSubscribers.push(e),a.default.subscribe(this.ACTIVATE_XC_RESP_TOPIC,e)}registerCancelXtraCreditRespCB(e){this.cancelXCRespSubscribers.push(e),a.default.subscribe(this.CANCEL_XC_RESP_TOPIC,e)}cleanup(){void 0!==this.checkIsActiveXCRespSubscribers&&this.checkIsActiveXCRespSubscribers.forEach(e=>{a.default.unsubscribe(this.IS_XC_ACTIVE_RESP_TOPIC,e)}),void 0!==this.checkXCEnabledReqSubscribers&&this.checkXCEnabledReqSubscribers.forEach(e=>{a.default.unsubscribe(this.CHECK_XC_ENABLED_TOPIC,e)}),void 0!==this.checkXCEnabledRespSubscribers&&this.checkXCEnabledRespSubscribers.forEach(e=>{a.default.unsubscribe(this.CHECK_XC_ENABLED_RESP_TOPIC,e)}),void 0!==this.activateXCReqSubscribers&&this.activateXCReqSubscribers.forEach(e=>{a.default.unsubscribe(this.ACTIVATE_XC_TOPIC,e)}),void 0!==this.activateXCRespSubscribers&&this.activateXCRespSubscribers.forEach(e=>{a.default.unsubscribe(this.ACTIVATE_XC_RESP_TOPIC,e)}),void 0!==this.cancelXCReqSubscribers&&this.cancelXCReqSubscribers.forEach(e=>{a.default.unsubscribe(this.CANCEL_XC_TOPIC,e)}),void 0!==this.cancelXCRespSubscribers&&this.cancelXCRespSubscribers.forEach(e=>{a.default.unsubscribe(this.CANCEL_XC_RESP_TOPIC,e)}),void 0!==this.handleValidatePINRespSubscribers&&this.handleValidatePINRespSubscribers.forEach(e=>{a.default.unsubscribe(this.VALIDATE_PIN_RESP_TOPIC,e)}),this.logger.debug({debug:"XCService: Cleaning up"},!0)}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=n(s(1)),a=n(s(2));function n(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(e,t,s){this.ngxComm=e,this.logger=t,this.appStore=s,this.appStoreCache=null,this.CHECK_PP_ENABLED_RESP_TOPIC="enablePointPlayResp",this.INITIATE_PP_INIT_TOPIC="initPointPlay",this.INITIATE_PP_INIT_RESP_TOPIC="initPointPlayResp",this.CONVERT_PP_TOPIC="convertPointPlay",this.CONVERT_PP_RESP_TOPIC="convertPointPlayResp",this.CMD_VERS="1.0",this.enumInitiatePPStatus={PP_AVAILABLE:0,PP_NOT_AVAILABLE_EGM:1,PP_NOT_AVAILABLE_PINLOCK:2,PP_NOT_AVAILABLE_GOTO_BOOTH:3,PP_NOT_AVAILABLE_BALANCE_LOW:4,PP_NOT_AVAILABLE_CANNOT_CONVERT_XTRACREDIT:5,PP_NOT_AVAILABLE_CANNOT_CONVERT_XTRACREDIT_EGM:6,PP_NOT_AVAILABLE_PIN_FAILED:7,PP_NOT_AVAILABLE:8},this.enumPINStatus={VALID:1,INVALID:2,LOCKED:3,NO_RESPONSE:4,NOT_ENTERED:5},this.convertPointsToCredit=!1,this.isAppPinRequired=!1,this.VALIDATE_PIN_TOPIC="validatePIN",this.VALIDATE_PIN_RESP_TOPIC="validatePINResp",this.ENABLE_PP_TOPIC="enablePointPlay",this.checkPPEnabledRespSubscribers=[],this.convertPPReqSubscribers=[],this.convertPPRespSubscribers=[],this.initiatePPReqSubscribers=[],this.initiatePPRespSubscribers=[];let r=this.convertPP.bind(this);this.convertPPReqSubscribers.push(r),a.default.subscribe(this.CONVERT_PP_TOPIC,r);let n=this.initiatePP.bind(this);this.initiatePPReqSubscribers.push(n),a.default.subscribe(this.INITIATE_PP_INIT_TOPIC,n),this.handleValidatePINRespFn=this.handleValidatePINResp.bind(this),a.default.subscribe(this.ENABLE_PP_TOPIC,this.checkPPEnabled.bind(this))}checkPPEnabled(){this.processCheckPPEnabledResp()}processCheckPPEnabledResp(){const e={cmd:"enablePointPlayResp",ver:"1.0",pointPlayEnabled:!1};this.appStoreCache=this.appStore.getAppStoreCache(),this.appStoreCache.playerBonuses.pointPlay.enable?(this.logger.debug({debug:"PPService: Point Play is available.",data:e},!0),e.pointPlayEnabled=!0):this.logger.debug({debug:"PPService: Point Play NOT available.",data:e},!0),a.default.publish(this.CHECK_PP_ENABLED_RESP_TOPIC,e)}createInitPPResponse(){return{cmd:this.INITIATE_PP_INIT_RESP_TOPIC,ver:this.CMD_VERS,playerPointBalance:0,pointValue:0,pointCredits:0,status:0}}convertPinStatus(e){return e===this.enumPINStatus.LOCKED?this.enumInitiatePPStatus.PP_NOT_AVAILABLE_PINLOCK:this.enumInitiatePPStatus.PP_NOT_AVAILABLE_PIN_FAILED}handleValidatePINResp(e){const t=e.detail;this.logger.info({info:"PPService: PIN validation response received.",data:t},!0),t.status!==this.enumPINStatus.VALID&&t.status!==this.enumPINStatus.LOCKED&&t.status!==this.enumPINStatus.NO_RESPONSE&&t.status!==this.enumPINStatus.NOT_ENTERED||a.default.unsubscribe(this.VALIDATE_PIN_RESP_TOPIC,this.handleValidatePINRespFn);const s=this.createInitPPResponse();t.status!==this.enumPINStatus.VALID?(s.status=this.convertPinStatus(t.status),a.default.publish(this.INITIATE_PP_INIT_RESP_TOPIC,s)):this.sendBe2MsgToGetPlayerPoints()}sendBe2MsgToGetPlayerPoints(){this.processInitiatePPResp()}processInitiatePPResp(){let e,t;this.appStoreCache=this.appStore.getAppStoreCache();let s=this.appStoreCache.playerBonuses.pointPlay.available_balance,r=this.appStoreCache.playerBonuses.pointPlay.available_balance_in_Cents,n=this.appStoreCache.playerBonuses.pointPlay.available_balance_in_Credits,i=this.appStoreCache.playerBonuses.pointPlay.points_Limit,o=this.appStoreCache.playerBonuses.pointPlay.points_Limit_Credits,l=this.appStoreCache.playerBonuses.xtraCredit.game_based||this.appStoreCache.playerBonuses.xtraCredit.player_based,u=this.appStoreCache.machine.denom;return t=this.createInitPPResponse(),this.convertPointsToCredit||l?0===i&&4e9===o?(t.status=this.enumInitiatePPStatus.PP_NOT_AVAILABLE_GOTO_BOOTH,void a.default.publish(this.INITIATE_PP_INIT_RESP_TOPIC,t)):r<(e=u<this.appStore.minEgmDenom?this.appStore.getDefaultMinCentsBalance():this.appStore.getMapEgmDenomToMinCentsBalance(u))?(t.status=this.enumInitiatePPStatus.PP_NOT_AVAILABLE_BALANCE_LOW,void a.default.publish(this.INITIATE_PP_INIT_RESP_TOPIC,t)):(t.egmDenom=u,t.playerPointBalance=s,t.pointValue=r,t.pointCredits=n,t.status=this.enumInitiatePPStatus.PP_AVAILABLE,void a.default.publish(this.INITIATE_PP_INIT_RESP_TOPIC,t)):(t.status=this.enumInitiatePPStatus.PP_NOT_AVAILABLE_CANNOT_CONVERT_XTRACREDIT_EGM,void a.default.publish(this.INITIATE_PP_INIT_RESP_TOPIC,t))}initiatePP(e){const t=e.detail;this.convertPointsToCredit=t.convertPointsToCredits,this.isAppPinRequired=t.validatePin,this.processCheckExecuteResp()}processCheckExecuteResp(){let e,t,s,n;if(this.appStoreCache=this.appStore.getAppStoreCache(),s=!!this.appStoreCache.playerBonuses.pointPlay.enable,e=!!this.appStoreCache.player_info.isAbandoned,t=!!this.appStoreCache.player_info.dupCard,n=this.createInitPPResponse(),e||t)return this.logger.debug({debug:"PPService: Card is a duplicate or the card is abandoned.",data:""},!0),n.status=this.enumInitiatePPStatus.PP_NOT_AVAILABLE_GOTO_BOOTH,void a.default.publish(this.INITIATE_PP_INIT_RESP_TOPIC,n);if(!s)return n.status=this.enumInitiatePPStatus.PP_NOT_AVAILABLE,this.logger.debug({debug:"PPService: PP is NOT available.",data:n},!0),void a.default.publish(this.INITIATE_PP_INIT_RESP_TOPIC,n);if(this.appStoreCache.pin.locked){const e=r.default.createBE2BasicFunctionArr([[r.default.enumBE2BasicFunc.PIN_NotEntered,[0,0,0,0]]]);return this.ngxComm.sendBe2Message(e,this.doNothing.bind(this)),n.status=this.enumInitiatePPStatus.PP_NOT_AVAILABLE_PINLOCK,void a.default.publish(this.INITIATE_PP_INIT_RESP_TOPIC,n)}if(this.appStoreCache.pin.force_pin||this.appStoreCache.pin.check_pin_needed){this.logger.info({info:"PPService: PIN required. Validating PIN.",data:null},!0),a.default.unsubscribe(this.VALIDATE_PIN_RESP_TOPIC,this.handleValidatePINRespFn),a.default.subscribe(this.VALIDATE_PIN_RESP_TOPIC,this.handleValidatePINRespFn);const e={cmd:"validatePIN",ver:this.CMD_VERS};a.default.publish(this.VALIDATE_PIN_TOPIC,e)}else this.sendBe2MsgToGetPlayerPoints()}doNothing(e,t){e&&this.logger.error({error:"PPService: Received err in doNothing",data:e},!0)}convertPP(e){const t=e.detail,s={cmd:"convertPointPlayResp",ver:"1.0",status:1};if(void 0===t.convertPointsToCredits||void 0===t.pointsToConvert)this.logger.error({error:"PPService: Received Convert Points request with invalid parameters.",data:t},!0),a.default.publish(this.CONVERT_PP_RESP_TOPIC,s);else if(t.pointsToConvert<=0)this.logger.error({error:"PPService: Received Convert Points request with invalid pointsToConvert parameter.",data:t},!0),a.default.publish(this.CONVERT_PP_RESP_TOPIC,s);else{let e;t.convertPointsToCredits?(this.logger.debug({debug:"PPService: Sending BE2 Basic Function request MP_PointsToCash.",data:""},!0),e=r.default.enumBE2BasicFunc.MP_PointsToCash):(this.logger.debug({debug:"PPService: Sending BE2 Basic Function request MP_PointsToXtraCredits.",data:""},!0),e=r.default.enumBE2BasicFunc.MP_PointsToXtraCredits);const s=r.default.createBE2BasicFunctionArr([[e,[t.pointsToConvert,0,0,0]]]);this.ngxComm.sendBe2Message(s,this.processConvertPPResp.bind(this))}}processConvertPPResp(e,t){const s={cmd:"convertPointPlayResp",ver:"1.0",status:2};if(e)this.logger.error({error:"PPService: Received an error in processConvertPPResp.",data:e},!0);else{const e=t[r.default.BE2_BASIC_RESPONSE];1!==e.length||26!==e[0].functionCode&&70!==e[0].functionCode?this.logger.error({error:"PPService: Received a BE2 response with invalid function code(s).",data:t},!0):(this.logger.debug({debug:"PPService: Points converted.",data:t},!0),s.status=0)}a.default.publish(this.CONVERT_PP_RESP_TOPIC,s)}registerEnablePointPlayRespCB(e){this.checkPPEnabledRespSubscribers.push(e),a.default.subscribe(this.CHECK_PP_ENABLED_RESP_TOPIC,e)}registerInitiatePointPlayRespCB(e){this.initiatePPRespSubscribers.push(e),a.default.subscribe(this.INITIATE_PP_INIT_RESP_TOPIC,e)}registerConvertPPRespCB(e){this.convertPPRespSubscribers.push(e),a.default.subscribe(this.CONVERT_PP_RESP_TOPIC,e)}cleanup(){this.checkPPEnabledRespSubscribers&&this.checkPPEnabledRespSubscribers.forEach(e=>{a.default.unsubscribe(this.CHECK_PP_ENABLED_RESP_TOPIC,e)}),this.initiatePPReqSubscribers&&this.initiatePPReqSubscribers.forEach(e=>{a.default.unsubscribe(this.INITIATE_PP_INIT_TOPIC,e)}),this.initiatePPRespSubscribers&&this.initiatePPRespSubscribers.forEach(e=>{a.default.unsubscribe(this.INITIATE_PP_INIT_RESP_TOPIC,e)}),this.convertPPReqSubscribers&&this.convertPPReqSubscribers.forEach(e=>{a.default.unsubscribe(this.CONVERT_PP_TOPIC,e)}),this.convertPPRespSubscribers&&this.convertPPRespSubscribers.forEach(e=>{a.default.unsubscribe(this.CONVERT_PP_RESP_TOPIC,e)}),this.logger.debug({debug:"PPService: Cleaning up."},!0)}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=n(s(1)),a=n(s(2));function n(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(e,t,s){this.ngxComm=e,this.logger=t,this.appStore=s,this.CHECK_CASHLESS_ENABLED_TOPIC="checkCashlessEnabled",this.CHECK_CASHLESS_ENABLED_RESP_TOPIC="checkCashlessEnabledResp",this.GET_CASHLESS_BALANCE_TOPIC="getCashlessBalance",this.GET_CASHLESS_BALANCE_RESP_TOPIC="getCashlessBalanceResp",this.INITIATE_CASHLESS_TRANSFER_FROM_GAME_TOPIC="initiateTransferFromEgm",this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC="initiateTransferResp",this.INITIATE_CASHLESS_TRANSFER_FROM_CARD_TOPIC="initiateTransferFromCard",this.VALIDATE_PIN_TOPIC="validatePIN",this.VALIDATE_PIN_RESP_TOPIC="validatePINResp",this.GET_CASHLESS_STATUS_MAX_ATTEMPTS=30,this.GET_CASHLESS_STATUS_INTERVAL=1e3,this.enumCashlessResult={TRANSFER_PENDING:0,TRANSFER_SUCCESS:1,TRANSFER_ABORTED:2,TRANSFER_FAILED:3,TRANSFER_ABORTED_OPERATION_STARTED:5,TRANSFER_FAILED_OPERATION_STARTED:6},this.enumCashlessTransferStatus={SUCCESSFUL_OPERATION:0,ABORTED_OPERATION:1,FAILED_OPERATION:2,ABORTED_OPERATION_STARTED:3,FAILED_OPERATION_STARTED:4,FAILED_OTHER_REASON:5,TIMEOUT:6,UNLOCK_SUCCESSFUL:7,CREDITS_EXIST:8,GAME_IN_PROGRESS:9,UNLOCK_FAILED_OTHER_REASON:10,INVALID_TRANSFER_REQUEST:11,REQUESTED_AMOUNT_TO_LOW:12,REQUESTED_AMOUNT_LESS_THAN_MIN_FR:13,REQUESTED_AMOUNT_GREATER_THAN_MAX_FR:14,REQUESTED_AMOUNT_EXCEEDS_CARD_BALANCE:15,CARD_BALANCE_TOO_LOW:16,REQUESTED_AMOUNT_LESS_THAN_MIN_TO:17,REQUESTED_AMOUNT_GREATER_THAN_MAX_TO:18,PIN_LOCKED:19,PIN_VALIDATION_FAILED:20},this.enumXferDirection={INVALID_DIRECTION:0,XFER_FROM_GAME:1,XFER_FROM_CARD:2},this.enumPINStatus={VALID:1,INVALID:2,LOCKED:3,NO_RESPONSE:4,NOT_ENTERED:5},this.GET_AUTOPLAY_STATUS_MAX_ATTEMPTS=5,this.GET_AUTOPLAY_STATUS_INTERVAL=1e3,this.SET_EJECT_CARD_MAX_ATTEMPTS=6,this.SET_EJECT_CARD_INTERVAL=5e3,this.cashlessCheckResp1=!1,this.cashlessCheckResp2=!1,this.transferStatusCount=0,this.cashlessStatusCheckIntervalID=0,this.transferAmount=0,this.cashoutRequest=!1,this.ejectCard=!1,this.disableAutoPlay=!1,this.getAutoPlayStatusCount=0,this.getAutoPlayStatusCheckIntervalID=0,this.allowTransferOverMaxBal=!1,this.validatePin=!0,this.xferDirection=this.enumXferDirection.INVALID_DIRECTION,this.enumBE2Func=r.default.enumBE2BasicFunc,this.checkCashlessEnabledSubscribers=[],this.checkCashlessEnabledSubscribersResp=[],this.getCashlessBalanceSubscribers=[],this.getCashlessBalanceSubscribersResp=[],this.getInitiateTransferFromSubscribers=[],this.getInitiateTransferToSubscribers=[],this.getInitiateTransferSubscribersResp=[],this.handleValidatePINRespFn=this.handleValidatePINResp.bind(this);let n=this.checkCashlessEnabled.bind(this);this.checkCashlessEnabledSubscribers.push(n),a.default.subscribe(this.CHECK_CASHLESS_ENABLED_TOPIC,n);let i=this.getCashlessBalances.bind(this);this.getCashlessBalanceSubscribers.push(i),a.default.subscribe(this.GET_CASHLESS_BALANCE_TOPIC,i);let o=this.initiateTransferFromGame.bind(this);this.getInitiateTransferFromSubscribers.push(o),a.default.subscribe(this.INITIATE_CASHLESS_TRANSFER_FROM_GAME_TOPIC,o);let l=this.initiateTransferFromCard.bind(this);this.getInitiateTransferToSubscribers.push(l),a.default.subscribe(this.INITIATE_CASHLESS_TRANSFER_FROM_CARD_TOPIC,l)}checkCashlessEnabled(){this.processCheckCashlessEnabledResp()}processCheckCashlessEnabledResp(){const e={cmd:"checkCashlessEnabledResp",ver:"1.0",enabled:!1,responseData:{cardType:0,bonusing:!1,haveData:!1,haveLock:!1,gameEnabled:!1,coinlessAvailable:!1,balanceActive:!1,cashlessEnabled:!1,abandonedStatus:!1,haveCTSData:!1,haveCardData:!1,coinlessEnabled:!1}};let t=this.appStore.getAppStoreCache();e.enabled=t.playerBonuses.cashless.enable,e.responseData.cardType=t.playerBonuses.cashless.cardType,e.responseData.abandonedStatus=t.player_info.isAbandoned,e.responseData.bonusing=t.playerBonuses.cashless.flags.bonusing,e.responseData.haveData=t.playerBonuses.cashless.flags.haveData,e.responseData.haveLock=t.playerBonuses.cashless.flags.haveLock,e.responseData.gameEnabled=t.playerBonuses.cashless.flags.gameEnabled,e.responseData.coinlessAvailable=t.playerBonuses.cashless.flags.coinlessAvailable,e.responseData.balanceActive=t.playerBonuses.cashless.flags.balanceActive,e.responseData.cashlessEnabled=t.playerBonuses.cashless.flags.cashlessEnabled,e.responseData.haveCTSData=t.playerBonuses.cashless.flags.haveCTSData,e.responseData.haveCardData=t.playerBonuses.cashless.flags.haveCardData,e.responseData.coinlessEnabled=t.playerBonuses.cashless.flags.coinlessEnabled,!0===t.player_info.isAbandoned?(e.enabled=!1,this.logger.debug({debug:"CashlessService: Cashless is NOT available Card is abandoned",data:e},!0)):e.enabled?this.logger.debug({debug:"CashlessService: Cashless is available",data:e},!0):this.logger.debug({debug:"CashlessService: Cashless is NOT available.",data:e},!0),a.default.publish(this.CHECK_CASHLESS_ENABLED_RESP_TOPIC,e)}getCashlessBalances(){this.logger.debug({debug:"CashlessService: Sending BE2 Basic Function request [GetCashlessParameters, MP_GetEgmDenom].",data:""},!0);const e=[[this.enumBE2Func.GetCashlessParameters,[0,0,0,0]],[this.enumBE2Func.MP_GetEgmDenom,[0,0,0,0]]],t=r.default.createBE2BasicFunctionArr(e);this.ngxComm.sendBe2Message(t,this.processGetCashlessBalanceResp.bind(this))}processGetCashlessBalanceResp(e,t){const s={cmd:"getCashlessBalanceResp",ver:"1.0",cashlessBalances:{cardCents:0,egmCents:0,minToEgm:0,maxToEgm:0,minFrEgm:0,maxFrEgm:0,maxCardBal:0,egmDenom:0}};if(e)this.logger.error({error:"CashlessService: Received an error in processGetCashlessBalanceResp.",data:e},!0);else{let e,n=this.appStore.getAppStoreCache();if(s.cashlessBalances.minToEgm=n.playerBonuses.cashless.transferLimits.minToEgm,s.cashlessBalances.maxToEgm=n.playerBonuses.cashless.transferLimits.maxToEgm,s.cashlessBalances.minFrEgm=n.playerBonuses.cashless.transferLimits.minFrEgm,s.cashlessBalances.maxFrEgm=n.playerBonuses.cashless.transferLimits.maxFrEgm,s.cashlessBalances.maxCardBal=n.playerBonuses.cashless.transferLimits.maxBal,0===(e=t[r.default.BE2_BASIC_RESPONSE]).length)return void this.logger.debug({debug:"CashlessService: No BE2 responses.",data:t},!0);e.forEach(e=>{switch(e.functionCode){case this.enumBE2Func.GetCashlessParameters:s.cashlessBalances.cardCents=e.retvals[0],s.cashlessBalances.egmCents=e.retvals[1],n.playerBonuses.cashless.balances.cardCents=e.retvals[0],n.playerBonuses.cashless.balances.egmCents=e.retvals[1];break;case this.enumBE2Func.MP_GetEgmDenom:s.cashlessBalances.egmDenom=e.retvals[0],n.playerBonuses.cashless.balances.egmDenom=e.retvals[0];break;default:this.logger.debug({debug:"Unknown BE2Response!",data:""},!0)}}),a.default.publish(this.GET_CASHLESS_BALANCE_RESP_TOPIC,s)}}doNothing(e,t){e&&this.logError("doNothing",e)}handleValidatePINResp(e){const t=e.detail;this.logger.info({info:"CashlessService: PIN validation response received.",data:t},!0),t.status!==this.enumPINStatus.VALID&&t.status!==this.enumPINStatus.LOCKED&&t.status!==this.enumPINStatus.NO_RESPONSE&&t.status!==this.enumPINStatus.NOT_ENTERED||a.default.unsubscribe(this.VALIDATE_PIN_RESP_TOPIC,this.handleValidatePINRespFn),t.status===this.enumPINStatus.VALID?this.xferDirection===this.enumXferDirection.XFER_FROM_GAME?this.completeXferFromGame():this.xferDirection===this.enumXferDirection.XFER_FROM_CARD&&this.completeXferFromCard():t.status===this.enumPINStatus.INVALID?this.logger.debug({info:"CashlessService: PIN validation response received as INVALID",data:t},!0):a.default.publish(this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC,this.createInitiateTransferInvalidRequestResp(this.enumCashlessTransferStatus.PIN_VALIDATION_FAILED))}initiateTransferFromGame(e){const t=e.detail;this.transferAmount=t.amount,this.cashoutRequest=t.cashoutRequest,this.disableAutoPlay=t.smartCard.autoPlayInUse,this.ejectCard=t.smartCard.ejectCard,this.allowTransferOverMaxBal=t.allowTransferOverMaxBal,this.validatePin=t.validatePin;const s=[[this.enumBE2Func.GetCashlessParameters,[0,0,0,0]]],n=r.default.createBE2BasicFunctionArr(s);this.ngxComm.sendBe2Message(n,(e,t)=>{if(e)return void this.logger.error({error:"CashlessService: Received an error in initiateTransferFromGame.",data:e},!0);const s=t[r.default.BE2_BASIC_RESPONSE];if(0===s.length)return void this.logger.debug({debug:"CashlessService: No BE2 responses.",data:t},!0);let n=this.appStore.getAppStoreCache(),i=n.playerBonuses.cashless.transferLimits.minFrEgm,o=n.playerBonuses.cashless.transferLimits.maxBal,l=null,u=null;if(s.forEach(e=>{switch(e.functionCode){case this.enumBE2Func.GetCashlessParameters:l=e.retvals[0],u=e.retvals[1],n.playerBonuses.cashless.balances.cardCents=e.retvals[0],n.playerBonuses.cashless.balances.egmCents=e.retvals[1];break;default:this.logger.debug({debug:"Unknown BE2Response!",data:""},!0)}},this),void 0!==this.cashoutRequest&&!0===this.cashoutRequest&&(this.transferAmount=u),this.transferAmount<=0)return this.logger.debug({debug:"CashlessService: Invalid transfer request, transfer amount is less than or equal to 0.",data:t},!0),void a.default.publish(this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC,this.createInitiateTransferInvalidRequestResp(this.enumCashlessTransferStatus.REQUESTED_AMOUNT_TO_LOW));if(parseInt(this.transferAmount,10)<i)return this.logger.debug({debug:"CashlessService: Invalid transfer request, transfer amount can not be less than the min from egm.",data:t},!0),void a.default.publish(this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC,this.createInitiateTransferInvalidRequestResp(this.enumCashlessTransferStatus.REQUESTED_AMOUNT_LESS_THAN_MIN_FR));if(l>o&&void 0!==this.allowTransferOverMaxBal&&!1===this.allowTransferOverMaxBal)return this.logger.debug({debug:"CashlessService: Invalid transfer request, amount on card cannot be greater than max card balance.",data:t},!0),void a.default.publish(this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC,this.createInitiateTransferInvalidRequestResp(this.enumCashlessTransferStatus.REQUESTED_AMOUNT_GREATER_THAN_MAX_FR));if(n.pin.locked){const e=r.default.createBE2BasicFunctionArr([[r.default.enumBE2BasicFunc.PIN_NotEntered,[0,0,0,0]]]);return this.ngxComm.sendBe2Message(e,this.doNothing.bind(this)),void a.default.publish(this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC,this.createInitiateTransferInvalidRequestResp(this.enumCashlessTransferStatus.PIN_LOCKED))}if((n.pin.check_pin_needed||n.pin.force_pin)&&!0===this.validatePin)return this.logger.debug({debug:"CashlessService: PIN required. Validating PIN.",data:null},!0),this.xferDirection=this.enumXferDirection.XFER_FROM_GAME,a.default.unsubscribe(this.VALIDATE_PIN_RESP_TOPIC,this.handleValidatePINRespFn),a.default.subscribe(this.VALIDATE_PIN_RESP_TOPIC,this.handleValidatePINRespFn),void a.default.publish(this.VALIDATE_PIN_TOPIC,this.createValidatePINReq());this.completeXferFromGame()})}completeXferFromGame(){let e,t;if(this.cashoutRequest){const e=[[this.enumBE2Func.Cashless_TransferFromGame,[0,4294967295,1,0]]],t=r.default.createBE2BasicFunctionArr(e);this.ngxComm.sendBe2Message(t,this.processInitiateTransferFromGameResp.bind(this)),this.transferStatusCount=0,this.cashlessStatusCheckIntervalID=window.setInterval(this.checkTransferStatus.bind(this),this.GET_CASHLESS_STATUS_INTERVAL)}else this.disableAutoPlay?(this.getAutoPlayStatusCount=0,this.getAutoPlayStatusCheckIntervalID=window.setInterval(this.checkGetAutoPlayStatus.bind(this),this.GET_AUTOPLAY_STATUS_INTERVAL)):(e=[[this.enumBE2Func.Cashless_TransferFromGame,[0,parseInt(this.transferAmount,10),1,0]]],t=r.default.createBE2BasicFunctionArr(e),this.ngxComm.sendBe2Message(t,this.processInitiateTransferFromGameResp.bind(this)),this.transferStatusCount=0,this.cashlessStatusCheckIntervalID=window.setInterval(this.checkTransferStatus.bind(this),this.GET_CASHLESS_STATUS_INTERVAL))}processInitiateTransferFromGameResp(e,t){if(e)this.logger.error({error:"CashlessService: Received an error in processInitiateTransferFromGameResp.",data:e},!0);else{let e;if(0===(e=t[r.default.BE2_BASIC_RESPONSE]).length)return void this.logger.debug({debug:"CashlessService: No BE2 responses.",data:t},!0);e.forEach(e=>{e.functionCode!==this.enumBE2Func.Cashless_TransferFromGame&&this.logger.debug({debug:"Unknown BE2Response!",data:""},!0)})}}createInitiateTransferTimeoutResp(){return{cmd:"initiateTransferResp",ver:"1.0",transferData:{status:this.enumCashlessTransferStatus.TIMEOUT,transferAmount:this.transferAmount}}}createInitiateTransferInvalidRequestResp(e){return{cmd:"initiateTransferResp",ver:"1.0",transferData:{status:e,transferAmount:this.transferAmount}}}checkTransferStatus(){this.logger.debug({debug:"CashlessService: Sending BE2 Basic Function request [Cashless_GetStatus].",data:""},!0),++this.transferStatusCount,this.transferStatusCount>this.GET_CASHLESS_STATUS_MAX_ATTEMPTS&&(window.clearInterval(this.cashlessStatusCheckIntervalID),this.logger.error({error:"CashlessService: checkTransferStatus max attempts exceeded. Publishing InitiateTransferResp with NO_RESPONSE."},!0),a.default.publish(this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC,this.createInitiateTransferTimeoutResp()));const e=[[this.enumBE2Func.Cashless_GetStatus,[0,0,0,0]]],t=r.default.createBE2BasicFunctionArr(e);this.ngxComm.sendBe2Message(t,this.processCheckTransferStatusResp.bind(this))}checkGetAutoPlayStatus(){++this.getAutoPlayStatusCount,this.getAutoPlayStatusCount>this.GET_AUTOPLAY_STATUS_MAX_ATTEMPTS&&(window.clearInterval(this.getAutoPlayStatusCheckIntervalID),this.logger.error({error:"CashlessService: getAutoPlayStatus max attempts exceeded. Publishing InitiateTransferResp with NO_RESPONSE."},!0),this.sendCashlessStatus({cmd:"initiateTransferResp",ver:"1.0",transferData:{status:this.enumCashlessTransferStatus.FAILED_OTHER_REASON,transferAmount:this.transferAmount}}));const e=r.default.createBE2BasicFunctionArr([[this.enumBE2Func.MENU_GetAutoPlayStatus,[0,0,0,0]]]);this.ngxComm.sendBe2Message(e,this.processGetAutoPlayStatusResp.bind(this))}processCheckTransferStatusResp(e,t){const s={cmd:"initiateTransferResp",ver:"1.0",transferData:{status:this.enumCashlessTransferStatus.FAILED_OTHER_REASON,transferAmount:this.transferAmount}};if(e)this.logger.error({error:"CashlessService: Received an error in processCheckTransferStatusResp.",data:e},!0);else{let e;if(0===(e=t[r.default.BE2_BASIC_RESPONSE]).length)return void this.logger.debug({debug:"CashlessService: No BE2 responses.",data:t},!0);e.forEach(e=>{if(e.functionCode===this.enumBE2Func.Cashless_GetStatus)switch(e.retvals[0]){case this.enumCashlessResult.TRANSFER_PENDING:this.logger.debug({debug:"Cashless Transfer Pending",data:""},!0);break;case this.enumCashlessResult.TRANSFER_SUCCESS:if(this.ejectCard){const e=r.default.createBE2BasicFunctionArr([[this.enumBE2Func.LOLSCH_PatronRequestUnlock,[0,0,0,0]]]);this.ngxComm.sendBe2Message(e,this.processEjectCardResp.bind(this))}else s.transferData.status=this.enumCashlessTransferStatus.SUCCESSFUL_OPERATION,this.sendCashlessStatus(s);break;case this.enumCashlessResult.TRANSFER_ABORTED:s.transferData.status=this.enumCashlessTransferStatus.ABORTED_OPERATION,this.sendCashlessStatus(s);break;case this.enumCashlessResult.TRANSFER_FAILED:s.transferData.status=this.enumCashlessTransferStatus.FAILED_OPERATION,this.sendCashlessStatus(s);break;case this.enumCashlessResult.TRANSFER_ABORTED_OPERATION_STARTED:s.transferData.status=this.enumCashlessTransferStatus.ABORTED_OPERATION_STARTED,this.sendCashlessStatus(s);break;case this.enumCashlessResult.TRANSFER_FAILED_OPERATION_STARTED:s.transferData.status=this.enumCashlessTransferStatus.FAILED_OPERATION_STARTED,this.sendCashlessStatus(s);break;default:this.logger.debug({debug:"Unknown BE2Response!",data:""},!0),s.transferData.status=this.enumCashlessTransferStatus.FAILED_OTHER_REASON,this.sendCashlessStatus(s)}else this.logger.debug({debug:"Unknown BE2Response!",data:""},!0)})}}sendCashlessStatus(e){window.clearInterval(this.cashlessStatusCheckIntervalID),a.default.publish(this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC,e)}processGetAutoPlayStatusResp(e,t){if(e)this.logger.error({error:"CashlessService: Received an error in processGetAutoPlayStatusResp.",data:e},!0);else{let e;if(0===(e=t[r.default.BE2_BASIC_RESPONSE]).length)return void this.logger.debug({debug:"CashlessService: No BE2 responses for processGetAutoPlayStatusResp.",data:t},!0);e.forEach(e=>{if(e.functionCode===this.enumBE2Func.MENU_GetAutoPlayStatus&&0===e.retvals[0]){window.clearInterval(this.getAutoPlayStatusCheckIntervalID);const e=r.default.createBE2BasicFunctionArr([[this.enumBE2Func.MENU_SetAutoPlayStatus,[0,0,0,0]]]);this.ngxComm.sendBe2Message(e,(e,t)=>{e?this.logger.error({error:"Cashless Service: Received an error in SetAutoPlayStatus.",data:e},!0):this.logger.debug({debug:"Cashless Service: Received BE2 response for SetAutoPlayStatus.",data:t},!0)});const t=r.default.createBE2BasicFunctionArr([[this.enumBE2Func.Cashless_TransferFromGame,[0,parseInt(this.transferAmount,10),1,0]]]);this.ngxComm.sendBe2Message(t,this.processInitiateTransferFromGameResp.bind(this)),this.transferStatusCount=0,this.cashlessStatusCheckIntervalID=window.setInterval(this.checkTransferStatus.bind(this),this.GET_CASHLESS_STATUS_INTERVAL)}})}}processEjectCardResp(e,t){this.logger.debug({debug:"CashlessService: Received BE2 Basic Function response [LOLSCH_PatronRequestUnlock].",data:t},!0);const s={cmd:"initiateTransferResp",ver:"1.0",transferData:{status:this.enumCashlessTransferStatus.UNLOCK_FAILED_OTHER_REASON,transferAmount:this.transferAmount}};if(e)this.logger.error({error:"CashlessService: Received an error in processEjectCardResp.",data:e},!0);else{let e;if(0===(e=t[r.default.BE2_BASIC_RESPONSE]).length)return void this.logger.debug({debug:"CashlessService: No BE2 responses for LOLSCH_PatronRequestUnlock.",data:t},!0);e.forEach(e=>{e.functionCode===this.enumBE2Func.LOLSCH_PatronRequestUnlock&&0===e.retvals[0]?(s.transferData.status=this.enumCashlessTransferStatus.UNLOCK_SUCCESSFUL,this.sendCashlessStatus(s),this.logger.debug({debug:"CashlessService: Card unlocked.",data:t},!0)):e.functionCode===this.enumBE2Func.LOLSCH_PatronRequestUnlock&&1===e.retvals[0]?(s.transferData.status=this.enumCashlessTransferStatus.CREDITS_EXIST,this.sendCashlessStatus(s),this.logger.debug({debug:"CashlessService: Cannot unlock card, credits exist on the machine.",data:t},!0)):e.functionCode===this.enumBE2Func.LOLSCH_PatronRequestUnlock&&2===e.retvals[0]&&(s.transferData.status=this.enumCashlessTransferStatus.GAME_IN_PROGRESS,this.sendCashlessStatus(s),this.logger.debug({debug:"CashlessService: Cannot unlock card, game in progress.",data:t},!0))})}}initiateTransferFromCard(e){const t=e.detail;this.transferAmount=t.transferAmount,this.validatePin=t.validatePin;let s=this.appStore.getAppStoreCache(),n=s.playerBonuses.cashless.transferLimits.minToEgm;if(s.playerBonuses.cashless.transferLimits.maxToEgm,s.playerBonuses.cashless.balances.cardCents<=0)return this.logger.debug({debug:"CashlessService: Invalid transfer request, amount on card is less than or equal to 0.",data:t},!0),void a.default.publish(this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC,this.createInitiateTransferInvalidRequestResp(this.enumCashlessTransferStatus.CARD_BALANCE_TOO_LOW));if(parseInt(this.transferAmount,10)<=0)return this.logger.debug({debug:"CashlessService: Invalid transfer request, transfer amount is less than or equal to 0.",data:t},!0),void a.default.publish(this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC,this.createInitiateTransferInvalidRequestResp(this.enumCashlessTransferStatus.REQUESTED_AMOUNT_TO_LOW));if(parseInt(this.transferAmount,10)<n)return this.logger.debug({debug:"CashlessService: Invalid transfer request, transfer amount can not be less than min to egm.",data:t},!0),void a.default.publish(this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC,this.createInitiateTransferInvalidRequestResp(this.enumCashlessTransferStatus.REQUESTED_AMOUNT_LESS_THAN_MIN_TO));if(s.pin.locked){const e=r.default.createBE2BasicFunctionArr([[r.default.enumBE2BasicFunc.PIN_NotEntered,[0,0,0,0]]]);return this.ngxComm.sendBe2Message(e,this.doNothing.bind(this)),void a.default.publish(this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC,this.createInitiateTransferInvalidRequestResp(this.enumCashlessTransferStatus.PIN_LOCKED))}if((s.pin.check_pin_needed||s.pin.force_pin)&&!0===this.validatePin)return this.logger.debug({debug:"CashlessService: PIN required. Validating PIN.",data:null},!0),this.xferDirection=this.enumXferDirection.XFER_FROM_CARD,a.default.unsubscribe(this.VALIDATE_PIN_RESP_TOPIC,this.handleValidatePINRespFn),a.default.subscribe(this.VALIDATE_PIN_RESP_TOPIC,this.handleValidatePINRespFn),void a.default.publish(this.VALIDATE_PIN_TOPIC,this.createValidatePINReq());this.completeXferFromCard()}completeXferFromCard(){this.logger.debug({debug:"CashlessService: Sending BE2 Basic Function request [Cashless_TransferFromCard].",data:""},!0),this.ejectCard=!1;const e=[[this.enumBE2Func.Cashless_TransferFromCard,[0,parseInt(this.transferAmount,10),1,0]]],t=r.default.createBE2BasicFunctionArr(e);this.ngxComm.sendBe2Message(t,this.processInitiateTransferFromCardResp.bind(this)),this.transferStatusCount=0,this.cashlessStatusCheckIntervalID=window.setInterval(this.checkTransferStatus.bind(this),this.GET_CASHLESS_STATUS_INTERVAL)}processInitiateTransferFromCardResp(e,t){if(e)this.logger.error({error:"CashlessService: Received an error in processInitiateTransferFromCardResp.",data:e},!0);else{let e;if(0===(e=t[r.default.BE2_BASIC_RESPONSE]).length)return void this.logger.debug({debug:"CashlessService: No BE2 responses.",data:t},!0);e.forEach(e=>{e.functionCode===this.enumBE2Func.Cashless_TransferFromCard?this.logger.debug({debug:"CashlessService: Received Response to Cashless_TransferFromCard",data:t},!0):this.logger.debug({debug:"Unknown BE2Response!",data:""},!0)})}}createValidatePINReq(){return{cmd:"validatePIN",ver:"1.0"}}registerCashlessEnabledRespCB(e){this.checkCashlessEnabledSubscribersResp.push(e),a.default.subscribe(this.CHECK_CASHLESS_ENABLED_RESP_TOPIC,e)}registerGetCashlessBalanceRespCB(e){this.getCashlessBalanceSubscribersResp.push(e),a.default.subscribe(this.GET_CASHLESS_BALANCE_RESP_TOPIC,e)}registerInitiateTransferRespCB(e){this.getInitiateTransferSubscribersResp.push(e),a.default.subscribe(this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC,e)}cleanup(){this.checkCashlessEnabledSubscribersResp&&this.checkCashlessEnabledSubscribersResp.forEach(e=>{a.default.unsubscribe(this.CHECK_CASHLESS_ENABLED_RESP_TOPIC,e)}),this.getCashlessBalanceSubscribersResp&&this.getCashlessBalanceSubscribersResp.forEach(e=>{a.default.unsubscribe(this.GET_CASHLESS_BALANCE_RESP_TOPIC,e)}),this.getInitiateTransferSubscribersResp&&this.getInitiateTransferSubscribersResp.forEach(e=>{a.default.unsubscribe(this.INITIATE_CASHLESS_TRANSFER_RESP_TOPIC,e)}),this.checkCashlessEnabledSubscribers&&this.checkCashlessEnabledSubscribers.forEach(e=>{a.default.unsubscribe(this.CHECK_CASHLESS_ENABLED_TOPIC,e)}),this.getCashlessBalanceSubscribers&&this.getCashlessBalanceSubscribers.forEach(e=>{a.default.unsubscribe(this.GET_CASHLESS_BALANCE_TOPIC,e)}),this.getInitiateTransferFromSubscribers&&this.getInitiateTransferFromSubscribers.forEach(e=>{a.default.unsubscribe(this.INITIATE_CASHLESS_TRANSFER_FROM_GAME_TOPIC,e)}),this.getInitiateTransferToSubscribers&&this.getInitiateTransferToSubscribers.forEach(e=>{a.default.unsubscribe(this.INITIATE_CASHLESS_TRANSFER_FROM_CARD_TOPIC,e)}),this.logger.debug({debug:"CashlessService: Cleaning up."},!0)}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=n(s(1)),a=n(s(2));function n(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(e,t){this.ngxComm=e,this.logger=t,this.CHECK_POINT_PAY_ENABLED_TOPIC="checkPointPayEnabled",this.CHECK_POINT_PAY_ENABLED_RESP_TOPIC="checkPointPayEnabledResp",this.CHECK_POINT_PAY_CODE_TOPIC="checkPointPayCode",this.CHECK_POINT_PAY_CODE_RESP_TOPIC="checkPointPayCodeResp",this.INITIATE_POINT_PAY_TOPIC="initiatePointPay",this.INITIATE_POINT_PAY_RESP_TOPIC="initiatePointPayResp",this.ppEnabledCB=null,this.ppCodeCB=null,this.ppInitiateCB=null,this.checkPointPayEnabledFn=this.checkPointPayEnabled.bind(this),this.checkPointPayCodeFn=this.checkPointPayCode.bind(this),this.initiatePointPayFn=this.initiatePointPay.bind(this),a.default.subscribe(this.CHECK_POINT_PAY_ENABLED_TOPIC,this.checkPointPayEnabledFn),a.default.subscribe(this.CHECK_POINT_PAY_CODE_TOPIC,this.checkPointPayCodeFn),a.default.subscribe(this.INITIATE_POINT_PAY_TOPIC,this.initiatePointPayFn)}checkPointPayEnabled(){this.logger.debug({debug:"Point Pay Service: Sending BE2 Basic Function request [PT_Get_Point_Pay_Available]",data:""},!0);const e=[[r.default.enumBE2BasicFunc.PT_Get_Point_Pay_Available,[0,0,0,0]]],t=r.default.createBE2BasicFunctionArr(e);this.ngxComm.sendBe2Message(t,this.processCheckPointPayEnabledResp.bind(this))}processCheckPointPayEnabledResp(e,t){if(e)this.logger.error({error:"Point Pay Service: Received an error in processCheckPointPayEnabledResp.",data:e},!0);else{const e={cmd:"checkPointPayEnabledResp",ver:"1.0",enabled:!1},s=t[r.default.BE2_BASIC_RESPONSE];0===s.length?this.logger.debug({debug:"Point Pay Service: No BE2 responses.",data:t},!0):(s.forEach(t=>{t.functionCode===r.default.enumBE2BasicFunc.PT_Get_Point_Pay_Available?1===t.retvals[0]?e.enabled=!0:e.enabled=!1:this.logger.debug({debug:"Unknown BE2Response encountered in processCheckPointPayEnabledResp.",data:""},!0)}),this.logger.debug({debug:"Point Pay Service: Point Pay enabled is "+e.enabled,data:""},!0)),a.default.publish(this.CHECK_POINT_PAY_ENABLED_RESP_TOPIC,e)}}checkPointPayCode(e){const t=parseInt(e.detail.code,10);this.logger.debug({debug:"Point Pay Service: Sending BE2 Basic Function request [MP_CheckPointPayCode]",data:""},!0);const s=[[r.default.enumBE2BasicFunc.MP_CheckPointPayCode,[parseInt(t.toString(),10),t.toString().length,0,0]]],a=r.default.createBE2BasicFunctionArr(s);this.ngxComm.sendBe2Message(a,this.processCheckPointPayCodeResp.bind(this))}processCheckPointPayCodeResp(e,t){if(e)this.logger.error({error:"Point Pay Service: Received an error in processCheckPointPayCodeResp.",data:e},!0);else{const e={cmd:"checkPointPayCodeResp",ver:"1.0",valid:!1},s=t[r.default.BE2_BASIC_RESPONSE];0===s.length?this.logger.debug({debug:"Point Pay Service: No BE2 responses.",data:t},!0):(s.forEach(t=>{t.functionCode===r.default.enumBE2BasicFunc.MP_CheckPointPayCode?1===t.retvals[2]?e.valid=!0:e.valid=!1:this.logger.debug({debug:"Unknown BE2Response encountered in processCheckPointPayCodeResp.",data:""},!0)}),this.logger.debug({debug:"Point Pay Service: Pay Code matched is "+e.valid,data:""},!0)),a.default.publish(this.CHECK_POINT_PAY_CODE_RESP_TOPIC,e)}}initiatePointPay(e){const t=e.detail.points;this.logger.debug({debug:"Point Pay Service: Sending BE2 Basic Function request [MP_PointsToPayment]",data:""},!0);const s=[[r.default.enumBE2BasicFunc.MP_PointsToPayment,[t,0,0,0]]],a=r.default.createBE2BasicFunctionArr(s);this.ngxComm.sendBe2Message(a,this.processInitiatePointPayResp.bind(this))}processInitiatePointPayResp(e,t){const s={cmd:"initiatePointPayResp",ver:"1.0",status:0};if(e)this.logger.error({error:"Point Pay Service: Received an error in processInitiatePointPayResp.",data:e},!0);else{const e=t[r.default.BE2_BASIC_RESPONSE];0===e.length?this.logger.debug({debug:"Point Pay Service: No BE2 responses.",data:t},!0):(e.forEach(e=>{e.functionCode===r.default.enumBE2BasicFunc.MP_PointsToPayment?s.status=e.retvals[1]:this.logger.debug({debug:"Unknown BE2Response encountered in processInitiatePointPayResp.",data:""},!0)}),this.logger.debug({debug:"Point Pay Service: Transaction "+(1===s.status?"succeeded ":"failed ")+"with status: "+s.status,data:""},!0))}a.default.publish(this.INITIATE_POINT_PAY_RESP_TOPIC,s)}registerPointPayEnabledRespCB(e){this.ppEnabledCB=e,a.default.subscribe(this.CHECK_POINT_PAY_ENABLED_RESP_TOPIC,e)}registerPointPayCodeRespCB(e){this.ppCodeCB=e,a.default.subscribe(this.CHECK_POINT_PAY_CODE_RESP_TOPIC,e)}registerInitiatePointPayRespCB(e){this.ppInitiateCB=e,a.default.subscribe(this.INITIATE_POINT_PAY_RESP_TOPIC,e)}cleanup(){a.default.unsubscribe(this.CHECK_POINT_PAY_ENABLED_TOPIC,this.checkPointPayEnabledFn),a.default.unsubscribe(this.CHECK_POINT_PAY_CODE_TOPIC,this.checkPointPayCodeFn),a.default.unsubscribe(this.INITIATE_POINT_PAY_TOPIC,this.initiatePointPayFn),a.default.unsubscribe(this.CHECK_POINT_PAY_ENABLED_RESP_TOPIC,this.ppEnabledCB),a.default.unsubscribe(this.CHECK_POINT_PAY_CODE_RESP_TOPIC,this.ppCodeCB),a.default.unsubscribe(this.INITIATE_POINT_PAY_RESP_TOPIC,this.ppInitiateCB),this.logger.debug({debug:"Point Pay Service: Cleaning up."},!0)}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=n(s(1)),a=n(s(2));function n(e){return e&&e.__esModule?e:{default:e}}const i="locked",o="unlocked";t.default=class{constructor(e,t,s,r){var n=this;this.gameLockStatus=o,this.userPreferredFullScreenState=!1,this.watchProperty("gameLockStatus",(function(){this.syncFullScreenState()})),this.watchProperty("userPreferredFullScreenState",(function(e){e?this.sendGameLockMsg(this):this.sendGameUnlockMsg(this),this.syncFullScreenState()})),Object.defineProperty(this,"shouldShowFullscreen",{get(){return this.userPreferredFullScreenState&&this.gameLockStatus==i}}),this.checkGameLockInterval=setInterval((function(){(n.userPreferredFullScreenState&&n.gameLockStatus!=i||!n.userPreferredFullScreenState&&n.gameLockStatus!=o)&&n.sendLockToBE2(!0,0,n,!0)}),2e3),this.ngxComm=e,this.logger=s,this.urlParams=r,this.shellCache=t,this.TOGGLE_FULL_SCREEN_TOPIC="toggle-full-screen",this.SHOW_FULL_SCREEN_TOPIC="show-full-screen",this.HIDE_FULL_SCREEN_TOPIC="hide-full-screen",this.gameLockTimeout=-1,this.defaultGameLockDurationInterval=300,this.defaultGameLockRequestInterval=60,this.defaultGameLockProcessingTime=3,this.fullscreenState=!1,this.watchProperty("fullscreenState",(function(){n.syncFullScreenState()})),this.showBanner=!1,this.shellCache.storeShellStateElement("fullscreenState",this.fullscreenState,0),this.toggle=this.toggleFullScreen.bind(this),this.show=this.showFullScreen.bind(this),this.hide=this.hideFullScreen.bind(this),a.default.subscribe(this.TOGGLE_FULL_SCREEN_TOPIC,this.toggle),a.default.subscribe(this.SHOW_FULL_SCREEN_TOPIC,this.show),a.default.subscribe(this.HIDE_FULL_SCREEN_TOPIC,this.hide),e.registerFullScreenState(this.registerFullScreenStateCB.bind(this)),n.sendLockToBE2(!0,0,n,!0)}registerFullScreenStateCB(e){let t;t=e&&e instanceof CustomEvent?e.detail:e,this.fullscreenState=t.fullscreenState,this.shellCache.storeShellStateElement("fullscreenState",this.fullscreenState,0).then(()=>{this.logger.debug(`fullscreenState: ${this.fullscreenState}`)}),this.setSWFullScreenState(this.fullscreenState,this.urlParams,this.showBanner),this.logger.debug({debug:"fullscreenState has been changed to "+this.fullscreenState,data:t}),window.postMessage(t,"*")}sendGameLockMsg(e,t){let s=e.defaultGameLockRequestInterval;const r=e.defaultGameLockProcessingTime;t||(t=e.defaultGameLockDurationInterval),-1!==this.gameLockTimeout&&window.clearTimeout(e.gameLockTimeout),s>t-r&&(s=t-r),e.gameLockTimeout=window.setTimeout(()=>{this.sendGameLockMsg(e,t)},1e3*s),e.sendLockToBE2(!0,t,e)}sendGameUnlockMsg(e,t){-1!==e.gameLockTimeout&&window.clearTimeout(e.gameLockTimeout),t||(t=e.defaultGameLockDurationInterval),e.sendLockToBE2(!1,t,e)}isBe2Error(e){return!!e&&(this.logger.error({error:"fullscreenToggle: error while trying to setGameLock status.",data:e},!0),!0)}sendLockToBE2(e,t,s,a=!1){const n=!0===e?0:1,l=a?[[r.default.enumBE2BasicFunc.ContentLockGame,[2,t,0,0]]]:[[r.default.enumBE2BasicFunc.ContentLockGame,[n,t,0,0]],[r.default.enumBE2BasicFunc.ContentLockGame,[2,t,0,0]]],u=r.default.createBE2BasicFunctionArr(l),c=r.default.enumBE2BasicFunc;s.ngxComm.sendBe2Message(u,(t,a)=>{this.isBe2Error(t)||a[r.default.BE2_BASIC_RESPONSE].forEach(t=>{if(t.functionCode===c.ContentLockGame)if(2===t.retvals[0])2===t.retvals[2]?this.gameLockStatus=i:3===t.retvals[2]?this.gameLockStatus=o:this.gameLockStatus=e?"pendingLock":"pendingUnlock",s.logger.debug({debug:"BE2 gameLockStatus: "+this.gameLockStatus,data:t});else{const e=0===t.retvals[0];s.logger.debug({debug:"BE2 setGameLock: "+e,data:t})}else logger.warn({warn:"Unknown BE2Response!",data:""})})})}setSWFullScreenState(e,t,s=!1){const r=document.getElementById("BannerFrame"),a=document.getElementById("WrapperFrame"),n=document.getElementById("WrapperFrameOverLay"),i=document.getElementById("PinContentFrame"),o=document.getElementById("ShellBackgroundFrame"),l=void 0!==t.bannerPosition&&void 0!==t.bannerHeight,u="640px"===t.contentWidth&&"240px"===t.contentHeight;if(e&&l&&!u){let e;a.style.top="0px",a.style.left="0px",a.style.width=t.displayWidth+"px",n.style.top="0px",n.style.left="0px",n.style.width=t.displayWidth+"px",i.style.top="0px",i.style.left="0px",i.style.width=t.displayWidth+"px",o.style.top="0px",o.style.left="0px",o.style.width=t.displayWidth+"px",s?(r.style.visibility="visible",e=parseInt(t.displayHeight)-parseInt(t.bannerHeight)+"px","top"===t.bannerPosition&&(a.style.top=t.bannerHeight+"px",n.style.top=t.bannerHeight+"px",i.style.top=t.bannerHeight+"px",o.style.top=t.bannerHeight+"px")):(e=t.displayHeight+"px",r.style.visibility="hidden"),a.style.height=e,n.style.height=e,i.style.height=e,o.style.height=e}}syncFullScreenState(){if([i,o].includes(this.gameLockStatus)&&this.shouldShowFullscreen==this.userPreferredFullScreenState&&this.userPreferredFullScreenState!=this.fullscreenState){const e=(e=>({cmd:"showFullscreen",ver:"1.0",showFullscreen:e||!1}))(this.shouldShowFullscreen);this.ngxComm.sendMessage(e)}}toggleFullScreen(e){this.showBanner=e.detail.showBanner,this.userPreferredFullScreenState=!this.userPreferredFullScreenState}showFullScreen(e){this.showBanner=e.detail.showBanner,this.userPreferredFullScreenState=!0}hideFullScreen(){this.userPreferredFullScreenState=!1}cleanup(){a.default.unsubscribe(this.TOGGLE_FULL_SCREEN_TOPIC,this.toggle),a.default.unsubscribe(this.SHOW_FULL_SCREEN_TOPIC,this.show),a.default.unsubscribe(this.HIDE_FULL_SCREEN_TOPIC,this.hide),this.unwatchAllProperties(),this.ngxComm&&this.ngxComm.unwatchProperty("gamePlayActive"),-1!==this.gameLockTimeout&&(window.clearTimeout(this.gameLockTimeout),this.gameLockTimeout=-1),this.checkGameLockInterval&&(clearInterval(this.checkGameLockInterval),delete this.checkGameLockInterval)}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.shellState={}}addShellStateElement(e,t,s){return new Promise(r=>{if(0!==s){let r;r=setTimeout(()=>{delete this.shellState[e]},s),t={value:t,timeoutinstance:r},void 0!==this.shellState[e]&&void 0!==this.shellState[e].timeoutinstance&&clearTimeout(this.shellState[e].timeoutinstance),this.shellState[e]=t}else this.shellState[e]={value:t};return r()})}removeShellStateElement(e){return new Promise(t=>(void 0!==this.shellState[e]&&void 0!==this.shellState[e].timeoutinstance&&clearTimeout(this.shellState[e].timeoutinstance),delete this.shellState[e],t()))}storeShellStateElement(e,t,s=0){return new Promise(r=>this.addShellStateElement(e,t,s).then(()=>r(this.shellState)))}deleteShellStateElement(e){return this.removeShellStateElement(e)}getShellStateElement(e){if(void 0!==this.shellState[e])return this.shellState[e].value}getShellState(){return this.shellState}clearShellState(){return this.shellState={},this.shellState}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=n(s(1)),a=n(s(2));function n(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(e,t){this.ngxComm=e,this.logger=t,this.CHECK_ATTENDANT_CARD_INSERTED_TOPIC="attendantCardInserted",this.CHECK_ATTENDANT_CARD_INSERTED_RESP_TOPIC="attendantCardInsertedResp",this.enumCardType={NONE:0,UNKNOWN:1,PLAYER:2,VIP:3,DROP_CARD:4,ATTENDANT:5,SUPERVISOR:6,WITNESS:7,UNREG_PLAYER:8,REG_PLAY:9,REG_VIP_PLAYER:10},this.enumBE2Func=r.default.enumBE2BasicFunc,this.attendantCardInsertedSubscribers=[],this.attendantCardInsertedSubscribersResp=[];let s=this.attendantCardInserted.bind(this);this.attendantCardInsertedSubscribers.push(s),a.default.subscribe(this.CHECK_ATTENDANT_CARD_INSERTED_TOPIC,s)}attendantCardInserted(){this.logger.debug({debug:"Attendant Service: Sending BE2 Basic Function request [PIN_GetCardType].",data:""},!0);const e=[[this.enumBE2Func.PIN_GetCardType,[0,0,0,0]]],t=r.default.createBE2BasicFunctionArr(e);this.ngxComm.sendBe2Message(t,this.processCardTypeResp.bind(this))}processCardTypeResp(e,t){const s={cmd:"attendantCardInsertedResp",ver:"1.0",attendantInserted:!1,cardType:0};if(e)this.logger.error({error:"AttendantService: Received an error in processCardTypeResp.",data:e},!0);else{let e;if(0===(e=t[r.default.BE2_BASIC_RESPONSE]).length)return void this.logger.debug({debug:"AttendantService: No BE2 responses.",data:t},!0);e.forEach(e=>{if(e.functionCode===this.enumBE2Func.PIN_GetCardType)switch(e.retvals[0]){case this.enumCardType.WITNESS:case this.enumCardType.SUPERVISOR:case this.enumCardType.ATTENDANT:s.attendantInserted=!0,s.cardType=e.retvals[0],this.sendCheckAttendantCardResp(s);break;default:s.cardType=e.retvals[0],this.sendCheckAttendantCardResp(s)}else this.logger.debug({debug:"AttendantService: Unknown BE2Response encountered in processCardTypeResp.",data:""},!0)})}}sendCheckAttendantCardResp(e){a.default.publish(this.CHECK_ATTENDANT_CARD_INSERTED_RESP_TOPIC,e)}registerCardTypeRespCB(e){this.attendantCardInsertedSubscribersResp.push(e),a.default.subscribe(this.CHECK_ATTENDANT_CARD_INSERTED_RESP_TOPIC,e)}cleanup(){this.attendantCardInsertedSubscribersResp&&this.attendantCardInsertedSubscribersResp.forEach(e=>{a.default.unsubscribe(this.CHECK_ATTENDANT_CARD_INSERTED_RESP_TOPIC,e)}),this.attendantCardInsertedSubscribers&&this.attendantCardInsertedSubscribers.forEach(e=>{a.default.unsubscribe(this.CHECK_ATTENDANT_CARD_INSERTED_TOPIC,e)}),this.logger.debug({debug:"AttendantService: Cleaning up."},!0)}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=n(s(2)),a=n(s(3));function n(e){return e&&e.__esModule?e:{default:e}}t.default=class{constructor(e,t,s,r,n){this.ngxComm=e,this.logger=t,this.m5Config=s,this.appStore=r,this.startSubscriptions=1==n,this.cardlessTimerEvent=60,this.checkCardlessCacheTime=3e4,this.lastDisconnectReason=null,this.clearStateTime=s.cardless.clearStateTimeInSecs||60,this.m5Config&&this.m5Config.cardless&&this.m5Config.cardless.checkCardlessCacheTimeInSecs&&(this.checkCardlessCacheTime=1e3*this.m5Config.cardless.checkCardlessCacheTimeInSecs),this.CARDLESS_STATUS_UPDATE_TOPIC="cardlessStatusUpdate",this.cardlessStatusUpdateSubscribers=[],this.lastReceivedTime=(new Date).getTime(),this.cardlessStatusHistory=[],this.enumCardlessStatus={OPEN:"open",CONNECTED:"connected",DISCONNECTED:"disconnected",CLOSED:"closed"},this.startSubscriptions&&(this.setupCardlessAdvSubscription(),this.cardlessTimerEvent=setInterval(()=>{var e=(new Date).getTime();if(this.appStore.getCurrentScreenTrigger()===a.default.IDLE_SCREEN&&this.cardlessStatusHistory[0]&&this.cardlessStatusHistory[0].interface){var t=(e-this.lastReceivedTime)/1e3;t>this.m5Config.cardless.clearStateTimeInSecs&&(this.logger.debug({debug:"CardlessService: checkCardlessCache - Clear Cardless Cache, last cardless data received in  : "+t+" secs"},!0),this.cardlessStatusHistory.length=0)}},this.checkCardlessCacheTime))}formatEvent(e){return e&&e instanceof CustomEvent?e.detail:e}setupCardlessAdvSubscription(){this.ngxComm.registerCardlessStatus(this.handleCardlessData.bind(this))}handleCardlessData(e){this.lastReceivedTime=(new Date).getTime();const t={cmd:"cardlessStatusUpdate",ver:"1.0",cardlessStatusUpdate:null},s=this.formatEvent(e);this.logger.debug({debug:"CardlessService:handleCardlessData - Received Cardless Data",data:s},!0),s&&s.cardlessStatus&&(s.cardlessStatus.status===this.enumCardlessStatus.OPEN&&(this.cardlessStatusHistory.length=0),s.cardlessStatus.timestamp=this.lastReceivedTime,this.cardlessStatusHistory.unshift(s.cardlessStatus),this.cardlessStatusHistory.length>30&&this.cardlessStatusHistory.pop(),t.cardlessStatusUpdate=this.cardlessStatusHistory[0],s.cardlessStatus.status===this.enumCardlessStatus.DISCONNECTED&&(this.lastDisconnectReason=s.cardlessStatus.disconnectReason),this.lastDisconnectReason&&this.cardlessStatusHistory.forEach(e=>{e.lastDisconnectReason=this.lastDisconnectReason}),this.sendCardlessStatusUpdate(t))}getCardlessStatus(){return this.cardlessStatusHistory.length>0?this.cardlessStatusHistory[0]:null}getCardlessStatusHistory(){return this.cardlessStatusHistory||[]}sendCardlessStatusUpdate(e){r.default.publish(this.CARDLESS_STATUS_UPDATE_TOPIC,e)}registerCardlessStatusUpdateCB(e){this.cardlessStatusUpdateSubscribers.push(e),r.default.subscribe(this.CARDLESS_STATUS_UPDATE_TOPIC,e)}cleanup(){this.cardlessStatusUpdateSubscribers&&this.cardlessStatusUpdateSubscribers.forEach(e=>{r.default.unsubscribe(this.CARDLESS_STATUS_UPDATE_TOPIC,e)}),this.cardlessStatusHistory.length=0,clearInterval(this.cardlessTimerEvent),this.logger.debug({debug:"CardlessService: Cleaning up."},!0)}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{static getJSONFile(e){return new Promise((function(t,s){fetch(e).then((function(e){throw e.error||t(e.json()),new Error(e.error)})).catch((function(e){s(e)}))}))}}},function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}(s(218)),a=function(e){return e&&e.__esModule?e:{default:e}}(s(2));t.default=class{constructor(e,t,s,r,a){this.m5Config=a,this.paramsObj=r||{},this.COMMANDS=Object.freeze({REGISTER:"REGISTER",STATUS_UPDATE:"STATUSUPDATE",ACTION:"ACTION"}),this.ACTION_SUB_COMMANDS=Object.freeze({HARD_RESET:"HARD_RESET",SOFT_RESET:"SOFT_RESET",DEBUG:"DEBUG"}),this.severity={HEARTBEAT:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,COMMAND:999},this.reconnectInterval=500,this.attemptsToConnect=0,this.connected=!1,this.givenUp=!1,this.loggerSocket=null,this.loggerUrl=e,this.deviceId=t,this.logSeverity=void 0===s?0:s>=0?s:this.severity[s.toUpperCase()]||0,this.refreshTime=(new Date).getTime(),this.initialMemoryInfo=this.getMemoryInfo(),this.currentM5State="IDLE",this.remoteDebugEnabled=!1,this.remoteDebugEndTime=null,this.remoteDebugSessionTime=18e5,this.M5RefreshTime=2,this.connect(),window.onerror=(e,t,s,r,a)=>{if(e.toLowerCase().indexOf("script error")>-1)this.error("Unhandled Script Error: See Browser Console for Detail.");else{const n=["Message: "+e,"URL: "+t,"Line: "+s,"Column: "+r,"Error object: "+JSON.stringify(a)].join(" - ");this.error(n)}return!1}}getMemoryInfo(){var e=null,t=window.performance.memory;return t&&(e={jsHeapSizeLimit:t.jsHeapSizeLimit||null,totalJSHeapSize:t.totalJSHeapSize||null,usedJSHeapSize:t.usedJSHeapSize||null}),e}sendStatusUpdateCommand(e){this.currentM5State=e;let t={command:"STATUSUPDATE",commandData:{currentState:e||null,initialMemoryInfo:this.initialMemoryInfo,currentMemoryInfo:this.getMemoryInfo()}};this.command(t)}sendRegistrationCommand(){let e={command:"REGISTER",commandData:{location:this.paramsObj.location||null,machineNumber:this.paramsObj.machineNumber||null,uid:this.paramsObj.uid||null,boardVersion:this.paramsObj.boardVersion||null,actualWidth:this.paramsObj.actualWidth||null,actualHeight:this.paramsObj.actualHeight||null,displayWidth:this.paramsObj.displayWidth||null,displayHeight:this.paramsObj.displayHeight||null,screenType:this.paramsObj.screenType||null,screenDescription:this.paramsObj.screenDescription||null,mediaDisplayType:this.paramsObj.mediaDisplayType||null,mediaDisplayPosition:this.paramsObj.mediaDisplayPosition||null,xPosition:this.paramsObj.xPosition||null,yPosition:this.paramsObj.yPosition||null,contentWidth:this.paramsObj.contentWidth||null,contentHeight:this.paramsObj.contentHeight||null,mediaDisplayWidth:this.paramsObj.mediaDisplayWidth||null,touchScreenCapable:this.paramsObj.touchScreenCapable||null,audioCapable:this.paramsObj.audioCapable||null,fullscreenCapable:this.paramsObj.fullscreenCapable||null,bannerPosition:this.paramsObj.bannerPosition||null,bannerHeight:this.paramsObj.bannerHeight||null,debug:this.paramsObj.debug||null,refreshTime:this.refreshTime}};this.command(e)}connect(){this.attemptsToConnect++,r.debug(`logger: connection attempt ${this.attemptsToConnect}`);try{this.loggerSocket=new WebSocket(this.loggerUrl),this.loggerSocket.onopen=()=>{this.attemptsToConnect=0,this.connected=!0,this.givenUp=!1,this.sendRegistrationCommand(),this.sendStatusUpdateCommand(this.currentM5State)},this.loggerSocket.onclose=e=>{r.debug(e),this.reconnect()},this.loggerSocket.onerror=e=>{r.debug(e)},this.loggerSocket.onmessage=e=>{this.handleNewMessage(e)}}catch(e){this.givenUp=!0,r.error(e),r.error("Cannot connect to supplied loggerUrl, logging to console")}}handleNewMessage(e){if(e&&e.data){var t=JSON.parse(e.data);t&&t.command&&t.command===this.COMMANDS.ACTION&&t.commandData&&t.commandData.commandSubtype&&(t.commandData.commandSubtype===this.ACTION_SUB_COMMANDS.SOFT_RESET?this.handleSoftReset(t.commandData.commandSubtypeData):t.commandData.commandSubtype===this.ACTION_SUB_COMMANDS.HARD_RESET?this.handleHardReset(t.commandData.commandSubtypeData):t.commandData.commandSubtype===this.ACTION_SUB_COMMANDS.DEBUG&&this.handleDebugCommand(t.commandData.commandSubtypeData))}else this.error("logger: handleNewMessage - Failed to handle command from the M5 Server"+JSON.stringify(e))}handleSoftReset(e){let t=(Math.floor(Math.random()*(e-1+1))+1)*this.M5RefreshTime;this.info("logger: ******Soft Reset Initiated from M5 Server, About to restart in "+t+" secs"),setTimeout((function(){window.location.reload(!0)}),1e3*t)}handleHardReset(e){let t=(Math.floor(Math.random()*(e-1+1))+1)*this.M5RefreshTime;this.info("logger: ******Hard Reset Initiated from M5 Server, About to stop pings to Adv in "+t+" secs"),setTimeout((function(){a.default.publish("serverForceStopHeartBeat",e)}),1e3*t)}handleDebugCommand(e){this.info("logger: ******Debug Initiated from Server for next 30 mins"),this.remoteDebugEnabled=!0,this.remoteDebugEndTime=(new Date).getTime()+this.remoteDebugSessionTime}reconnect(){10===this.attemptsToConnect&&(this.givenUp=!0,r.error("Couldn't connect to logger after 10 tries, giving up. Logging to console.")),setTimeout(()=>{r.debug("logger: reconnecting..."),this.connect()},this.reconnectInterval)}trySend(e){this.connected?this.loggerSocket.send(e):this.givenUp?r.debug("Logger message: "+JSON.stringify(e)):setTimeout(()=>{this.trySend(e)},500)}log(e,t,s,r){var a=r&&this.m5Config&&this.m5Config.diagnosticTargets&&this.m5Config.diagnosticTargets.includes(r);if(this.remoteDebugEnabled)(new Date).getTime()>=this.remoteDebugEndTime&&(this.remoteDebugEnabled=!1,this.info("logger: ******Remote Debug session ended"));else if(s<this.logSeverity&&!a)return;const n={time:new Date,message:e,severity:this.getTextForSeverity(s),source:"NgxComm-"+this.deviceId,received:!!t};this.trySend(JSON.stringify(n))}heartbeat(e,t){this.log(e,t,this.severity.HEARTBEAT)}debug(e,t,s){this.log(e,t,this.severity.DEBUG,s)}info(e,t,s){this.log(e,t,this.severity.INFO,s)}warn(e,t,s){this.log(e,t,this.severity.WARN,s)}error(e,t,s){this.log(e,t,this.severity.ERROR,s)}command(e,t){this.log(e,t,this.severity.COMMAND)}getTextForSeverity(e){let t;switch(e){case this.severity.HEARTBEAT:t="heartbeat";break;case this.severity.DEBUG:t="debug";break;case this.severity.INFO:t="info";break;case this.severity.WARN:t="warn";break;case this.severity.ERROR:t="error";break;case this.severity.COMMAND:t="command";break;default:t="info"}return t}}},function(e,t,s){var r,a;void 0===(a="function"==typeof(r=function(){var e=function(){},t="undefined",s=["trace","debug","info","warn","error"];function r(e,t){var s=e[t];if("function"==typeof s.bind)return s.bind(e);try{return Function.prototype.bind.call(s,e)}catch(t){return function(){return Function.prototype.apply.apply(s,[e,arguments])}}}function a(t,r){for(var a=0;a<s.length;a++){var n=s[a];this[n]=a<t?e:this.methodFactory(n,t,r)}this.log=this.debug}function n(s,n,i){return function(s){return"debug"===s&&(s="log"),typeof console!==t&&(void 0!==console[s]?r(console,s):void 0!==console.log?r(console,"log"):e)}(s)||function(e,s,r){return function(){typeof console!==t&&(a.call(this,s,r),this[e].apply(this,arguments))}}.apply(this,arguments)}function i(e,r,i){var o,l=this,u="loglevel";function c(){var e;if(typeof window!==t){try{e=window.localStorage[u]}catch(e){}if(typeof e===t)try{var s=window.document.cookie,r=s.indexOf(encodeURIComponent(u)+"=");-1!==r&&(e=/^([^;]+)/.exec(s.slice(r))[1])}catch(e){}return void 0===l.levels[e]&&(e=void 0),e}}e&&(u+=":"+e),l.name=e,l.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},l.methodFactory=i||n,l.getLevel=function(){return o},l.setLevel=function(r,n){if("string"==typeof r&&void 0!==l.levels[r.toUpperCase()]&&(r=l.levels[r.toUpperCase()]),!("number"==typeof r&&r>=0&&r<=l.levels.SILENT))throw"log.setLevel() called with invalid level: "+r;if(o=r,!1!==n&&function(e){var r=(s[e]||"silent").toUpperCase();if(typeof window!==t){try{return void(window.localStorage[u]=r)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+r+";"}catch(e){}}}(r),a.call(l,r,e),typeof console===t&&r<l.levels.SILENT)return"No console available for logging"},l.setDefaultLevel=function(e){c()||l.setLevel(e,!1)},l.enableAll=function(e){l.setLevel(l.levels.TRACE,e)},l.disableAll=function(e){l.setLevel(l.levels.SILENT,e)};var d=c();null==d&&(d=null==r?"WARN":r),l.setLevel(d,!1)}var o=new i,l={};o.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=l[e];return t||(t=l[e]=new i(e,o.getLevel(),o.methodFactory)),t};var u=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=u),o},o.getLoggers=function(){return l},o})?r.call(t,s,t,e):r)||(e.exports=a)},function(e,t,s){String.prototype.padEnd||(String.prototype.padEnd=function(e,t){return e>>=0,t=String(t||" "),this.length>e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),String(this)+t.slice(0,e))}),String.prototype.padStart||(String.prototype.padStart=function(e,t){return e>>=0,t=String(t||" "),this.length>e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),t.slice(0,e)+String(this))}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");const s=Object(e);for(let e=1;e<arguments.length;e++){const t=arguments[e];if(null!=t)for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(s[e]=t[e])}return s},writable:!0,configurable:!0}),Object.prototype.watchProperty||(Object.defineProperty(Object.prototype,"unwatchProperty",{enumerable:!1,configurable:!0,value:function(e){if("__watchers__"in this){if(this.__watchers__.hasOwnProperty(e)){delete this.__watchers__[e];var t=this[e];delete this[e],this[e]=t}0==Object.keys(this.__watchers__).length&&delete this.__watchers__}}}),Object.defineProperty(Object.prototype,"unwatchAllProperties",{enumerable:!1,configurable:!0,value:function(){var e=this;this.__watchers__&&Object.keys(this.__watchers__).forEach((function(t){e.unwatchProperty(t)}))}}),Object.defineProperty(Object.prototype,"watchProperty",{enumerable:!1,configurable:!0,value:function(e,t,s={beforeChange:void 0,immediate:!1}){let r=s&&s.beforeChange,a=s&&s.immediate,n=this;n.__watchers__=n.__watchers__||{};let i={didChange:t,beforeChange:r};var o=[];if(Array.isArray(e))return e.forEach((function(s){var r=[];o.push(n.watchProperty(s,(function(){var s=e.map((function(e){return n[e]}));t.call(this,s,r,e)}),{beforeChange:function(){r=e.map((function(e){return n[e]}))},immediate:a}))})),function(){o.forEach((function(e){"function"==typeof e&&e()}))};n.__watchers__[e]=n.__watchers__[e]||[],n.__watchers__[e].push(i);var l=n[e];return delete n[e]&&Object.defineProperty(n,e,{get:function(){return l},set:function(t){if(l==t)return t;let s=l;return n.__watchers__[e].forEach((function(r){let a=r.beforeChange;a&&a.call(n,t,s,e)})),l=t,n.__watchers__[e].forEach((function(r){let a=r.didChange;a&&a.call(n,t,s,e)})),t},enumerable:!0,configurable:!0}),a&&(r&&r.call(n,l,l,e),t&&t.call(n,l,l,e)),function(){if("__watchers__"in n&&e in n.__watchers__){let s=n.__watchers__[e].indexOf(i);if(-1!=s&&n.__watchers__[e].splice(s,1),0==n.__watchers__[e].length){var t=n[e];delete n[e],delete n.__watchers__[e],n[e]=t}0==Object.keys(n.__watchers__).length&&delete n.__watchers__}}}}))}])},,function(e,t,s){"use strict";var r,a=s(0),n=(r=a)&&r.__esModule?r:{default:r};window.onload=function(){window.loglevel=log.noConflict(),new n.default(window.location.href,"urlMapHorizontal.json","statusMap.json","M5Config.json","ngxSubscriptionConfig.json")}}]);
//# sourceMappingURL=shellAppHorizontal.bundle.js.map